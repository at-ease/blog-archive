<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>PINGGOD</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://pinggod.com/"/>
  <updated>2016-04-18T05:24:00.000Z</updated>
  <id>http://pinggod.com/</id>
  
  <author>
    <name>Sean Sun</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>PhantomJS</title>
    <link href="http://pinggod.com/2016/PhantomJS/"/>
    <id>http://pinggod.com/2016/PhantomJS/</id>
    <published>2016-04-14T04:22:56.000Z</published>
    <updated>2016-04-18T05:24:00.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;https://github.com/ariya/phantomjs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PhantomJS&lt;/a&gt; 是一个脚本化的无界面 WebKit，以 JavaScript 为脚本语言实现各项功能，官方列举的使用场景包括：无界面测试，页面自动化，屏幕截图和网络监控。在 Mac 下，可以使用 Homebrew 安装最新版本：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brew install phantomjs&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Command-Line-Interface&quot;&gt;&lt;a href=&quot;#Command-Line-Interface&quot; class=&quot;headerlink&quot; title=&quot;Command Line Interface&quot;&gt;&lt;/a&gt;Command Line Interface&lt;/h2&gt;&lt;p&gt;PhantomJS 运行在终端中，通过以下格式进行调用：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;phantomjs [options] somescript.js [arg1[, arg2 [, ...]]]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果在终端直接执行 &lt;code&gt;phantomjs&lt;/code&gt; 命令，则进入 REPL 环境。通过 &lt;code&gt;phantomjs --help&lt;/code&gt; 命令可以查看详细的 &lt;code&gt;options&lt;/code&gt; 参数。实际上有两种方式设置 &lt;code&gt;options&lt;/code&gt;，一种是如上所示的终端传入命令的方式，另一种是将 &lt;code&gt;options&lt;/code&gt; 写入一个 JSON 格式的配置文件，比如：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/* Same as: --ignore-ssl-errors=true */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;ignoreSslErrors&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/* Same as: --max-disk-cache-size=1000 */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;maxDiskCacheSize&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;/* Same as: --output-encoding=utf8 */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;outputEncoding&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;utf8&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后在终端中指定该配置文件：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;phantomjs --config=/path/to/config.json somescript.js [arg1[, arg2 [, ...]]]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;值得注意的是，并不是所有的 &lt;code&gt;options&lt;/code&gt; 参数都可以直接转换为 JSON 中的键名，特殊的 &lt;code&gt;options&lt;/code&gt; 参数包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--disk-cache&lt;/code&gt; =&amp;gt; &lt;code&gt;diskCacheEnabled&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--load-images&lt;/code&gt; =&amp;gt; &lt;code&gt;autoLoadImages&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--web-security&lt;/code&gt; =&amp;gt; &lt;code&gt;webSecurityEnabled&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--local-storage-path&lt;/code&gt; =&amp;gt; &lt;code&gt;offlineStoragePath&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--local-storage-quota&lt;/code&gt; =&amp;gt; &lt;code&gt;offlineStorageDefaultQuota&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--local-to-remote-url-access&lt;/code&gt; =&amp;gt; &lt;code&gt;localToRemoteUrlAccessEnabled&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Phantom-Object&quot;&gt;&lt;a href=&quot;#Phantom-Object&quot; class=&quot;headerlink&quot; title=&quot;Phantom Object&quot;&gt;&lt;/a&gt;Phantom Object&lt;/h2&gt;&lt;p&gt;&lt;code&gt;phantom&lt;/code&gt; 对象挂载在 window 对象下面，包含以下属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;phantom.cookies&lt;/code&gt;，对象数组，获取或设置 cookies，cookies 信息存储在 CookieJar 中&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantom.version&lt;/code&gt;，只读对象，返回当前 PhantomJS 的版本信息，类似 &lt;code&gt;{ &amp;quot;major&amp;quot;: 2, &amp;quot;minor&amp;quot;: 1, &amp;quot;patch&amp;quot;: 1 }&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantom.libraryPath&lt;/code&gt;，字符串，为 &lt;code&gt;injectJS()&lt;/code&gt; 设置查找路径&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantom.cookiesEnabled&lt;/code&gt;，布尔值，决定是否使用 CookieJar，默认值为 &lt;code&gt;true&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;包含以下方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;phantom.injectJS(filename)&lt;/code&gt;，该方法用于执行外部脚本，如果无法根据传入的 &lt;code&gt;filename&lt;/code&gt; 找到脚本，就使用 &lt;code&gt;libraryPath&lt;/code&gt; 指定的路径查找脚本。脚本注入成功后返回 true，否则返回 false&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantom.addCookie(Object)&lt;/code&gt;，向 CookieJar 添加 cookie 信息，操作成功返回 true，否则返回 false&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantom.clearCookies()&lt;/code&gt;，清空 CookieJar 中的 cookie 信息，无返回值。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantom.deleteCookie(cookieName)&lt;/code&gt;，删除 CookieJar 中包含 &lt;code&gt;cookieName&lt;/code&gt; 属性的 cookie，操作成功返回 true，否则返回 false&lt;/li&gt;
&lt;li&gt;&lt;code&gt;phantom.exit(returnValue)&lt;/code&gt;，结束程序，携带退出码 &lt;code&gt;returnValue&lt;/code&gt;，默认退出码为 0&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;包含以下事件处理器：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;onError&lt;/code&gt;，用于处理 &lt;code&gt;page.onError&lt;/code&gt; 没有捕获的 JavaScript 执行错误，常用于捕捉全局错误，接收两个参数，一个是错误信息，另一个是数组形式的堆栈跟踪信息&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Web-Page-module&quot;&gt;&lt;a href=&quot;#Web-Page-module&quot; class=&quot;headerlink&quot; title=&quot;Web Page module&quot;&gt;&lt;/a&gt;Web Page module&lt;/h2&gt;&lt;p&gt;通过 &lt;code&gt;require(webpage)&lt;/code&gt; 可以加载该模块，使用 &lt;code&gt;create()&lt;/code&gt; 方法可以创建该模块的实例：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; webpage = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;webpage&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; page = webpage.create();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;该模块包含以下属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;canGoBack&lt;/code&gt;，回退一页&lt;/li&gt;
&lt;li&gt;&lt;code&gt;canGoForward&lt;/code&gt;，前进一页&lt;/li&gt;
&lt;li&gt;&lt;code&gt;clipRect&lt;/code&gt;，对象，该属性规定了 &lt;code&gt;page.render()&lt;/code&gt; 方法对页面的裁减尺寸，默认裁剪整个页面&lt;/li&gt;
&lt;li&gt;&lt;code&gt;content&lt;/code&gt;，字符串，main frame 的原始内容（包含 HTML 元素），通过修改该属性可以设置新的页面内容&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cookies&lt;/code&gt;，设置或获取当前页面的 cookie&lt;/li&gt;
&lt;li&gt;&lt;code&gt;customHeaders&lt;/code&gt;，对象，给发送给服务器的 HTTP 请求头添加额外的信息，默认值为空对象 &lt;code&gt;{}&lt;/code&gt;，头信息的键值会被编码为 &lt;code&gt;US-ASCII&lt;/code&gt; 字符&lt;/li&gt;
&lt;li&gt;&lt;code&gt;event&lt;/code&gt;，键盘等事件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;focusedFrameName&lt;/code&gt;，当前激活的 Frame 页面名称&lt;/li&gt;
&lt;li&gt;&lt;code&gt;frameContent&lt;/code&gt;，字符串，当前激活的 Frame 的页面内容，修改该属性将会以新内容重载该页面&lt;/li&gt;
&lt;li&gt;&lt;code&gt;frameName&lt;/code&gt;，字符串，当前激活的 Frame 的页面名称&lt;/li&gt;
&lt;li&gt;&lt;code&gt;framePlainText&lt;/code&gt;，字符串，当前激活的 Frame 的页面内容，无 HTML 标签&lt;/li&gt;
&lt;li&gt;&lt;code&gt;frameTitle&lt;/code&gt;，字符串，当前激活的 Frame 的页面标题&lt;/li&gt;
&lt;li&gt;&lt;code&gt;frameUrl&lt;/code&gt;，只读字符串，当前激活的 Frame 的页面 URL&lt;/li&gt;
&lt;li&gt;&lt;code&gt;framesCount&lt;/code&gt;，Frame 的数量&lt;/li&gt;
&lt;li&gt;&lt;code&gt;framesName&lt;/code&gt;，所有 Frame 的名称&lt;/li&gt;
&lt;li&gt;&lt;code&gt;libraryPath&lt;/code&gt;，字符串，为 &lt;code&gt;page.injectJS&lt;/code&gt; 设置默认检索路径&lt;/li&gt;
&lt;li&gt;&lt;code&gt;navigationLocked&lt;/code&gt;，布尔值，是否离开当前页面，默认值为 false&lt;/li&gt;
&lt;li&gt;&lt;code&gt;offlineStoragePath&lt;/code&gt;，字符串，离线资源的存储位置&lt;/li&gt;
&lt;li&gt;&lt;code&gt;offlineStorageQuota&lt;/code&gt;，数值，允许离线存储的大小&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ownsPages&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pagesWindowName&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pages&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;paperSize&lt;/code&gt;，对象，定义了生成 PDF 的尺寸&lt;/li&gt;
&lt;li&gt;&lt;code&gt;plainText&lt;/code&gt;，只读字符串，页面内容，无 HTML 标签&lt;/li&gt;
&lt;li&gt;&lt;code&gt;scrollPosition&lt;/code&gt;，对象，滚动位置&lt;/li&gt;
&lt;li&gt;&lt;code&gt;title&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;url&lt;/code&gt;，字符串，当前页面的 URL&lt;/li&gt;
&lt;li&gt;&lt;code&gt;viewportSize&lt;/code&gt;，对象，常用于在初始化页面前设定 viewport 的大小，比如 &lt;code&gt;landscape&lt;/code&gt; 和 &lt;code&gt;portrait&lt;/code&gt;，该对象包含 &lt;code&gt;width&lt;/code&gt; 和 &lt;code&gt;height&lt;/code&gt; 两个属性&lt;/li&gt;
&lt;li&gt;&lt;code&gt;windowName&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;zoomFactor&lt;/code&gt;，数值，指定 &lt;code&gt;page.render&lt;/code&gt; 和 &lt;code&gt;page.renderBase64&lt;/code&gt; 方法的放大系数，默认值为 1，即 100% 放大&lt;/li&gt;
&lt;li&gt;&lt;code&gt;settings&lt;/code&gt;，对象，只能在调用 &lt;code&gt;page.open&lt;/code&gt; 方法初始化页面时调用该页面，其他时间定义该属性无效。该对象包含以下属性：&lt;ul&gt;
&lt;li&gt;&lt;code&gt;javascriptEnabled&lt;/code&gt;，是否允许在当前页面执行 JavaScript&lt;/li&gt;
&lt;li&gt;&lt;code&gt;loadImages&lt;/code&gt;，是否允许加载图片&lt;/li&gt;
&lt;li&gt;&lt;code&gt;localToRemoteUrlAccessEnabled&lt;/code&gt;，是否允许使用本地资源响应远程 URL &lt;/li&gt;
&lt;li&gt;&lt;code&gt;userAgent&lt;/code&gt;，用户代理&lt;/li&gt;
&lt;li&gt;&lt;code&gt;userName&lt;/code&gt;，HTTP 验证的用户名&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password&lt;/code&gt;，HTTP 验证的密码&lt;/li&gt;
&lt;li&gt;&lt;code&gt;XSSAuditingEnabled&lt;/code&gt;，是否监控跨域请求&lt;/li&gt;
&lt;li&gt;&lt;code&gt;webSecurityEnabled&lt;/code&gt;，是否启用网页安全&lt;/li&gt;
&lt;li&gt;&lt;code&gt;resourceTimeout&lt;/code&gt;，定义资源请求的延时时间，超时之后将会触发 &lt;code&gt;onResourceTimeout&lt;/code&gt; 事件&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;该模块包含以下方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;addCookie(cookie)&lt;/code&gt;，为页面添加 cookie 信息，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;clearCookies()&lt;/code&gt;，清除当前 URL 下的所有 cookie 信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;close()&lt;/code&gt;，关闭当前页面并清空内存&lt;/li&gt;
&lt;li&gt;&lt;code&gt;deleteCookie(cookieName)&lt;/code&gt;，删除当前 URL 下所有包含 &lt;code&gt;cookieName&lt;/code&gt; 属性的 cookie 信息，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;evaluteAsync(function, [delayMillis, arg1, arg2, ...])&lt;/code&gt;，在当前页面异步执行代码，第二个参数定义了延迟执行的时间&lt;/li&gt;
&lt;li&gt;&lt;code&gt;evaluteJavaScript(str)&lt;/code&gt;，在当前页面执行代码，代码必须写为字符串的形式&lt;/li&gt;
&lt;li&gt;&lt;code&gt;evalute(function, arg1, arg2, ...)&lt;/code&gt;，在当前页面执行代码&lt;/li&gt;
&lt;li&gt;&lt;code&gt;getPage(windowName)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;goBack()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;goForward()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;go(index)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;includeJs(url, callback)&lt;/code&gt;，向当前页面添加额外的脚本，且当脚本执行完毕后调用回调函数&lt;/li&gt;
&lt;li&gt;&lt;code&gt;injectJs(filename)&lt;/code&gt;，与 &lt;code&gt;includeJs&lt;/code&gt; 不同的是，加载的脚本可以跟当前页面不同域&lt;/li&gt;
&lt;li&gt;&lt;code&gt;openUrl(url, httpConf, settings)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;open(url, callback)&lt;/code&gt;、&lt;code&gt;open(url, method, callback)&lt;/code&gt;、&lt;code&gt;open(url, method, data, callback)&lt;/code&gt;、&lt;code&gt;open(url, settings, callback&lt;/code&gt;，打开 &lt;code&gt;url&lt;/code&gt; 页面，加载完成后触发回调函数，回电函数接收一个状态参数 &lt;code&gt;status&lt;/code&gt;，该状态函数的值为 &lt;code&gt;success&lt;/code&gt; 或 &lt;code&gt;fail&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;reload&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;renderBase64(format)&lt;/code&gt;，将页面导出为 &lt;code&gt;format&lt;/code&gt; 格式，该格式的可选值包括 &lt;code&gt;PNG&lt;/code&gt;、&lt;code&gt;GIF&lt;/code&gt; 和 &lt;code&gt;JPEG&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;render(filename[, {format, quality}])&lt;/code&gt;，将页面导出为 &lt;code&gt;fromat&lt;/code&gt; 格式，系统会根据指定的 &lt;code&gt;filename&lt;/code&gt; 文件名自动匹配格式，或者自定义格式，&lt;code&gt;quality&lt;/code&gt; 是 0~100 的数值，用于指定导出文件的质量&lt;/li&gt;
&lt;li&gt;对于鼠标事件，&lt;code&gt;sendEvent(mouseEventType[, mouseX, mouseY, button=&amp;quot;left&amp;quot;])&lt;/code&gt;，&lt;code&gt;mouseEventType&lt;/code&gt; 指定了事件类型，可选值包括 &lt;code&gt;mouseup&lt;/code&gt;、&lt;code&gt;mousedown&lt;/code&gt;、&lt;code&gt;mousemove&lt;/code&gt;、&lt;code&gt;doubleclick&lt;/code&gt; 和 &lt;code&gt;click&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;对于键盘事件，&lt;code&gt;sendEvent(keyboardEventType, keyOrKeys, [null, null, modifier])&lt;/code&gt;，&lt;code&gt;keyboardEventType&lt;/code&gt; 指定了事件类型，可选值包括 &lt;code&gt;keyup&lt;/code&gt;、&lt;code&gt;keypress&lt;/code&gt; 和 &lt;code&gt;keydown&lt;/code&gt;，第五个参数是修饰键&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setContent(content, url)&lt;/code&gt;，用于设定 &lt;code&gt;page.content&lt;/code&gt; 和 &lt;code&gt;page.url&lt;/code&gt; 属性，设定完成后会重载页面&lt;/li&gt;
&lt;li&gt;&lt;code&gt;stop()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;switchToFocusedFrame()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;switchToFrame(frameName)&lt;/code&gt; 或 &lt;code&gt;switchToFrame(framePosition)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;switchToMainFrame()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;switchToParentFrame()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;uploadFile(selector, filename)&lt;/code&gt;，将 &lt;code&gt;filename&lt;/code&gt; 上传到表单的 &lt;code&gt;selector&lt;/code&gt; 节点&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 模拟 Shift + Alt + A 键&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; webPage = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;webpage&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; page = webPage.create();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;page.sendEvent(&lt;span class=&quot;string&quot;&gt;&#39;keypress&#39;&lt;/span&gt;, page.event.key.A, &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0x02000000&lt;/span&gt; | &lt;span class=&quot;number&quot;&gt;0x08000000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;该模块包含以下事件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;onAlert&lt;/code&gt;，当页面出现 &lt;code&gt;alert&lt;/code&gt; 弹出框时触发该事件，接收一个字符串参数&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onCallback&lt;/code&gt;，当在网页调用 &lt;code&gt;window.callPhantom&lt;/code&gt; 时触发该事件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onClosing&lt;/code&gt;，当 &lt;code&gt;WebPage&lt;/code&gt; 实例被关闭时触发该事件，比如调用 &lt;code&gt;page.close()&lt;/code&gt; 或 &lt;code&gt;window.close()&lt;/code&gt;，接受一个 &lt;code&gt;closingPage&lt;/code&gt; 参数，指向关闭的页面&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onConfirm&lt;/code&gt;，当页面出现 &lt;code&gt;confirm&lt;/code&gt; 弹出框时触发该事件，接收一个字符串参数，并返回一个布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onConsoleMessage&lt;/code&gt;，当 JavaScript 中执行 &lt;code&gt;console&lt;/code&gt; 时就会触发该事件，接收三个参数 (message, lineNumber, sourceIdentifier)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onError&lt;/code&gt;，当 JavaScript 出现执行错误时就会触发该事件，接受两个参数，一个是表示错误信息的字符串，一个是表示堆栈跟踪信息的数组&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onFilePicker&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onInitialized&lt;/code&gt;，当 page 实例创建后且 URL 加载前触发该事件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onLoadFinished&lt;/code&gt;，当页面资源加载完成后触发该事件，接收一个表示加载状态的参数 &lt;code&gt;status&lt;/code&gt;，可选值为 “success” 和 “fail”&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onLoadStarted&lt;/code&gt;，当页面开始加载资源时触发该事件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onNavigationRequested&lt;/code&gt;，当页面跳转时触发该事件，回调函数接收四个参数，其中 &lt;code&gt;url&lt;/code&gt; 表示跳转的目标地址；&lt;code&gt;type&lt;/code&gt; 的可选值包括 Undefined/LinkClocked/FormSubmitted/BackOrForward/Reload/FormResubmitted/other；&lt;code&gt;willNavigate&lt;/code&gt; 是一个布尔值，表示是否会发生跳转；&lt;code&gt;main&lt;/code&gt; 是一个布尔值，表示事件是否来自于 main frame&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onPageCreated&lt;/code&gt;，当新建子窗口时触发该事件，比如 &lt;code&gt;window.open&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onPrompt&lt;/code&gt;，当页面出现 &lt;code&gt;prompt&lt;/code&gt; 弹出框时触发该事件，接收一个字符串参数，返回一个字符串&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onResourceError&lt;/code&gt;，当页面加载资源失败时触发该事件，回调函数接收一个 &lt;code&gt;resourceError&lt;/code&gt; 的对象，该对象包含四个属性（id, url, errorCode, errorString）。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onResourceReceived&lt;/code&gt;，当页面成功加载资源后触发该事件，回调函数接收一个 &lt;code&gt;response&lt;/code&gt; 对象，该对象包含多个属性（id, url, time, headers, bodySize, contentType, redirectURL, stage, status, statusText）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onResourceRequested&lt;/code&gt;，当页面请求资源时触发该事件，回调函数接收两个参数，一个是 &lt;code&gt;requestData&lt;/code&gt; 对象，另一个是 &lt;code&gt;networkRequest&lt;/code&gt; 对象。requestData 对象包含多个属性，包括（id, method, url, time, headers），&lt;code&gt;networkRequest&lt;/code&gt; 对象包含多个方法，包括 (abort, changeUrl(newUrl), setHeader(key, value))&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onResourceTimeout&lt;/code&gt;，当资源请求超时时触发该事件，回调函数接收一个 &lt;code&gt;request&lt;/code&gt; 对象作为参数，该对象包含多个属性（id, method, url, time, headers, errorCode, errorString）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;onUrlChanged&lt;/code&gt;，当 URL 发生变化时触发该事件，回调函数接收一个 &lt;code&gt;targetURL&lt;/code&gt; 的参数&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Child-Process-Module&quot;&gt;&lt;a href=&quot;#Child-Process-Module&quot; class=&quot;headerlink&quot; title=&quot;Child Process Module&quot;&gt;&lt;/a&gt;Child Process Module&lt;/h2&gt;&lt;p&gt;通过 &lt;code&gt;require(&amp;#39;child_process&amp;#39;)&lt;/code&gt; 可以加载 Child Process 模块，该模块常用于创建子进程处理输出、发送邮件和调用其他语言脚本等任务。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; process = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;child_process&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; spawn = process.spawn&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; execFile = process.execFile&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; child = spawn(&lt;span class=&quot;string&quot;&gt;&quot;ls&quot;&lt;/span&gt;, [&lt;span class=&quot;string&quot;&gt;&quot;-lF&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;/rooot&quot;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;child.stdout.on(&lt;span class=&quot;string&quot;&gt;&quot;data&quot;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;spawnSTDOUT:&quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.stringify(data))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;child.stderr.on(&lt;span class=&quot;string&quot;&gt;&quot;data&quot;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;data&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;spawnSTDERR:&quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.stringify(data))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;child.on(&lt;span class=&quot;string&quot;&gt;&quot;exit&quot;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;code&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;spawnEXIT:&quot;&lt;/span&gt;, code)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//child.kill(&quot;SIGKILL&quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;execFile(&lt;span class=&quot;string&quot;&gt;&quot;ls&quot;&lt;/span&gt;, [&lt;span class=&quot;string&quot;&gt;&quot;-lF&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;/usr&quot;&lt;/span&gt;], &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;err, stdout, stderr&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;execFileSTDOUT:&quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.stringify(stdout))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;execFileSTDERR:&quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;.stringify(stderr))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;File-System-Module&quot;&gt;&lt;a href=&quot;#File-System-Module&quot; class=&quot;headerlink&quot; title=&quot;File System Module&quot;&gt;&lt;/a&gt;File System Module&lt;/h2&gt;&lt;p&gt;通过 &lt;code&gt;require(&amp;#39;fs&amp;#39;)&lt;/code&gt; 可以加载 File System 模块，该模块常用于处理文件和目录相关的任务。&lt;/p&gt;
&lt;p&gt;该模块包含以下属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;separator&lt;/code&gt;，字符串，路径分隔符&lt;/li&gt;
&lt;li&gt;&lt;code&gt;workingDirectory&lt;/code&gt;，字符串，当前工作路径&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;该模块包含以下方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;absolute(path)&lt;/code&gt;，如果 &lt;code&gt;path&lt;/code&gt; 是绝对路径，则返回 &lt;code&gt;path&lt;/code&gt;；如果 &lt;code&gt;path&lt;/code&gt; 是相对路径，则返回该相对路径相对当前工作路径的路径&lt;/li&gt;
&lt;li&gt;&lt;code&gt;changeWorkingDirectory(path)&lt;/code&gt;，修改当前工作路径，如果修改成功，则返回 true，否则返回 false&lt;/li&gt;
&lt;li&gt;&lt;code&gt;copyTree(src, dest)&lt;/code&gt;，将 &lt;code&gt;src&lt;/code&gt; 路径下的文件拷贝到 &lt;code&gt;dest&lt;/code&gt; 路径下，默认递归拷贝，如果拷贝失败，则抛出错误并中断执行&lt;/li&gt;
&lt;li&gt;&lt;code&gt;copy(src, dest)&lt;/code&gt;，将 &lt;code&gt;src&lt;/code&gt; 文件拷贝为 &lt;code&gt;dest&lt;/code&gt; 文件，如果找不到 &lt;code&gt;src&lt;/code&gt; 文件或无法创建 &lt;code&gt;dest&lt;/code&gt; 文件，则抛出错误并中断执行&lt;/li&gt;
&lt;li&gt;&lt;code&gt;exissts(string)&lt;/code&gt;，判断文件是否存在，返回一个布尔值，同样适用于软链接&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isAbsolute(string)&lt;/code&gt;，判断路径是否是绝对路径，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isDirectory(string)&lt;/code&gt;，判断路径是否是目录，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isExecutable(string)&lt;/code&gt;，判断路径是否是可执行文件，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isFile(string)&lt;/code&gt;，判断路径是否是文件，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isLink(string)&lt;/code&gt;，判断路径是否是软链接，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isReadable(string)&lt;/code&gt;，判断文件是否可读，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;isWritable(stirng)&lt;/code&gt;，判断文件是否可写，返回布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;list(string)&lt;/code&gt;，参数 &lt;code&gt;string&lt;/code&gt; 表示相对路径，列出当前路径下的所有文件和目录&lt;/li&gt;
&lt;li&gt;&lt;code&gt;makeDirectory(string)&lt;/code&gt;，根据指定路径创建目录，返回值为布尔值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;makeTree(string)&lt;/code&gt;，递归创建目录，返回值为布尔值，如果目标目录已存在，同样返回 true&lt;/li&gt;
&lt;li&gt;&lt;code&gt;move(src, dest)&lt;/code&gt;，将 &lt;code&gt;src&lt;/code&gt; 移动到 &lt;code&gt;dest&lt;/code&gt;，如果 &lt;code&gt;src&lt;/code&gt; 不存在、无法删除或无法创建 &lt;code&gt;dest&lt;/code&gt; 文件，则抛出错误&lt;/li&gt;
&lt;li&gt;&lt;code&gt;open(path，{ mode, charset })&lt;/code&gt;，第二个参数接收包含两个属性，其中 &lt;code&gt;mode&lt;/code&gt; 的值是 ‘r’、’w’、’a/+’、’b’ 之一，&lt;code&gt;charset&lt;/code&gt; 是字符串编码名称。该方法返回一个 Stream 对象，开发者在使用完 Stream 之后有必要显式关闭它。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;readLink(string)&lt;/code&gt;，该方法返回软链接指向的真实文件或目录的绝对路径，如果传入的不是软链接，则返回空字符串&lt;/li&gt;
&lt;li&gt;&lt;code&gt;read(path, {mode, charset})&lt;/code&gt;，打开 &lt;code&gt;path&lt;/code&gt; 指定的文件并以字符串的形式返回所有内容&lt;/li&gt;
&lt;li&gt;&lt;code&gt;removeDirectory(string)&lt;/code&gt;，删除目录，删除时目录需要为空，否则会抛出错误&lt;/li&gt;
&lt;li&gt;&lt;code&gt;removeTree(string)&lt;/code&gt;，递归删除目录&lt;/li&gt;
&lt;li&gt;&lt;code&gt;remove(string)&lt;/code&gt;，删除文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;size(string)&lt;/code&gt;，如果文件存在，则返回表示文件大小的数值&lt;/li&gt;
&lt;li&gt;&lt;code&gt;touch(string)&lt;/code&gt;，创建空文件，如果文件已存在则不会抛出错误&lt;/li&gt;
&lt;li&gt;&lt;code&gt;write(src, content, {mode, charset})&lt;/code&gt;，如果无法向目标文件写入数据，则抛出错误并中断后续执行&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; fs = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;fs&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;LIST: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(fs.list());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;ABSOLUTE(): &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(fs.absolute(&lt;span class=&quot;string&quot;&gt;&#39;../&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;CHANGEWORKINGDIRECTORY: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(fs.changeWorkingDirectory(&lt;span class=&quot;string&quot;&gt;&#39;../&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(fs.workingDirectory);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;EXISTS: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(fs.exists(&lt;span class=&quot;string&quot;&gt;&#39;./index.js&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(fs.exists(&lt;span class=&quot;string&quot;&gt;&#39;./index.html&#39;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;phantom.exit(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;System-Module&quot;&gt;&lt;a href=&quot;#System-Module&quot; class=&quot;headerlink&quot; title=&quot;System Module&quot;&gt;&lt;/a&gt;System Module&lt;/h2&gt;&lt;p&gt;通过 &lt;code&gt;require(&amp;#39;system&amp;#39;)&lt;/code&gt; 可以加载 System 模块，该模块包含以下属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;os&lt;/code&gt;，只读对象，操作系统信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pid&lt;/code&gt;，只读数值，进程 ID&lt;/li&gt;
&lt;li&gt;&lt;code&gt;env&lt;/code&gt;，对象，键值对形式的环境变量&lt;/li&gt;
&lt;li&gt;&lt;code&gt;args&lt;/code&gt;，字符串数组，从终端传入的参数，数组中的第一个元素一定是脚本名称。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;platform&lt;/code&gt;，只读字符串，平台名称，总是返回 “phantomjs”&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; system = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;system&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;ARGS: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(system.args);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;OS: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.keys(system.os));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;ENV: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.keys(system.env));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;PID: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(system.pid);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;PLATFORM: &#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(system.platform);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Web-Server-Module&quot;&gt;&lt;a href=&quot;#Web-Server-Module&quot; class=&quot;headerlink&quot; title=&quot;Web Server Module&quot;&gt;&lt;/a&gt;Web Server Module&lt;/h2&gt;&lt;p&gt;通过 &lt;code&gt;require(&amp;#39;webserver&amp;#39;)&lt;/code&gt; 可以加载 Web Server 模块，该模块包含以下属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;port&lt;/code&gt;，只读属性，服务器监听的端口&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;包含以下方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;close()&lt;/code&gt;，该方法用于关闭服务器&lt;/li&gt;
&lt;li&gt;&lt;code&gt;listen()&lt;/code&gt;，该方法用于监听指定的端口，该方法接收三个参数，第一个参数是监听端口，既可以是 port（比如 8080），也可以是 ipaddress:port（比如 127.0.0.1:8080）；第二个参数是一个可选对象，该对象目前只包含属性 &lt;code&gt;keepAlive&lt;/code&gt;，如果值为 true，则使用持久连接；最后一个参数是一个回调函数，该回调函数接收 request 和 response 两个参数。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;回调函数中的 &lt;code&gt;request&lt;/code&gt; 对象包含以下属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;method&lt;/code&gt;，请求方法，比如 &lt;code&gt;GET&lt;/code&gt; 和 &lt;code&gt;POST&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;url&lt;/code&gt;，返回请求 URL 的路径和查询字符串部分&lt;/li&gt;
&lt;li&gt;&lt;code&gt;httpVersion&lt;/code&gt;，HTTP 版本&lt;/li&gt;
&lt;li&gt;&lt;code&gt;headers&lt;/code&gt;，键值对形式的 HTTP 头信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;post&lt;/code&gt;，请求体（对于 &lt;code&gt;POST&lt;/code&gt; 和 &lt;code&gt;PUT&lt;/code&gt; 请求有效）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;postRaw&lt;/code&gt;，如果 &lt;code&gt;Content-Type: application/x-www-form-urlencoded&lt;/code&gt;，post 的原始内容就会保存在该属性中，且 post 中的数据会被转义&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;回调函数中的 &lt;code&gt;response&lt;/code&gt; 对象包含以下属性和方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;headers&lt;/code&gt;，键值对形式的 HTTP 请求头，该属性必须调用 &lt;code&gt;write()&lt;/code&gt; 之前配置好&lt;/li&gt;
&lt;li&gt;&lt;code&gt;statusCode&lt;/code&gt;，设置返回的 HTTP 状态码&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setHeader(name, value)&lt;/code&gt;，设置头信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;header(name)&lt;/code&gt;，获取头信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setEncoding(encoding)&lt;/code&gt;，设置数据的编码格式，默认值为 UTF-8，如果数据是二进制数据，则应该设为 “binary”&lt;/li&gt;
&lt;li&gt;&lt;code&gt;write(data)&lt;/code&gt;，向响应体发送数据块，可以反复调用&lt;/li&gt;
&lt;li&gt;&lt;code&gt;writeHead(statusCode, headers)&lt;/code&gt;，向请求发送响应头信息，&lt;code&gt;statusCode&lt;/code&gt; 是一个三位的 HTTP 状态码，&lt;code&gt;headers&lt;/code&gt; 是响应头信息&lt;/li&gt;
&lt;li&gt;&lt;code&gt;close()&lt;/code&gt;，关闭 HTTP 连接。为了避免客户端检测到连接中断，最后最好调用一下 &lt;code&gt;write()&lt;/code&gt;，比如 &lt;code&gt;response.write(&amp;quot;&amp;quot;)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;closeGracefully()&lt;/code&gt;，&lt;code&gt;close()&lt;/code&gt; 的温和版本，确保优先发送响应头信息并在最后发送 &lt;code&gt;response.write(&amp;quot;&amp;quot;)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; webserver = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;webserver&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; server = webserver.create();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; service = server.listen(&lt;span class=&quot;string&quot;&gt;&#39;127.0.0.1:8989&#39;&lt;/span&gt;, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    keepAlive: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req, res&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    res.statusCode = &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    res.write(&lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;Hello!Sean&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    res.close();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;Server is runing at &quot;&lt;/span&gt; + server.port);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;实践演练&quot;&gt;&lt;a href=&quot;#实践演练&quot; class=&quot;headerlink&quot; title=&quot;实践演练&quot;&gt;&lt;/a&gt;实践演练&lt;/h2&gt;&lt;h5 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h5&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://phantomjs.org/documentation/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PhantomJS 官方文档&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://phantomjs.org/api/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PhantomJS 官方 API&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://github.com/ariya/phantomjs/&quot;&gt;PhantomJS&lt;/a&gt; 是一个脚本化的无界面 WebKit，以 JavaScript 为脚本语言实现各项功能，官方列举的使用场景包括：无界面测试，页面自动化，屏幕截图和网络监控。在 Mac 下，可以使用 Homebrew 安装最新版本：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brew install phantomjs&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>读《图解 TCP/IP》（未完成）</title>
    <link href="http://pinggod.com/2016/%E8%AF%BB%E3%80%8A%E5%9B%BE%E8%A7%A3-TCP-IP%E3%80%8B/"/>
    <id>http://pinggod.com/2016/读《图解-TCP-IP》/</id>
    <published>2016-04-12T13:38:11.000Z</published>
    <updated>2016-04-13T12:44:33.000Z</updated>
    
    <content type="html">&lt;p&gt;TCP/IP 协议并不单指 TCP 和 IP 两种协议，在大多数情况下，它是进行 IP 通讯所必须用到的协议群的统称，有时也称 TCP/IP 为网络协议族（Internet Protocol Suite）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/tcp-ip-protocol-group-2016-04-13.png&quot; alt=&quot;tcp-ip-protocol-group-2016-04-13&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;OSI 参考模型注重的是&lt;strong&gt;通信协议必要的功能是什么&lt;/strong&gt;，而 TCP/IP 则更强调&lt;strong&gt;在计算机上实现协议需要哪些程序&lt;/strong&gt;，具体可以将 TCP/IP 协议分为五层：由应用程序实现的应用层（DNS、URI、HTTP、TLS/SSL…）；由操作系统实现的传输层（TCP、UDP…）和网络层（ARP、IP…）；由设备驱动程序与网络接口实现的数据链路层和物理层。&lt;/p&gt;
&lt;p&gt;IP 协议应用于网络层，它约定了跨网传输数据的规范，传输过程中以 IP 地址作为主机的标识，核心是基于 IP 地址转发分包数据的协议。虽然 IP 协议是一种分组交换协议，但不具有重发机制，属于不可靠传输协议。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/data-package-header-2016-04-13.png&quot; alt=&quot;data-package-header-2016-04-13&quot;&gt;&lt;/p&gt;
&lt;p&gt;数据每经过一个分层，就会被添加一个首部，该首部保存了当前层的配置信息，而对于下一层来说，从上一层发送过来的所有包都被认为是数据，这些数据经过再次打包会继续往下一层传递。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;包、帧、数据报、段、消息&lt;/strong&gt;&lt;br&gt;以上五个术语都是用来描述数据的单位，其中，包是一个全能性的术语；帧是数据链路层中包的单位；数据报是 IP 和 UDP 等网络层以上层次中包的单位；段表示 TCP 数据流中的信息；消息是应用协议中数据的单位。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;数据链路层&quot;&gt;&lt;a href=&quot;#数据链路层&quot; class=&quot;headerlink&quot; title=&quot;数据链路层&quot;&gt;&lt;/a&gt;数据链路层&lt;/h2&gt;&lt;h2 id=&quot;待整理资料&quot;&gt;&lt;a href=&quot;#待整理资料&quot; class=&quot;headerlink&quot; title=&quot;待整理资料&quot;&gt;&lt;/a&gt;待整理资料&lt;/h2&gt;&lt;p&gt;MAC 地址由制造商识别号、制造商内部产品编号和产品通用编号组成，具有唯一性，IP 地址在具有唯一性的同时还具有层次性，当通信主题的 IP 地址不同、主机号不同，但网路号相同时，说明它们处于同一个网段。MAC 和 IP 的寻址方式是一样的，只不过 MAC 寻址使用地址转发表，IP 寻址使用路由控制表。&lt;/p&gt;
&lt;h6 id=&quot;术语表&quot;&gt;&lt;a href=&quot;#术语表&quot; class=&quot;headerlink&quot; title=&quot;术语表&quot;&gt;&lt;/a&gt;术语表&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;WAN（Wide Area Network）&lt;/code&gt;，广域网&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MAN（Metropolitan Area Network）&lt;/code&gt;，城域网&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LAN（Local Area Network）&lt;/code&gt;，局域网&lt;/li&gt;
&lt;li&gt;&lt;code&gt;批处理（Batch Processing）&lt;/code&gt;，事先将程序和数据写入卡带，由计算机按顺序批量处理的系统&lt;/li&gt;
&lt;li&gt;&lt;code&gt;分时系统（TSS）&lt;/code&gt;，允许多用户同时使用一台计算机，计算机对 CPU 按时间进行切片供多用户使用&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ISO（International Organization for Standards）&lt;/code&gt;，国际标准化组织&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OSI（Open Systems Interconnection）&lt;/code&gt;，开放式通信系统互联参考模型&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Unicast&lt;/code&gt;，单播，一对一通信，比如固话通信&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Broadcast&lt;/code&gt;，广播，一对多通信，比如电视信号的发送&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Multicast&lt;/code&gt;，多播，比如电话会议&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Anycast&lt;/code&gt;，任播，比如 DNS 根域名解析服务器&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ICMP&lt;/code&gt;，用于向发送端反馈异常或检测网络稳定性的协议&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ARP&lt;/code&gt;，从分组数据包的 IP 地址解析出物理地址（MAC）的协议&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;TCP/IP 协议并不单指 TCP 和 IP 两种协议，在大多数情况下，它是进行 IP 通讯所必须用到的协议群的统称，有时也称 TCP/IP 为网络协议族（Internet Protocol Suite）。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/tcp-ip-protocol-group-2016-04-13.png&quot; alt=&quot;tcp-ip-protocol-group-2016-04-13&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>GET vs POST</title>
    <link href="http://pinggod.com/2016/GET-vs-POST/"/>
    <id>http://pinggod.com/2016/GET-vs-POST/</id>
    <published>2016-04-11T05:54:12.000Z</published>
    <updated>2016-04-11T14:10:43.000Z</updated>
    
    <content type="html">&lt;p&gt;发起 HTTP 请求有四种基本方法：PUT、DELETE、POST 和 GET，通俗讲可以认为对应于增删改查四个方面。根据 HTTP 规范，GET 请求用于获取信息，是安全和幂等的，这里的安全并不代表不会泄露信息，而是说它用来获取信息，查询数据库，不会影响数据库的数据，也不会影响资源的状态；POST 请求则有可能会修改服务器上数据库的数据和资源的状态。&lt;/p&gt;
&lt;p&gt;对于 &lt;code&gt;&amp;lt;form&amp;gt;&amp;lt;/form&amp;gt;&lt;/code&gt; 标签，其 &lt;code&gt;action&lt;/code&gt; 属性的默认值是 GET，可以修改为 POST。使用 GET 时，表单数据中的数据会被转义并以查询字符串的形式追加到 URL 的尾部；使用 POST 时，表单数据会依附请求体发送给服务器。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;下面的表格从多方面比较了两者的差异：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;维度&lt;/th&gt;
&lt;th&gt;GET（HTTP）&lt;/th&gt;
&lt;th&gt;POST（HTTP）&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;历史记录&lt;/td&gt;
&lt;td&gt;由于数据被添加到了 URL 中，所以会保留在浏览器的历史记录之中&lt;/td&gt;
&lt;td&gt;数据不会保留在浏览器的历史记录之中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;书签&lt;/td&gt;
&lt;td&gt;可收藏为书签&lt;/td&gt;
&lt;td&gt;不可收藏为书签&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;后退和重新提交&lt;/td&gt;
&lt;td&gt;如果 HTML 被浏览器缓存了，则重新执行 GET 请求可能不会向服务器重新提交数据&lt;/td&gt;
&lt;td&gt;浏览器应该提醒用户：数据需要重新提交&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;编码格式&lt;/td&gt;
&lt;td&gt;“application/x-www-form-urlencoded”&lt;/td&gt;
&lt;td&gt;“multipart/form-data”（主要用于二进制数据）或 “application/x-www-form-urlencoded”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;参数&lt;/td&gt;
&lt;td&gt;长度受限于 URL 的长度，通常在 2K 以内，具体长度取决于浏览器和服务器&lt;/td&gt;
&lt;td&gt;可发送参数，包括上传的文件等&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;是否可以修改&lt;/td&gt;
&lt;td&gt;可被脚本修改&lt;/td&gt;
&lt;td&gt;比较难修改&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;数据类型是否有限制&lt;/td&gt;
&lt;td&gt;只接受 ASCII 字符，其他字符会被转义&lt;/td&gt;
&lt;td&gt;无限制，可接收二进制数据&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;安全性&lt;/td&gt;
&lt;td&gt;GET 相比于 POST 的安全性低，因为发送的数据在 URL 中可见，且可以被浏览器历史记录、服务器日志记录&lt;/td&gt;
&lt;td&gt;POST 的参数不会被浏览器历史记录和服务器日记记录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;数据长度限制&lt;/td&gt;
&lt;td&gt;受限于 URL 的长度，通常小于 2K，具体限制取决于浏览器和服务器&lt;/td&gt;
&lt;td&gt;无限制，实际上也受限于服务器，但相比 GET 要长很多&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;可用性&lt;/td&gt;
&lt;td&gt;GET 请求不应该用于发送密码等私密信息&lt;/td&gt;
&lt;td&gt;POST 请求可用于发送密码等私密信息&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;可见性&lt;/td&gt;
&lt;td&gt;GET 请求对任何人都可见并且有长度限制&lt;/td&gt;
&lt;td&gt;POST 请求的数据不会显示在 URL 中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;缓存&lt;/td&gt;
&lt;td&gt;可被缓存&lt;/td&gt;
&lt;td&gt;不可被缓存&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;优点和缺点&quot;&gt;&lt;a href=&quot;#优点和缺点&quot; class=&quot;headerlink&quot; title=&quot;优点和缺点&quot;&gt;&lt;/a&gt;优点和缺点&lt;/h2&gt;&lt;p&gt;当使用 GET 请求发送表单数据时：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;表单数据只能是 ASCII 字符，其他字符需要被转义为 ASCII 格式，但 POST 请求可以处理二进制数据、图片和其他文件&lt;/li&gt;
&lt;li&gt;所有的表单数据对于 URL 都是可见的，而且会被缓存在浏览器的历史记录中，降低了安全性&lt;/li&gt;
&lt;li&gt;GET 请求的一个优势是表单数据可以被收藏为书签，也可以直接用于填充表单数据&lt;/li&gt;
&lt;li&gt;表单数据的长度会受到 URL 长度的限制&lt;/li&gt;
&lt;li&gt;易于遭受脚本攻击&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;服务器端&quot;&gt;&lt;a href=&quot;#服务器端&quot; class=&quot;headerlink&quot; title=&quot;服务器端&quot;&gt;&lt;/a&gt;服务器端&lt;/h2&gt;&lt;p&gt;由于 GET 和 POST 对数据的编码方式不同，所以在服务端解码数据的方式也不同。在 ASP 中，服务端使用 &lt;code&gt;Request.QueryString&lt;/code&gt; 获取 GET 请求参数，使用 &lt;code&gt;Request.Form&lt;/code&gt; 获取 POST 请求参数。&lt;/p&gt;
&lt;h2 id=&quot;HTTPS&quot;&gt;&lt;a href=&quot;#HTTPS&quot; class=&quot;headerlink&quot; title=&quot;HTTPS&quot;&gt;&lt;/a&gt;HTTPS&lt;/h2&gt;&lt;p&gt;使用 HTTPS 发起 GET 请求是否会更安全些呢？我们就做如下的请求来回答这一问题：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;GET https://www.example.com/login.php?user=mickey&amp;amp;passwd=mini&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;假设有人监视了这一 GET 请求，那么他只会看到如下信息：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;这是一个 HTTPS 链接&lt;/li&gt;
&lt;li&gt;域名 &lt;code&gt;www.example.com&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;请求的长度&lt;/li&gt;
&lt;li&gt;响应的长度&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;URL 路径以及查询字符串都是不可见的。由此可见，在这些方面，GET 请求和 POST 请求的安全性相同。但是，浏览器仍然会记录 URL，所以无论是 HTTP 还是 HTTPS，使用 GET 发送敏感信息仍是不安全的。&lt;/p&gt;
&lt;h6 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.diffen.com/difference/GET_%28HTTP%29_vs_POST_%28HTTP%29%23Differences_in_Server-Side_Processing&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GET vs. POST&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/hyddd/archive/2009/03/31/1426026.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;浅谈 HTTP 中的 GET 和 POST 的区别&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;发起 HTTP 请求有四种基本方法：PUT、DELETE、POST 和 GET，通俗讲可以认为对应于增删改查四个方面。根据 HTTP 规范，GET 请求用于获取信息，是安全和幂等的，这里的安全并不代表不会泄露信息，而是说它用来获取信息，查询数据库，不会影响数据库的数据，也不会影响资源的状态；POST 请求则有可能会修改服务器上数据库的数据和资源的状态。&lt;/p&gt;
&lt;p&gt;对于 &lt;code&gt;&amp;lt;form&amp;gt;&amp;lt;/form&amp;gt;&lt;/code&gt; 标签，其 &lt;code&gt;action&lt;/code&gt; 属性的默认值是 GET，可以修改为 POST。使用 GET 时，表单数据中的数据会被转义并以查询字符串的形式追加到 URL 的尾部；使用 POST 时，表单数据会依附请求体发送给服务器。&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>读《高性能网站建设指南》</title>
    <link href="http://pinggod.com/2016/%E8%AF%BB%E3%80%8A%E9%AB%98%E6%80%A7%E8%83%BD%E7%BD%91%E7%AB%99%E5%BB%BA%E8%AE%BE%E6%8C%87%E5%8D%97%E3%80%8B/"/>
    <id>http://pinggod.com/2016/读《高性能网站建设指南》/</id>
    <published>2016-04-07T02:13:10.000Z</published>
    <updated>2016-04-12T05:48:35.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;img src=&quot;/img/browser-fetch-flow-2016-04-07.png&quot; alt=&quot;browser-fetch-flow-2016-04-07.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;《高性能网站建设指南》中文版出版于 2008 年，是雅虎前端团队在性能方面持续研究的成果。虽然书中内容相对当前的技术栈或多或少存在一些陈旧和不适，但仍是了解前端性能优化的不二入门读物。以前上学的时候，上了年纪的老教师最喜欢讲一句话：万变不离其宗。这是一句放诸四海而皆准的教条，诚不欺我。&lt;/p&gt;
&lt;p&gt;前端性能优化，既有宏观方面的考量也有细微之处的锱铢必较。做性能优化的目的不是减少用户下载页面资源的时间，而是减少用户等待页面响应的时间。下面的表格显示了用户对不同延迟时间的心理反馈：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;延迟时间&lt;/th&gt;
&lt;th&gt;心理反馈&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;0~16ms&lt;/td&gt;
&lt;td&gt;屏幕帧速在 60 帧以上，用户感觉不到响应卡顿、跳帧和延迟等现象，用户体验极其优秀&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;0~100ms&lt;/td&gt;
&lt;td&gt;程序反应迅速，体验良好，如果响应超过 100ms，用户将会感受到响应不及时&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;100~300ms&lt;/td&gt;
&lt;td&gt;用户将会感受到轻微的响应延迟&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;300~1000ms&lt;/td&gt;
&lt;td&gt;用户将会感受到渐进式的响应，对于网页来说，加载资源和重绘页面视图都是响应的类型&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;1000+ms&lt;/td&gt;
&lt;td&gt;用户将对当前的操作失去耐心和信心&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10000+ms&lt;/td&gt;
&lt;td&gt;用户将会放弃当前的操作，或许也将否定该网站&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;下图记录的是当前博客首次加载资源的耗时情况，其中红色标出的地方是页面加载时间，这个时间包含两个部分，上边是总共用时，下边是延迟时间（Latency，等待资源传送的时间），从中可以发现，延迟时间平均占据了总时间的 80%~90%：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/resources-loading-times-2016-04-07.png&quot; alt=&quot;resources-loading-times-2016-04-07&quot;&gt;&lt;/p&gt;
&lt;p&gt;通常来说，改进前端性能所需要的资源和时间，往往要小于后端。后端需要通过重构架构、优化路径、更改硬件、分布化数据库等重操作才能明显改进性能，且优化周期长达数周或数月之久。&lt;/p&gt;
&lt;p&gt;前端性能优化已经被证实是高效和可维护的开发行为，后面将会一一介绍十四条常规的优化规则。相关规则的优化不仅仅限于前端方向，和后端以及网络通信都有一定的联系。&lt;/p&gt;
&lt;h2 id=&quot;HTTP&quot;&gt;&lt;a href=&quot;#HTTP&quot; class=&quot;headerlink&quot; title=&quot;HTTP&quot;&gt;&lt;/a&gt;HTTP&lt;/h2&gt;&lt;p&gt;HTTP 是一种客户端/服务器协议，由请求和响应构成。作为客户端，当浏览器向特定 URL 发送 HTTP 请求后，URL 对应的宿主服务器就会返回 HTTP 响应。该协议以纯文本格式发送信息，请求类型包括：GET、POST、HEAD、DELETE、OPTIONS 和 TRACE。&lt;/p&gt;
&lt;p&gt;我们最常用的是 GET 请求，下面展示了首次请求 &lt;code&gt;pinggod.com/index.html&lt;/code&gt; 资源时发送的请求信息和响应信息（状态码、头信息以及响应体）：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Request&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;GET / HTTP/1.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Host: pinggod.com&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection: keep-alive&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Pragma: no-cache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Cache-Control: no-cache&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# and so on ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Response&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;HTTP/1.1 200 OK&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Server: GitHub.com&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Date: Fri, 08 Apr 2016 16:35:38 GMT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Type: text/html; charset=utf-8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# and so on ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;减少-HTTP-请求&quot;&gt;&lt;a href=&quot;#减少-HTTP-请求&quot; class=&quot;headerlink&quot; title=&quot;减少 HTTP 请求&quot;&gt;&lt;/a&gt;减少 HTTP 请求&lt;/h2&gt;&lt;p&gt;在前图中我们已经看到，每次接收到的 HTTP 响应，有 80%~90% 的时间花在了响应时间上，而不是资源的下载时间，这也就是说，随着 HTTP 请求/响应量的增多，所浪费的时间也就更多，所以，减少 HTTP 请求/响应的数量，将会直接减少资源的响应时间，带来前端页面 50% 以上的响应速度优化。&lt;/p&gt;
&lt;p&gt;下面是一些优化资源首次加载的方法，对于后续页面的浏览，可以使用其他优化规则：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;图片地图，即 HTML 的 &lt;code&gt;&amp;lt;map name=&amp;quot;&amp;quot;&amp;gt;&amp;lt;/map&amp;gt;&lt;/code&gt; 标签&lt;/li&gt;
&lt;li&gt;CSS Sprites，使用一张图片集成多个小图片，使用一次请求获取集成后的图片，通过 CSS 属性控制图片的显示，这一技术不仅可以减少 HTTP 请求，还可以减少下载的资源体积，这是因为合并后的图片减少了大量重复性的图片信息，比如颜色表、格式信息等等&lt;/li&gt;
&lt;li&gt;内联图片，即 &lt;code&gt;&amp;lt;img src=&amp;quot;data:[&amp;lt;mediatype&amp;gt;][;base64], &amp;lt;data&amp;gt;&amp;quot; alt=&amp;quot;&amp;quot;&amp;gt;&lt;/code&gt;，缺点是 Base64 编码会增加图片的大小，且不能够被缓存&lt;/li&gt;
&lt;li&gt;合并 JavaScript 和 CSS&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;本文不会涉及 HTTP2 的内容，但是在这里有必要提及的是，HTTP2 的多路复用特性相比于人工维护的 CSS Sprites 等技术具有更高的可维护性和开发效率。&lt;br&gt;&lt;/div&gt;

&lt;h2 id=&quot;CDN&quot;&gt;&lt;a href=&quot;#CDN&quot; class=&quot;headerlink&quot; title=&quot;CDN&quot;&gt;&lt;/a&gt;CDN&lt;/h2&gt;&lt;p&gt;内容分发网络（CDN，Content Delivery Networks) 是一组分布在不同地理位置的 Web 服务器，通过就近原则提高资源响应速度。CDN 既能提高性能，还能节省成本。在优化性能时，CDN 可以选择网络阶跃数最小的服务器或响应最短的服务器向用户提供内容。&lt;/p&gt;
&lt;p&gt;除了性能方面的考量，使用 CDN 还可以提供数据备份、扩展存储能力和内容缓存的功能，有助于缓和 Web 峰值流量带来的压力。&lt;/p&gt;
&lt;p&gt;CDN 常用于分发静态资源，比如图片、脚本和样式表，这是因为静态资源具有较少的依赖性。对于地理位置分散的用户，CDN 可以轻易改善资源的响应速度。&lt;/p&gt;
&lt;h2 id=&quot;Last-Modified-amp-amp-Expires-amp-amp-Cache-control&quot;&gt;&lt;a href=&quot;#Last-Modified-amp-amp-Expires-amp-amp-Cache-control&quot; class=&quot;headerlink&quot; title=&quot;Last-Modified &amp;amp;&amp;amp; Expires &amp;amp;&amp;amp; Cache-control&quot;&gt;&lt;/a&gt;Last-Modified &amp;amp;&amp;amp; Expires &amp;amp;&amp;amp; Cache-control&lt;/h2&gt;&lt;p&gt;服务器向客户端发送的响应资源会携带一条 &lt;code&gt;Last-Modified&lt;/code&gt; 头信息，用于通知客户端该资源的最新更新时间。当客户端再次请求该资源的时候，为了确定该资源是否有效，就会发起一个条件 GET 请求（Conditional GET Request），该请求携带 &lt;code&gt;If-Modified-Since&lt;/code&gt; 头信息，便于服务器验证资源是否过期，如果资源没有过期，则服务器返回 &lt;code&gt;304 Not Modified&lt;/code&gt; 状态码并不发送响应体，从而实现更快更轻量的响应。此外，还有 &lt;code&gt;ETag&lt;/code&gt; 和 &lt;code&gt;If-None-Match&lt;/code&gt; 两种执行条件 GET 请求的方式。&lt;/p&gt;
&lt;p&gt;虽然 &lt;code&gt;Last-Modified / If-Modified-Since&lt;/code&gt; 等条件 GET 请求和 304 响应加快了页面响应，但该机制仍在客户端和服务器之间执行了一次请求/响应，以进行有效性检查。针对这一问题，我们可以使用 &lt;code&gt;Expires&lt;/code&gt; 头信息来解决，Expires 头信息的值是一个时间戳（timestamp）。当浏览器在时间戳之前再次访问该资源时，会直接从浏览器缓存获取该资源，不会发起任何 HTTP 请求。&lt;/p&gt;
&lt;p&gt;虽然 Expires 头信息消除了 HTTP 校验请求，但也带了新的问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;由于它的值是一个特定日期，所以客户端和服务器必须保持严格的时钟同步&lt;/li&gt;
&lt;li&gt;过期日期需要经常校验，且过期后需提供新的时间戳&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;针对这一问题，HTTP 1.1 引入了 &lt;code&gt;Cache-Control: max-age=&amp;lt;Integer&amp;gt;&lt;/code&gt; 头信息，它的值以秒为单位。在 Cache-Control 允许的时间内，浏览器都会直接从缓存中获取资源。max-age 接收的有效期非常长，甚至长达十年之久。此外，HTTP 规定，当同时存在 max-age 指令和 Expires 头信息时，优先使用 max-age。&lt;/p&gt;
&lt;p&gt;当静态资源被浏览器缓存后，用户如何在缓存有效期内获取修改后的资源呢？首先，不建议缓存 HTML 文档；其次，通过在 HTML 文件中修订资源名的方式通知浏览器获取新的资源。修订资源名的方式多种多样，比如添加时间戳、版本号等。&lt;/p&gt;
&lt;h2 id=&quot;压缩&quot;&gt;&lt;a href=&quot;#压缩&quot; class=&quot;headerlink&quot; title=&quot;压缩&quot;&gt;&lt;/a&gt;压缩&lt;/h2&gt;&lt;p&gt;客户端在向服务器发送 HTTP 请求时，可以携带 &lt;code&gt;Accept-Encoding&lt;/code&gt; 头信息来告知服务器客户端支持哪些压缩格式。服务器在响应信息中使用 &lt;code&gt;Content-Encoding&lt;/code&gt; 头信息通知当前资源的压缩格式：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Request&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Accept-Encoding: gzip deflate&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Response&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Content-Encoding: gzip&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;压缩需要客户端和服务器耗费额外的 CPU 资源进行解压缩，通常来说，图片和 PDF 都是已经压缩过得资源，无需再次压缩，而脚本和样式表是值得压缩的。&lt;/p&gt;
&lt;p&gt;当浏览器通过代理服务器与资源服务器通信时，由于接入代理服务器的客户端不一定支持相同的压缩格式，甚至不支持压缩格式，所以需要一种机制通知代理服务器向资源服务器请求所有压缩格式（包括未压缩格式）的资源，便于分发给不同的客户端。这一机制就是利用资源服务器向代理服务器发送 &lt;code&gt;Vary&lt;/code&gt; 头信息：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Response&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Vary: Accept-Encoding&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;浏览器渲染机制&quot;&gt;&lt;a href=&quot;#浏览器渲染机制&quot; class=&quot;headerlink&quot; title=&quot;浏览器渲染机制&quot;&gt;&lt;/a&gt;浏览器渲染机制&lt;/h2&gt;&lt;p&gt;在这一节，本书推荐了两个法则：将样式表置于文档顶部，将脚本置于文档底部。浏览器绘制出首屏内容前，必须完成 DOM 树和 CSS 样式规则的解析，然后合成渲染树，所以，优先加载文档和样式资源就可以加快首屏渲染速度。反之，如果将样式表置于文档底部，则只有加载完样式表之前的所有资源才会加载样式表，直接影响了浏览器合成渲染树绘制首屏内容的流程。&lt;/p&gt;
&lt;p&gt;HTTP 1.1 规范建议浏览器从每个主机名并行地下载两个资源，这也就是说，主机名越多，并行下载量就会越多。但事实上情况并不是这样的，当主机名增多之后，并行解析大量资源会占用大量的 CPU 性能，并增加 DNS 查询时间，更多信息请参考 &lt;a href=&quot;http://yuiblog.com/blog/2007/04/11/performance-research-part-4/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Maximizing Parallel Downloads in the Carpool Lane&lt;/a&gt; 一文。&lt;/p&gt;
&lt;p&gt;将脚本置于文档底部，有两个直接原因：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;脚本会阻塞后面文档内容的渲染&lt;/li&gt;
&lt;li&gt;脚本资源会阻塞其他资源的并行加载&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;浏览器之所以存在这样的机制，是因为 JavaScript 缺乏模块机制，如果不同的 JavaScript 之间存在依赖关系，就必须优先加载依赖脚本。对此可能还存在其他原因，此处留待修改。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;外部脚本和样式&quot;&gt;&lt;a href=&quot;#外部脚本和样式&quot; class=&quot;headerlink&quot; title=&quot;外部脚本和样式&quot;&gt;&lt;/a&gt;外部脚本和样式&lt;/h2&gt;&lt;p&gt;将脚本和样式以独立资源的形式存储和获取，便于在多个页面之间进行复用，尤其是配合 CDN、浏览器缓存的情况下，性能优化效果巨大。&lt;/p&gt;
&lt;p&gt;抛开性能方面的考量，将脚本和样式表从文档中独立出来，也有助于提高可读性和可维护性。&lt;/p&gt;
&lt;p&gt;这一规则并不是绝对的，比如对于浏览器主页来说，它们的访问量大、组件复用率低，通常用户的第二次跳转都是其他的网站。&lt;/p&gt;
&lt;h2 id=&quot;DNS-查询&quot;&gt;&lt;a href=&quot;#DNS-查询&quot; class=&quot;headerlink&quot; title=&quot;DNS 查询&quot;&gt;&lt;/a&gt;DNS 查询&lt;/h2&gt;&lt;p&gt;IP 地址和域名的关系就像是电话本中的电话号码和联系人姓名，DNS 是一套帮助浏览器根据域名查找 IP 地址的系统。DNS 查询也会占用时间，通常浏览器查找一个特定主机名的 IP 需要花费 20~120ms 的时间。&lt;/p&gt;
&lt;p&gt;就像对待静态资源一样，浏览器也可以缓存 DNS 数据，便于再次查找某个主机名时，短时间内不再进行 DNS 查询。查询到的 DNS 记录通常包含 TTL（Time-to-live，存活时间），用于告知客户端该记录的缓存时长。操作系统会考虑 TTL 的值，但浏览器并不会，它有自己的时间限制，此外，浏览器对 DNS 记录的数量也有限制，好在即使浏览器的 DNS 记录丢了，还可以使用操作系统缓存的记录。&lt;/p&gt;
&lt;p&gt;持久连接（Persisent Connection）可以让浏览器在单一连接上发送多个请求，避免了重复创建 socket 连接的低效问题。浏览器和服务器都是通过发送 &lt;code&gt;Connection: Keep-Alive&lt;/code&gt; 头信息来表示持久连接，发送 &lt;code&gt;Connection: close&lt;/code&gt; 来关闭持久连接：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Request &amp;amp;&amp;amp; Response&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection: keep-alive&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Close Persisent Connection&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Connection: close&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当浏览器和服务器之间是持久连接时，没有理由进行 DNS 查询。&lt;code&gt;Connection: keep-alive&lt;/code&gt; 连接可以同时覆盖 TTL 和浏览器的对 DNS 记录的时间限制。&lt;/p&gt;
&lt;p&gt;之前提过，增加主机名可以增加并行下载量，但也会增加 DNS 查询，两相权衡取其轻，最好不要少于两个主机名，也不要大于四个主机名。&lt;/p&gt;
&lt;h2 id=&quot;精简&quot;&gt;&lt;a href=&quot;#精简&quot; class=&quot;headerlink&quot; title=&quot;精简&quot;&gt;&lt;/a&gt;精简&lt;/h2&gt;&lt;p&gt;这里涉及三个名词：压缩、精简和混淆。压缩的原理是根据重复字节创建一个词典，缩减重复的字节；精简的原理是去除代码中无关的内容，比如注释、空白等；混淆常使用较短的名称替换变量名、函数名。&lt;/p&gt;
&lt;h2 id=&quot;重定向&quot;&gt;&lt;a href=&quot;#重定向&quot; class=&quot;headerlink&quot; title=&quot;重定向&quot;&gt;&lt;/a&gt;重定向&lt;/h2&gt;&lt;p&gt;重定向（Redirect）用于将用户从一个 URL 重新定位到另一个 URL，常见的重定向方式包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用 meta refresh 标签重定向&lt;/li&gt;
&lt;li&gt;使用 JavaScript &lt;code&gt;document.location&lt;/code&gt; 重定向&lt;/li&gt;
&lt;li&gt;使用 3XX HTTP 状态码重定向（优先推荐），比如 301（Moved Permancently）和 302 （Moved Temporarily）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;重定向的存在具有必要性，比如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;跟踪内部流量，通过分析服务器的重定向数量获取流量流动方向&lt;/li&gt;
&lt;li&gt;跟踪出站流量，搜索引擎可以使用查询字符串 &lt;code&gt;?url=http%3a//pinggod.com&lt;/code&gt; 记录出站流量，通过分析该查询字符串即可计算出与出站目标有关的信息，此外还可以使用信标（beacon）的方式，即监听点击事件，在点击外链时向服务器请求数据，间接驱动服务器记录跳转信息&lt;/li&gt;
&lt;li&gt;美化 URL，便于用户记忆&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Beacon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; handleClick = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;a&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    b = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Image();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    b.src = &lt;span class=&quot;string&quot;&gt;&quot;http://rds.yahoo.com/?url=&quot;&lt;/span&gt; + &lt;span class=&quot;built_in&quot;&gt;escape&lt;/span&gt;(a.href);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;ETag&quot;&gt;&lt;a href=&quot;#ETag&quot; class=&quot;headerlink&quot; title=&quot;ETag&quot;&gt;&lt;/a&gt;ETag&lt;/h2&gt;&lt;p&gt;ETag（Entity Tag，实体标签），是服务器和客户端确认缓存资源有效性的机制。服务器会使用一个字符串来标识某个特定版本的资源，这个字符串就是 ETag 的值。如果浏览器要验证缓存，就会使用 &lt;code&gt;If-Node-Match&lt;/code&gt; 头信息将 ETag 传回服务器，如果在服务器校验成功，则返回 304 状态码。&lt;/p&gt;
&lt;p&gt;ETag 的问题在于，对于不同的服务器来说，相同版本的资源可能具有不同的 ETag 值。此外，根据 HTTP 1.1 的规定，如果请求中同时出现了 If-None-Match 和 If-modified-Since 头信息，则 If-None-Match 具有更高的优先级，除非这两个头信息在服务器和客户端保持完全一致，否则禁止传回 304 响应。&lt;/p&gt;
&lt;h6 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://book.douban.com/subject/3132277/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;高性能网站建设指南&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;How browser works?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/img/browser-fetch-flow-2016-04-07.png&quot; alt=&quot;browser-fetch-flow-2016-04-07.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;《高性能网站建设指南》中文版出版于 2008 年，是雅虎前端团队在性能方面持续研究的成果。虽然书中内容相对当前的技术栈或多或少存在一些陈旧和不适，但仍是了解前端性能优化的不二入门读物。以前上学的时候，上了年纪的老教师最喜欢讲一句话：万变不离其宗。这是一句放诸四海而皆准的教条，诚不欺我。&lt;/p&gt;
&lt;p&gt;前端性能优化，既有宏观方面的考量也有细微之处的锱铢必较。做性能优化的目的不是减少用户下载页面资源的时间，而是减少用户等待页面响应的时间。下面的表格显示了用户对不同延迟时间的心理反馈：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;延迟时间&lt;/th&gt;
&lt;th&gt;心理反馈&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;0~16ms&lt;/td&gt;
&lt;td&gt;屏幕帧速在 60 帧以上，用户感觉不到响应卡顿、跳帧和延迟等现象，用户体验极其优秀&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;0~100ms&lt;/td&gt;
&lt;td&gt;程序反应迅速，体验良好，如果响应超过 100ms，用户将会感受到响应不及时&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;100~300ms&lt;/td&gt;
&lt;td&gt;用户将会感受到轻微的响应延迟&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;300~1000ms&lt;/td&gt;
&lt;td&gt;用户将会感受到渐进式的响应，对于网页来说，加载资源和重绘页面视图都是响应的类型&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;1000+ms&lt;/td&gt;
&lt;td&gt;用户将对当前的操作失去耐心和信心&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;10000+ms&lt;/td&gt;
&lt;td&gt;用户将会放弃当前的操作，或许也将否定该网站&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>洗牌算法</title>
    <link href="http://pinggod.com/2016/%E6%B4%97%E7%89%8C%E7%AE%97%E6%B3%95/"/>
    <id>http://pinggod.com/2016/洗牌算法/</id>
    <published>2016-03-16T05:45:02.000Z</published>
    <updated>2016-04-03T03:34:59.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;翻译自 &lt;a href=&quot;https://www.kirupa.com/html5/shuffling_array_js.htm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Shuffling an Array in JavaScript&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;洗牌算法是一个比较形象的术语，本质上是让一个数组内的元素随机排列。举例来说，我们有一个如下图所示的数组，数组长度为 9，数组内元素的值顺次分别是 1~9：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-1.png&quot; alt=&quot;shffle-array-1&quot;&gt;&lt;/p&gt;
&lt;p&gt;从上面这个数组入手，我们要做的就是打乱数组内元素的顺序：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-2.png&quot; alt=&quot;shffle-array-2&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;代码实现&quot;&gt;&lt;a href=&quot;#代码实现&quot; class=&quot;headerlink&quot; title=&quot;代码实现&quot;&gt;&lt;/a&gt;代码实现&lt;/h2&gt;&lt;p&gt;维基百科上的 &lt;a href=&quot;http://en.wikipedia.org/wiki/Knuth_shuffle&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Fisher–Yates shuffle&lt;/a&gt; 词条对洗牌算法做了详细介绍，下面演示的算法也是基于其中的理论编写的：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.prototype.shuffle = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; input = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = input.length&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;; i &amp;gt;=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) &amp;#123;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = input.length&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;; i &amp;gt;=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; randomIndex = &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.floor(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.random()*(i+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; itemAtIndex = input[randomIndex]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        input[randomIndex] = input[i]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        input[i] = itemAtIndex;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; input;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; tempArray = [ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tempArray.shuffle();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// and the result is...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;alert(tempArray);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在上面的代码中，我们创建了一个 &lt;code&gt;shffle()&lt;/code&gt; 方法，该方法用于随机排列数组内的元素。此外，我们将该方法挂载在了 &lt;code&gt;Array&lt;/code&gt; 对象的原型下面，所以任何数组都可以直接调用该方法：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; tempArray = [ &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tempArray.shuffle();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;工作原理&quot;&gt;&lt;a href=&quot;#工作原理&quot; class=&quot;headerlink&quot; title=&quot;工作原理&quot;&gt;&lt;/a&gt;工作原理&lt;/h2&gt;&lt;p&gt;看完代码之后，让我们看看它对数组都做了写什么。首先，该方法选中数组的最后一个元素：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-3.png&quot; alt=&quot;shffule-array-3&quot;&gt;&lt;/p&gt;
&lt;p&gt;接下来确定挑选随机元素的范围，从数组的第一个元素到上一步选中的元素都属于这一范围：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-4.png&quot; alt=&quot;shffule-array-4&quot;&gt;&lt;/p&gt;
&lt;p&gt;确定范围后，从中随机挑选一个数，这里假设随机选中的元素为 4：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-5.png&quot; alt=&quot;shffule-array-5&quot;&gt;&lt;/p&gt;
&lt;p&gt;然后交换最后一个元素和随机选中的元素的值：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-6.png&quot; alt=&quot;shffule-array-6&quot;&gt;&lt;/p&gt;
&lt;p&gt;上面的交换完成后，相当于我们完成了对数组最后一个元素的随机处理。接下来选中数组内倒数第二的元素：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-7.png&quot; alt=&quot;shffule-array-7&quot;&gt;&lt;/p&gt;
&lt;p&gt;之所以从后往前处理，是因为这样便于确定随机选择的范围。这次我们假定随机到的元素为 2:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-8.png&quot; alt=&quot;shffule-array-8&quot;&gt;&lt;/p&gt;
&lt;p&gt;接着交换倒数第一个元素和 2 号元素的值，完成对倒数第二个元素随机排列的处理。然后是选中倒数第三个元素，重复之前的操作：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-9.png&quot; alt=&quot;shffule-array-9&quot;&gt;&lt;/p&gt;
&lt;p&gt;剩下的就是一些重复性的工作，不多做介绍了。&lt;/p&gt;
&lt;h2 id=&quot;分析代码&quot;&gt;&lt;a href=&quot;#分析代码&quot; class=&quot;headerlink&quot; title=&quot;分析代码&quot;&gt;&lt;/a&gt;分析代码&lt;/h2&gt;&lt;p&gt;在上一节给各位用图例演示了洗牌流程，下面我们从代码本身看看洗牌流程。先从 &lt;code&gt;shuffle&lt;/code&gt; 函数说起吧：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.prototype.shuffle = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; input = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = input.length&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;; i &amp;gt;=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; randomIndex = &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.floor(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.random()*(i+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; itemAtIndex = input[randomIndex]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        input[randomIndex] = input[i]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        input[i] = itemAtIndex;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; input;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;shuffle&lt;/code&gt; 函数挂载在 &lt;code&gt;Array&lt;/code&gt; 对象的原型之下，便于数组直接调用该函数。在 &lt;code&gt;shuffle&lt;/code&gt; 函数内部，&lt;code&gt;this&lt;/code&gt; 引用的就是调用该 &lt;code&gt;shuffle&lt;/code&gt; 的数组：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; input = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在上面的代码中，我用一个新的变量引用 &lt;code&gt;this&lt;/code&gt;，也就是调用 &lt;code&gt;shuffle&lt;/code&gt; 函数的数组。下一步，看一下 &lt;code&gt;for&lt;/code&gt; 循环内都干了什么：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = input.length&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;; i &amp;gt;=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i--) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; randomIndex = &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.floor(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.random()*(i+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; itemAtIndex = input[randomIndex]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    input[randomIndex] = input[i]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    input[i] = itemAtIndex;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;该循环用于遍历所有数组内的所有元素，并进行随机交换。注意，遍历顺序是从后往前进行的，也就是说从 &lt;code&gt;input.length-1&lt;/code&gt; 位置的元素开始，知道遍历到数组中的第一个元素。遍历过程中的位置由变量 &lt;code&gt;i&lt;/code&gt; 指定。&lt;/p&gt;
&lt;p&gt;这里的变量 &lt;code&gt;i&lt;/code&gt; 就是上面图例中被选中的元素：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-3.png&quot; alt=&quot;shffule-array-3&quot;&gt;&lt;/p&gt;
&lt;p&gt;接下来，使用了两行代码在指定范围内挑选一个随机元素：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; randomIndex = &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.floor(&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.random()*(i+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; itemAtIndex = input[randomIndex];&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;变量 &lt;code&gt;randomIndex&lt;/code&gt; 存储了一个随机数，该随机数可以用作数组的索引，进而提取一个随机元素。注意，该随机数的最大值并不是数组的长度，而是变量 &lt;code&gt;i&lt;/code&gt; 的值。&lt;/p&gt;
&lt;p&gt;确定了随机元素的索引之后，用新的变量保存该元素的值，然后交换选中元素和随机元素的值：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; itemAtIndex = input[randomIndex];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;input[randomIndex] = input[i]; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;input[i] = itemAtIndex;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在这三行代码中，第一行使用新的变量保存了随机元素的值；第二行将选中元素 &lt;code&gt;input[i]&lt;/code&gt; 的值赋给随机元素 &lt;code&gt;input[randomIndex]&lt;/code&gt;；第三行就随机元素的值 &lt;code&gt;itemAtIndex&lt;/code&gt; 赋给选中元素 &lt;code&gt;input[i]&lt;/code&gt;。本质上是一个互换两个元素的值的过程，并不难理解。&lt;/p&gt;
&lt;p&gt;至此，循环内的逻辑就介绍完了，剩下的都是重复操作。&lt;/p&gt;
&lt;h2 id=&quot;随机性测试&quot;&gt;&lt;a href=&quot;#随机性测试&quot; class=&quot;headerlink&quot; title=&quot;随机性测试&quot;&gt;&lt;/a&gt;随机性测试&lt;/h2&gt;&lt;p&gt;&lt;div id=&quot;random-chart&quot; style=&quot;width=100%;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;script src=&quot;http://cdn.hcharts.cn/jquery/jquery-2.1.4.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;http://cdn.hcharts.cn/highcharts/highcharts.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
    $(function() {
        var sum = [];
        var array = []
        var arrayLength = 21;
        var iterateTimes = 10000;

        Array.prototype.shuffle = function () {
            var arr = this;

            for (var i = arr.length - 1; i &gt;= 0; i--) {
                var randomIndex = Math.floor(Math.random() * (i + 1));
                var randomElemValue = arr[randomIndex];

                arr[randomIndex] = arr[i];
                arr[i] = randomElemValue;
            }
            return arr;
        }

        function init (len) {
            for (var i = 0; i &lt; len; i++) {
                sum[i] = 0;
                array[i] = i;
            }
        }

        function createArray () {
            var arr = [];

            for (var i = 0; i &lt; arrayLength; i++) {
                arr[i] = i;
            }

            return arr;
        }

        function calculateSum (times) {
            for (var i = 0; i &lt; times; i++) {
                var arr = createArray().shuffle();
                for (var j = 0; j &lt; arrayLength; j++) {
                    sum[j] += arr[j];
                }
            }
        }

        init(arrayLength);
        calculateSum(iterateTimes);

        $(&quot;#random-chart&quot;).highcharts({
            chart: {
                type: &#39;column&#39;
            },
            title: {
                text: &#39;洗牌的随机性结果&#39;
            },
            xAxis: {
                categories: array
            },
            yAxis: {
                title: {
                    text: &#39;总值&#39;
                }
            },
            series: [{
                name: &#39;不同位置的总值&#39;,
                color: &#39;#42b983&#39;,
                data: sum
            }]
        });
    });
&lt;/script&gt;

&lt;p&gt;上图是使用 Highcharts 制作的随机性测试图表，以可视化的方式校验本文中洗牌算法的随机性。每次刷新页面都会重新计算和生成该图表。&lt;/p&gt;
&lt;p&gt;生成上图的数据是这样计算而来的：首先创建一个数组（上图使用的数组为 &lt;code&gt;[0, 1, 2 ... 18, 19, 20]&lt;/code&gt;），然后使用本文中的洗牌算法重新排序，排序完成后记录每一个元素的值……以此步骤执行 10000 次，最后对同一索引位置上的数值进行求和。如此执行 10000 次之后，索引之间的总值应该相差不大。&lt;/p&gt;
&lt;p&gt;由计算可得：&lt;/p&gt;
&lt;p&gt;$$average=\frac{(0+20)\times21\times10000}{2\times21}=100k$$&lt;/p&gt;
&lt;h6 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.kirupa.com/html5/shuffling_array_js.htm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Shuffling an Array in JavaScript&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://bost.ocks.org/mike/shuffle/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Fisher–Yates Shuffle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://news.ycombinator.com/item?id=3464607&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hacker News: A visual explanation of Fisher–Yates shuffle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/962802/is-it-correct-to-use-javascript-array-sort-method-for-shuffling/962890#962890&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Stack Overflow: Is it correct to use JavaScript Array.sort() method for shuffling?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;翻译自 &lt;a href=&quot;https://www.kirupa.com/html5/shuffling_array_js.htm&quot;&gt;Shuffling an Array in JavaScript&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;洗牌算法是一个比较形象的术语，本质上是让一个数组内的元素随机排列。举例来说，我们有一个如下图所示的数组，数组长度为 9，数组内元素的值顺次分别是 1~9：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-1.png&quot; alt=&quot;shffle-array-1&quot;&gt;&lt;/p&gt;
&lt;p&gt;从上面这个数组入手，我们要做的就是打乱数组内元素的顺序：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/shuffle-array-2.png&quot; alt=&quot;shffle-array-2&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>JavaScript 常见问题和解决方式</title>
    <link href="http://pinggod.com/2016/JavaScript%20%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E5%BC%8F/"/>
    <id>http://pinggod.com/2016/JavaScript 常见问题和解决方式/</id>
    <published>2016-03-12T12:22:26.000Z</published>
    <updated>2016-04-01T10:03:24.000Z</updated>
    
    <content type="html">&lt;p&gt;JavaScript 因其历史原因一直存在诸多缺陷，本文所讨论的只是其中的一小部分，适合为初学者答疑解惑，此外文中观点尚存在不足之处，或者对部分问题 ES6 已经提出了新的解决方案。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;类型判断&quot;&gt;&lt;a href=&quot;#类型判断&quot; class=&quot;headerlink&quot; title=&quot;类型判断&quot;&gt;&lt;/a&gt;类型判断&lt;/h2&gt;&lt;p&gt;使用 typeof 运算符判断一个原始值变量的类型是没有问题的，但如果判断的是引用值类型就会有局限性，比如 &lt;code&gt;null&lt;/code&gt; 和数组的结果都是 &lt;code&gt;object&lt;/code&gt;。要想判断变量属于哪种内置类型，最靠谱的方式是调用 &lt;code&gt;Object.prototype.toString&lt;/code&gt; 方法：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.prototype.toString.call([])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &quot;[object Array]&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在 JavaScript 规范（ECMA-262 19.1.3.6）中详细解释了 &lt;code&gt;Object.prototype.toString&lt;/code&gt; 的解析过程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果 &lt;code&gt;this&lt;/code&gt; 的值为 &lt;code&gt;undefined&lt;/code&gt;，则返回字符串 &lt;code&gt;&amp;quot;[object Undefined]&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;this&lt;/code&gt; 的值为 &lt;code&gt;null&lt;/code&gt;，则返回字符串 &lt;code&gt;&amp;quot;[object Null]&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;使用 &lt;code&gt;O&lt;/code&gt; 表示 &lt;code&gt;ToObject(this)&lt;/code&gt; 的值&lt;/li&gt;
&lt;li&gt;使用 &lt;code&gt;isArray&lt;/code&gt; 表示 &lt;code&gt;IsArray(O)&lt;/code&gt; 的值&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;isArray&lt;/code&gt; 不是正常值（比如抛出错误），则中断执行&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;isArray === true&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;Array&amp;quot;&lt;/code&gt;，之后执行第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 是一个 exotic 字符串对象，则 &lt;code&gt;builtinTag = &amp;quot;String&amp;quot;&lt;/code&gt;，之后执行第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 拥有内部属性 &lt;code&gt;[[ParameterMap]]&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;Arguments&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 拥有内部方法 &lt;code&gt;[[Call]]&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;Function&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 拥有内部属性 &lt;code&gt;[[ErrorData]]&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;Error&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 拥有内部属性 &lt;code&gt;[[BooleanData]]&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;Boolean&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 拥有内部属性 &lt;code&gt;[[NumberData]]&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;Number&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 拥有内部属性 &lt;code&gt;[[DateValue]]&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;Date&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;O&lt;/code&gt; 拥有内部属性 &lt;code&gt;[[RegExpMather]]&lt;/code&gt;，则 &lt;code&gt;builtinTag = &amp;quot;RegExp&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;如果第 6 ~ 14 步都不符合，则 &lt;code&gt;builtinTag = &amp;quot;Object&amp;quot;&lt;/code&gt;，跳到第 16 步&lt;/li&gt;
&lt;li&gt;使用 &lt;code&gt;tag&lt;/code&gt; 表示 &lt;code&gt;Get (O, @@toStringTag)&lt;/code&gt; 的值&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;tag&lt;/code&gt; 不是正常值，则中断执行&lt;/li&gt;
&lt;li&gt;如果 &lt;code&gt;Type(tag)&lt;/code&gt; 不是一个字符串，则 &lt;code&gt;tag = builtinTag&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;返回一个 &lt;code&gt;&amp;quot;[object&amp;quot; + tag + &amp;quot;]&amp;quot;&lt;/code&gt; 形式的字符串&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;开发者喜欢使用该方法获取内部属性 &lt;code&gt;[[Class]]&lt;/code&gt; 的字符串值，用于检测内建对象的类型。值得注意的是，这一方法只对内建对象有效，对宿主对象等其他类型的对象则不具有可信度。&lt;br&gt;&lt;/div&gt;

&lt;h2 id=&quot;局部变量泄漏到全局&quot;&gt;&lt;a href=&quot;#局部变量泄漏到全局&quot; class=&quot;headerlink&quot; title=&quot;局部变量泄漏到全局&quot;&gt;&lt;/a&gt;局部变量泄漏到全局&lt;/h2&gt;&lt;p&gt;有如下所示的代码，猜测一下输出结果：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = b = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(b);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;很多时候不经意间，某些变量就会泄漏为全局变量，比如这里的变量 b。上述代码等同于：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    b = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = b;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ES6 支持块级作用域，使用时需要遵循两个条件：一是添加 &lt;code&gt;&amp;quot;use strict;&amp;quot;&lt;/code&gt; 字符串，声明严格模式；而是使用 &lt;code&gt;let&lt;/code&gt; 和 &lt;code&gt;const&lt;/code&gt; 声明变量。如果不能使用 ES6 的块级作用域，那么声明变量时要做到使用单独一行声明单个变量，比如：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; b = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = b;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;立即执行函数&quot;&gt;&lt;a href=&quot;#立即执行函数&quot; class=&quot;headerlink&quot; title=&quot;立即执行函数&quot;&gt;&lt;/a&gt;立即执行函数&lt;/h2&gt;&lt;p&gt;使用立即执行函数的好处是模块化和块级作用域。目前 ES6 对这两个方面都有相应的支持，所以除非为了保持兼容性，ES6 会是更好的开发方式。&lt;/p&gt;
&lt;p&gt;在浏览器环境中，立即调用函数中的 &lt;code&gt;this&lt;/code&gt; 指向全局变量 &lt;code&gt;window&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt; === &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;严格模式&quot;&gt;&lt;a href=&quot;#严格模式&quot; class=&quot;headerlink&quot; title=&quot;严格模式&quot;&gt;&lt;/a&gt;严格模式&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;使用 &lt;code&gt;&amp;#39;use strict;&amp;#39;&lt;/code&gt; 声明严格模式&lt;/li&gt;
&lt;li&gt;全局变量必须显示声明&lt;/li&gt;
&lt;li&gt;禁止使用 with 语句，限制动态绑定&lt;/li&gt;
&lt;li&gt;&lt;code&gt;eval()&lt;/code&gt; 的作用域为独立作用域，独立于全局作用域和函数作用域之外，生成的变量只能用于 eval 内部&lt;/li&gt;
&lt;li&gt;禁止 &lt;code&gt;this&lt;/code&gt; 关键字指向全局对象&lt;/li&gt;
&lt;li&gt;禁止使用 &lt;code&gt;delete&lt;/code&gt; 删除变量，只有 &lt;code&gt;configurable === true&lt;/code&gt; 的属性可以被删除&lt;/li&gt;
&lt;li&gt;对可读属性赋值、对禁止扩展的对象添加属性、删除不可删除属性都会报错&lt;/li&gt;
&lt;li&gt;禁止在对象中添加重名属性&lt;/li&gt;
&lt;li&gt;不允许对 arguments 赋值&lt;/li&gt;
&lt;li&gt;禁止使用 arguments.callee&lt;/li&gt;
&lt;li&gt;必须在顶层作用域声明函数&lt;/li&gt;
&lt;li&gt;新增保留字&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;浮点数的精度问题&quot;&gt;&lt;a href=&quot;#浮点数的精度问题&quot; class=&quot;headerlink&quot; title=&quot;浮点数的精度问题&quot;&gt;&lt;/a&gt;浮点数的精度问题&lt;/h2&gt;&lt;p&gt;对于使用 IEEE 754 存储双精度 64 位浮点数的语言都会遇到这个问题，且最简单的复现方式就是计算 &lt;code&gt;0.1 + 0.2&lt;/code&gt;。这一表达式的值不等于 &lt;code&gt;0.3&lt;/code&gt;，其原因就是 IEEE 754 不能正确表示 0.1。IEEE 754 规定的浮点数由一位符号位 &lt;code&gt;s&lt;/code&gt;、五十二位小数位 &lt;code&gt;m&lt;/code&gt; 和十一位指数位组成 &lt;code&gt;e&lt;/code&gt;：&lt;/p&gt;
&lt;p&gt;$$s \times m \times 2^e$$&lt;/p&gt;
&lt;p&gt;JavaScript 规定 e 的范围为 &lt;code&gt;[-1074, 971]&lt;/code&gt;，则 &lt;code&gt;Number.MAX_VALUE&lt;/code&gt; 的值为：&lt;/p&gt;
&lt;p&gt;$$ 1 \times ( 2^{53} - 1) \times 2^{971} $$&lt;/p&gt;
&lt;p&gt;了解以上基础知识后求取 &lt;code&gt;0.1&lt;/code&gt; 和 &lt;code&gt;0.2&lt;/code&gt; 的二进制表示：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt;).toString(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &quot;0.0001100110011001100110011001100110011001100110011001101&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt;).toString(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &quot;0.001100110011001100110011001100110011001100110011001101&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt;).toString(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &quot;0.0100110011001100110011001100110011001100110011001101&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;关于这一问题的详细解析和其他问题，建议参考文章：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/zichi/p/5034201.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.cnblogs.com/zichi/p/5034201.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/zichi/p/5043540.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.cnblogs.com/zichi/p/5043540.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;setTimeout&quot;&gt;&lt;a href=&quot;#setTimeout&quot; class=&quot;headerlink&quot; title=&quot;setTimeout&quot;&gt;&lt;/a&gt;setTimeout&lt;/h2&gt;&lt;p&gt;JavaScript 是单线程语言，异步事件的优先级低于其他代码，&lt;code&gt;setTimeout(callback, 0)&lt;/code&gt; 表示加入事件队列以异步的方式执行，且在事件队列中优先执行：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&amp;#125;, &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&amp;#125;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Object-key&quot;&gt;&lt;a href=&quot;#Object-key&quot; class=&quot;headerlink&quot; title=&quot;Object key&quot;&gt;&lt;/a&gt;Object key&lt;/h2&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a=&amp;#123;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    b=&amp;#123;key:&lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    c=&amp;#123;key:&lt;span class=&quot;string&quot;&gt;&#39;c&#39;&lt;/span&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a[b]=&lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a[c]=&lt;span class=&quot;number&quot;&gt;456&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a[b]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 456&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面的代码有一个特点，就是没有使用字符串或 Symbol 作为对象的属性名，所以系统会将其转换为字符串，相当于：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;a[&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.prototype.toString.call(b)]=&lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a[&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.prototype.toString.call(c)]=&lt;span class=&quot;number&quot;&gt;456&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// equal to&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a[&lt;span class=&quot;string&quot;&gt;&quot;[object Object]&quot;&lt;/span&gt;]=&lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a[&lt;span class=&quot;string&quot;&gt;&quot;[object Object]&quot;&lt;/span&gt;]=&lt;span class=&quot;number&quot;&gt;456&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;eval-作用域&quot;&gt;&lt;a href=&quot;#eval-作用域&quot; class=&quot;headerlink&quot; title=&quot;eval 作用域&quot;&gt;&lt;/a&gt;eval 作用域&lt;/h2&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; y = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;f&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&amp;#125;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    y += &lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; f;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &quot;1undefined&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在上面的代码中，最奇怪的有点在于 &lt;code&gt;typeof f === &amp;quot;undefined&amp;quot;&lt;/code&gt;。之所以有这样的结果，是因为 if 条件语句是使用 &lt;code&gt;eval()&lt;/code&gt; 解析的。由于 &lt;code&gt;eval(function f(){})&lt;/code&gt; 只会返回值而不会向全局作用域暴漏变量 &lt;code&gt;f&lt;/code&gt;，所以执行 &lt;code&gt;typeof f&lt;/code&gt; 时并没有找到函数 &lt;code&gt;f&lt;/code&gt;，则值为 undefined。&lt;/p&gt;
&lt;h2 id=&quot;私有方法&quot;&gt;&lt;a href=&quot;#私有方法&quot; class=&quot;headerlink&quot; title=&quot;私有方法&quot;&gt;&lt;/a&gt;私有方法&lt;/h2&gt;&lt;p&gt;在 JavaScript 中模拟私有方法的缺点就是内存占用高：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Employee = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;name, company, salary&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.name = name || &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;;       &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.company = company || &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.salary = salary || &lt;span class=&quot;number&quot;&gt;5000&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// Private method&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; increaseSalary = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.salary = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.salary + &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// Public method&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.dispalyIncreasedSalary = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        increaseSlary();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.salary);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; emp1 = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Employee(&lt;span class=&quot;string&quot;&gt;&quot;John&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;Pluto&quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; emp2 = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Employee(&lt;span class=&quot;string&quot;&gt;&quot;Merry&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;Pluto&quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; emp3 = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Employee(&lt;span class=&quot;string&quot;&gt;&quot;Ren&quot;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&quot;Pluto&quot;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2500&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对于 &lt;code&gt;Employee&lt;/code&gt; 的每一个实例 emp1 / emp2 / emp3，它们都拥有各自的一个 &lt;code&gt;increaseSalary&lt;/code&gt; 方法，所以除非确有必要，尽量不要使用私有方法。&lt;/p&gt;
&lt;h2 id=&quot;delete-操作符&quot;&gt;&lt;a href=&quot;#delete-操作符&quot; class=&quot;headerlink&quot; title=&quot;delete 操作符&quot;&gt;&lt;/a&gt;delete 操作符&lt;/h2&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; output = (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;x&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(output);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;delete&lt;/code&gt; 操作符用于删除对象的属性，对于其他变量无效。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Employee = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  company: &lt;span class=&quot;string&quot;&gt;&#39;xyz&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; emp1 = &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.create(Employee);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;delete&lt;/span&gt; emp1.company;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(emp1.company);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &quot;xyz&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在上面的代码中，emp1 通过原形链继承了 &lt;code&gt;Employee&lt;/code&gt; 的属性 &lt;code&gt;company&lt;/code&gt;，emp1 本身并没有 &lt;code&gt;company&lt;/code&gt; 属性，即 &lt;code&gt;emp1.company === emp1.__proto__.company&lt;/code&gt;，所以 &lt;code&gt;delete&lt;/code&gt; 操作是无效的。&lt;/p&gt;
&lt;h2 id=&quot;延迟定义&quot;&gt;&lt;a href=&quot;#延迟定义&quot; class=&quot;headerlink&quot; title=&quot;延迟定义&quot;&gt;&lt;/a&gt;延迟定义&lt;/h2&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 第一种声明方式&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; foo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// Some code&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 第二种声明方式&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bar&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// Some code&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这两种声明方式的差异在于，&lt;code&gt;foo()&lt;/code&gt; 在运行时定义，而 &lt;code&gt;bar()&lt;/code&gt; 在解析时定义。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;foo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 执行 foo() 时，foo 的值为 undefined&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; foo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;Hi I am inside Foo&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bar();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 执行 bar() 时，由于 bar() 已经被 JavaScript 引擎解析过了，所以不会报错&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;bar&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;Hi I am inside Foo&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;根据这一特点，我们可以根据需要延迟定义某些功能：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(testCondition) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; foo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;inside Foo with testCondition True value&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; foo = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;inside Foo with testCondition false value&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在上面的代码中，布尔值 &lt;code&gt;testCondition&lt;/code&gt; 决定了是定义何种功能的 &lt;code&gt;foo()&lt;/code&gt; 函数，在定义之前，&lt;code&gt;foo&lt;/code&gt; 只是一个原始值 &lt;code&gt;undefined&lt;/code&gt;，并没有引用具体的函数。&lt;/p&gt;
&lt;h6 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.toptal.com/javascript/interview-questions&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;25 Essential JavaScript Interview Questions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.codementor.io/javascript/tutorial/21-essential-javascript-tech-interview-practice-questions-answers&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;21 Essential JavaScript Tech Interview Practive Questions answers&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;JavaScript 因其历史原因一直存在诸多缺陷，本文所讨论的只是其中的一小部分，适合为初学者答疑解惑，此外文中观点尚存在不足之处，或者对部分问题 ES6 已经提出了新的解决方案。&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>2016 JavaScript 技术栈展望</title>
    <link href="http://pinggod.com/2016/2016-JavaScript-%E6%8A%80%E6%9C%AF%E6%A0%88%E5%B1%95%E6%9C%9B/"/>
    <id>http://pinggod.com/2016/2016-JavaScript-技术栈展望/</id>
    <published>2016-03-11T03:45:31.000Z</published>
    <updated>2016-04-11T02:46:56.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;翻译自 &lt;a href=&quot;https://medium.com/javascript-and-opinions/state-of-the-art-javascript-in-2016-ab67fc68eb0b#.iwbk5gf69&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;State of the Art JavaScript in 2016&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果你正在筹划新的前端项目或者重构现有项目，那么你需要认识到现在的前端开发环境已经今非昔比，这其中有太多的选择了：React、Flux、Angular、Aurelia、Mocha、Jasmine、Babel、TypeScript、Flow…… 它们的本意是将开发简单化，却无形中提高了学习成本，也给未来项目的维护带来了不确定性。&lt;/p&gt;
&lt;p&gt;好在这一现象正在退热，优胜劣汰，优秀的项目慢慢沉淀下来，开发方式也越来越清晰。有些开发者正在尝试使用基于上述技术的框架进行开发，也在一定程度上减少了学习成本。&lt;/p&gt;
&lt;p&gt;本文中主要介绍了一些我在 web 应用开发中所涉及和推崇的技术，其中有一些技术上存在争议，所以我对于每一技术都只做简单的介绍和分析。所有的这些观点都是基于我个人的经验和对社区的接触总结而来的，所以各位还请按需各取所用。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;React&quot;&gt;&lt;a href=&quot;#React&quot; class=&quot;headerlink&quot; title=&quot;React&quot;&gt;&lt;/a&gt;React&lt;/h2&gt;&lt;p&gt;React 可谓风头正盛一时无两：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;组件化使应用程序更易于开发和维护&lt;/li&gt;
&lt;li&gt;学习曲线平缓，核心 API 简洁清晰，易于学习&lt;/li&gt;
&lt;li&gt;JSX 语法不落俗套，充分发挥了 JavaScript 的能量&lt;/li&gt;
&lt;li&gt;天生适配 Flux 和 Redux&lt;/li&gt;
&lt;li&gt;社区活跃且具有创造力，奉献了诸多优秀的开发工具&lt;/li&gt;
&lt;li&gt;单向数据流比双向数据绑定的方式更适合复杂应用程序，质量更高&lt;/li&gt;
&lt;li&gt;支持服务端渲染&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;虽然比起 Ember、Aurelia 和 Angular 这些功能丰富的框架，React 不是全能手，但 React 的开发环境更加健壮。就目前而言，使用 React 已经不是一个技术选择，而是一个商业行为，它能提供更高效和更有效的生产力。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;当你想开发移动应用时，因为已经学习了 React 语法，所以可以直接上手 React Native 开发跨平台应用。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Redux&quot;&gt;&lt;a href=&quot;#Redux&quot; class=&quot;headerlink&quot; title=&quot;Redux&quot;&gt;&lt;/a&gt;Redux&lt;/h2&gt;&lt;p&gt;现在，我们已经具有了开发视图层的能力，接下来，我们需要使用其他工具管理应用程序中的状态和生命周期，在这里推荐的工具就是：Redux。&lt;/p&gt;
&lt;p&gt;为了配合 React，Facebook 开发了管理单向数据流的工具 Flux，虽然 Flux 基本上实现了对单项数据流的支持，但是同时也带了其他问题，比如如何保存状态、何处发起 Ajax 请求等等。&lt;/p&gt;
&lt;p&gt;为了解决这些问题，又衍生了一系列效仿 Flux 模式的框架：Fluxible、Reflux、Alt、Flummox、Lux、Nuclear、Fluxxor……&lt;/p&gt;
&lt;p&gt;目前来说被开发社区广泛支持的一个实现就是 Redux。&lt;/p&gt;
&lt;p&gt;在 Redux 中，大多数的组件都是纯函数式的组件，也只有一个集中的存储和资源中心。Redux 的实例方法负责整个数据的操作和维护。相比 Flux 来说，Redux 的思路更加清晰。&lt;/p&gt;
&lt;p&gt;更重要的是，Redux 非常易于学习。Redux 的作者 Dan Abramov 是一个优秀的教师，他制作了一系列深入浅出的 Redux 视频教程。通过观看这些视频，即可成为一个 Redux 方面的专家。我曾经见识到一个零基础的 React 团队在短短几周内迅速开发出了测试版产品，且代码非常稳健和老练。&lt;/p&gt;
&lt;p&gt;Redux 周边的生态系统和 Redux 本身一样健壮。从神奇的 &lt;a href=&quot;https://github.com/gaearon/redux-devtools&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;devtool&lt;/a&gt; 到强大的记忆化工具 &lt;a href=&quot;https://github.com/reactjs/reselect&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;reselect&lt;/a&gt;，Redux 开发社区为开发者提供了应有尽有的工具。&lt;/p&gt;
&lt;p&gt;开发者可能会本能地去尝试抽象出一个 Redux 模板，这么做有诸多好处，但请在认清需求的基础上来封装模板，而不要盲目的去尝试。&lt;/p&gt;
&lt;h2 id=&quot;ES6-和-Babel&quot;&gt;&lt;a href=&quot;#ES6-和-Babel&quot; class=&quot;headerlink&quot; title=&quot;ES6 和 Babel&quot;&gt;&lt;/a&gt;ES6 和 Babel&lt;/h2&gt;&lt;p&gt;是时候抛弃 CoffeeScript 了，这是因为它的诸多特性已在 ES6 中出现类似的语法，而 ES6 是实施标准，代表了 JavaScript 未来的发展方向。&lt;/p&gt;
&lt;p&gt;目前最新的浏览器已经支持了 ES6 的大部分特性。Babel 是一个强大的转换工具，用于将 ES6 转换为 ES5。此外，根据目标浏览器可以调整代码转换的程度。&lt;/p&gt;
&lt;p&gt;那么是否有类型系统呢？TypeScript 和 Flow 都为 JavaScript 提供了静态类型系统，使用静态类型检查，可以有效捕获错误，减少测试量。目前来说，我建议对此持观望态度。&lt;/p&gt;
&lt;p&gt;TypeScript 在尽力让 JavaScript 向 C# 或 Java 的方向发展，但缺少了许多高级的类型系统特性，比如代数数据类型（algebraic data types）。此外，它不能像 Flow 一样有效地处理 null。&lt;/p&gt;
&lt;p&gt;相比而言，Flow 更加强大，捕获的错误类型也更多，但难于配置。此外，它对 JavaScript 新特性的支持弱于 Babel，也不支持 Windows 系统。&lt;/p&gt;
&lt;p&gt;就我个人的角度而言，在前端开发中类型系统并不是至关重要的一环（此处可能有争议）。在类型系统更加健壮且对 Babel 更友好之前，还是让我们静观其变吧。&lt;/p&gt;
&lt;h2 id=&quot;ESLint&quot;&gt;&lt;a href=&quot;#ESLint&quot; class=&quot;headerlink&quot; title=&quot;ESLint&quot;&gt;&lt;/a&gt;ESLint&lt;/h2&gt;&lt;p&gt;另一个无可争议的工具是 ESLint。ESLint 支持 ES6 语法，还提供了 React 插件，已经不单单是一个代码审查工具了。目前来说，JSLint 已经过时了，ESLint 可以替代 JSHint 和 JSCS 独树一帜了。&lt;/p&gt;
&lt;p&gt;开发者可以根据自己的需求配置 ESLint，不过在这里我建议根据 &lt;a href=&quot;https://github.com/airbnb/javascript&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;AirBNB 的开发规范&lt;/a&gt;进行配置，也可以直接使用 &lt;a href=&quot;https://www.npmjs.com/package/eslint-config-airbnb&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ESLint airbnb config&lt;/a&gt;。当然这份规范中尚有不足之处，但保持团队整体代码的一致性，可以有效提高代码的可读性。&lt;/p&gt;
&lt;p&gt;当你熟悉了 ESLint 之后，建议开发者深入地尝试其中的规则。ESLint 捕获的错误越多，产品的稳定性越高。&lt;/p&gt;
&lt;h2 id=&quot;NPM，CommonJS-和-ES6-modules&quot;&gt;&lt;a href=&quot;#NPM，CommonJS-和-ES6-modules&quot; class=&quot;headerlink&quot; title=&quot;NPM，CommonJS 和 ES6 modules&quot;&gt;&lt;/a&gt;NPM，CommonJS 和 ES6 modules&lt;/h2&gt;&lt;p&gt;忘记 Bower 吧，用 NPM 接管一切。类似 Browserify 和 Webpack 的构建工具间接提高了 NPM 在 web 开发中的地位。使用 NPM，版本管理将会更加简单，也将更多地与 Node.js 生态系统接触。目前对于 CSS 的处理尚不足够完善。&lt;/p&gt;
&lt;p&gt;你可能会考虑如何在部署服务器上执行构建呢？与 Ruby 的 Bundler 有所不同，NPM 使用了通配符检索文件，且第三方包可以在代码开发中以及项目发布前做任意修改。使用 &lt;a href=&quot;https://docs.npmjs.com/cli/shrinkwrap&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;shrinkwrap&lt;/a&gt; 文件可以冻结项目中的第三方依赖，我建议使用 User 的 shrinkwrap，提高输出的一致性。此外，开发者也可以考虑使用类似 &lt;a href=&quot;https://www.npmjs.com/package/sinopia&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sinopia&lt;/a&gt; 的工具托管自己的私有 NPM 服务器。&lt;/p&gt;
&lt;p&gt;Babel 会将 ES6 module 语法转换为 CommonJS。CommonJS 是一种历经实践的语法，这意味着稳定和通用，此外，使用类似 &lt;a href=&quot;http://www.2ality.com/2015/12/webpack-tree-shaking.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;tree shaking&lt;/a&gt; （Webpack 2.0 和 Rollup 已经支持该特性）的机制我们还能实现静态代码分析。&lt;/p&gt;
&lt;h2 id=&quot;Webpack&quot;&gt;&lt;a href=&quot;#Webpack&quot; class=&quot;headerlink&quot; title=&quot;Webpack&quot;&gt;&lt;/a&gt;Webpack&lt;/h2&gt;&lt;p&gt;除非你乐意在页面添加数百个脚本标签，否则的话你应该尝试用构建工具来打包页面的资源了。此外，你还需要某些工具让浏览器支持 NPM 第三方包。在这里，我推荐你使用 Webpack。&lt;/p&gt;
&lt;p&gt;一年之前对于上述工作，开发者还有诸多工具可以选择，比如基于 JavaScript 的 RequireJS、Browserify 和 Webpack 解决方案，此外还有号称能对 ES6 的模块进行最佳优化的 RollupJS.&lt;/p&gt;
&lt;p&gt;在尝试了所有的工具之后，我强烈建议开发者选择 Webpack:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;通过配置可以应对各种情况&lt;/li&gt;
&lt;li&gt;支持主流的模块加载方式（AMD，CommonJS，globals）&lt;/li&gt;
&lt;li&gt;内部机制可以修复破损的模块&lt;/li&gt;
&lt;li&gt;可以处理 CSS&lt;/li&gt;
&lt;li&gt;全面的缓存系统&lt;/li&gt;
&lt;li&gt;支持热重载&lt;/li&gt;
&lt;li&gt;可以加载大多数的资源&lt;/li&gt;
&lt;li&gt;提供高效的&lt;a href=&quot;https://github.com/webpack/docs/wiki/optimization&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;性能优化方案&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Webpack 也非常善于处理大型的单页应用，支持代码分割和惰性加载。&lt;/p&gt;
&lt;p&gt;但是值得注意的是，Webpack 的学习曲线异常陡峭。不过一旦你学会了它，那么你就掌握了最强大的构建系统。&lt;/p&gt;
&lt;p&gt;那么 Gulp 和 Grunt 呢？相比而言，Webpack 更善于处理各类资源。如果你需要执行其他类型的构建任务，那么 Gulp 和 Grunt 还是有用的。对于类似运行 Webpack 的基本任务，我建议直接使用 &lt;a href=&quot;https://docs.npmjs.com/cli/run-script&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;NPM 脚本&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&quot;Mocha-Chai-Sinon&quot;&gt;&lt;a href=&quot;#Mocha-Chai-Sinon&quot; class=&quot;headerlink&quot; title=&quot;Mocha + Chai + Sinon&quot;&gt;&lt;/a&gt;Mocha + Chai + Sinon&lt;/h2&gt;&lt;p&gt;在 JavaScript 中，有大量可选的单元测试工具，每一个都很稳定和健壮。如果你只是用于单元测试，那么现有工具完全可以胜任你的需求。&lt;/p&gt;
&lt;p&gt;常见的测试工具有 Jasmine、Mocha、Tape、Ava、Jest 等，它们各有所长。&lt;/p&gt;
&lt;p&gt;我对一个测试框架的要求有如下几条：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;可以在浏览器运行，便于调试&lt;/li&gt;
&lt;li&gt;执行速度快&lt;/li&gt;
&lt;li&gt;便于处理异步测试&lt;/li&gt;
&lt;li&gt;便于在命令行中使用&lt;/li&gt;
&lt;li&gt;可以兼容任意断言和数据模拟的第三方库&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;第一条标准就排除了 Ava 和 Jest。&lt;/p&gt;
&lt;p&gt;我喜欢 Chai 断言是因为其种类丰富、功能齐全的插件，喜欢 Mocha 是因为其对异步的良好支持。强烈建议使用 &lt;a href=&quot;https://github.com/prodatakey/dirty-chai&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Dirty Chai&lt;/a&gt; 避免某些问题。Webpack 的 &lt;a href=&quot;https://github.com/webpack/mocha-loader&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;mocha-leader&lt;/a&gt; 插件允许开发者自动执行测试。&lt;/p&gt;
&lt;p&gt;对于 React 而言，开发者可以参考一下 AirBNB 的 &lt;a href=&quot;https://github.com/airbnb/enzyme&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Enzyme&lt;/a&gt; 和 &lt;a href=&quot;https://github.com/jquense/teaspoon&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Teaspoon&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;我非常钟爱 Mocha 的特性，如果你想要的只是最基础的功能，可以参考&lt;a href=&quot;https://medium.com/javascript-scene/why-i-use-tape-instead-of-mocha-so-should-you-6aa105d8eaf4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;这篇文章&lt;/a&gt;了解一下 Tape。&lt;/p&gt;
&lt;h2 id=&quot;Lodash&quot;&gt;&lt;a href=&quot;#Lodash&quot; class=&quot;headerlink&quot; title=&quot;Lodash&quot;&gt;&lt;/a&gt;Lodash&lt;/h2&gt;&lt;p&gt;JavaScript 并没有一个类似 Java 或 .NET 的核心工具库，所以开发者大都会从外部引用一个外部工具库。&lt;/p&gt;
&lt;p&gt;目前来说，Lodash 是此类工具中的佼佼者。此外，由于它&lt;a href=&quot;http://filimanjaro.com/blog/2014/introducing-lazy-evaluation/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;惰性执行&lt;/a&gt;的特性，也让它是目前性能最佳的工具之一。使用 Lodash 时无需引用全部资源，开发者可以按需使用其中的函数。在 4.x 版本中，Lodash 为偏爱函数式编程的开发者提供了一个“函数式开发”模式。&lt;/p&gt;
&lt;p&gt;如果你熟悉函数式编程，你可以了解一下 &lt;a href=&quot;http://ramdajs.com/0.19.1/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ramda&lt;/a&gt;。如果你决定使用这个库，可能需要引用一些 Lodash 函数。&lt;/p&gt;
&lt;h2 id=&quot;fetch&quot;&gt;&lt;a href=&quot;#fetch&quot; class=&quot;headerlink&quot; title=&quot;fetch&quot;&gt;&lt;/a&gt;fetch&lt;/h2&gt;&lt;p&gt;许多基于 React 的应用程序都不再使用 jQuery 了。除非你正在维护一个陈旧的项目或者用到的第三方库依赖了 jQuery，否则已经没有必要使用它了。&lt;/p&gt;
&lt;p&gt;我喜欢让项目保持简洁，在代码中只使用 &lt;a href=&quot;http://ramdajs.com/0.19.1/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;fetch&lt;/a&gt; 。fetch 基于 promise，Firefox 和 Chrome 都封装了该接口。对于其他浏览器，则需要提供一个腻子脚本。我建议使用 &lt;a href=&quot;https://github.com/matthew-andrews/isomorphic-fetch&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;isomorphic-fetch&lt;/a&gt; 在各个浏览器和服务端保持功能的一致性。&lt;/p&gt;
&lt;p&gt;当然也可以其他优秀的第三方库异步获取数据，但我觉得 fetch 已经够用了。&lt;/p&gt;
&lt;h2 id=&quot;同构-JavaScript&quot;&gt;&lt;a href=&quot;#同构-JavaScript&quot; class=&quot;headerlink&quot; title=&quot;同构 JavaScript&quot;&gt;&lt;/a&gt;同构 JavaScript&lt;/h2&gt;&lt;p&gt;同构 JavaScript 是指同时运行在客户端和服务端的 JavaScript，常用于在服务端预先渲染页面，提高性能，便于 SEO。使用 React 可以实现同构 JavaScript，但是并不简单，它提高了程序的复杂度，限制了开发者可选的工具和第三方库。&lt;/p&gt;
&lt;p&gt;如果你正在构建一个 B2C 的站点，比如电商网站，那么你可能就需要使用同构 JavaScript。不过，对于内部站点或者 B2B 程序，性能就不是最重要的了，则同构 JavaScript 也就不是太重要了。&lt;/p&gt;
&lt;h2 id=&quot;API&quot;&gt;&lt;a href=&quot;#API&quot; class=&quot;headerlink&quot; title=&quot;API&quot;&gt;&lt;/a&gt;API&lt;/h2&gt;&lt;p&gt;最近每个人好像都在思考如何处理 API。每个人都在随波逐流的使用 &lt;a href=&quot;https://en.wikipedia.org/wiki/Representational_state_transfer&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;RESTfull API&lt;/a&gt;，&lt;a href=&quot;https://en.wikipedia.org/wiki/SOAP&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;SOAP&lt;/a&gt; 已经成为了过去时。目前业界存在各种 API 协议，比如 HATEOAS、JSON API、HAL、GraphQL 等。&lt;/p&gt;
&lt;p&gt;GraphQL 赋予了客户端进行任意查询的能力。搭配 &lt;a href=&quot;https://facebook.github.io/relay/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Relay&lt;/a&gt;，可以更好地处理客户端的状态和缓存。不过，创建 GraphQL 的服务端接口的难度还较大，且大多数的文档都是面向 Node.js 的。&lt;/p&gt;
&lt;p&gt;Netflix 的 &lt;a href=&quot;https://github.com/Netflix/falcor&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Falcor&lt;/a&gt; 看起来提供了和 GraphQL/Relay 相似的能力，同时还降低了服务端的需求，但它目前尚处于开发者预览状态，尚未应用于实际开发。&lt;/p&gt;
&lt;p&gt;所有已知的规范都各有缺陷，有些过于复杂，有些只能处理数据读取而不嗯那个更新，有些和 REST 差异显著。许多开发者选择自己开发，但是还会遇到上述的问题。&lt;/p&gt;
&lt;p&gt;我不认为上述有一个完美的解决方案，但我对 API 有一个自己的认知：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;可预测，遵循一致性协议&lt;/li&gt;
&lt;li&gt;支持在一次查询中获取多个实体&lt;/li&gt;
&lt;li&gt;支持更新操作&lt;/li&gt;
&lt;li&gt;易于调试&lt;/li&gt;
&lt;li&gt;易于使用&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;到目前为止，我还没有发现满足上述所有条件的解决方案。&lt;/p&gt;
&lt;p&gt;如果你正在使用 RESTful，建议参考 &lt;a href=&quot;http://swagger.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Swagger&lt;/a&gt; 来编写 API。&lt;/p&gt;
&lt;h2 id=&quot;Electron&quot;&gt;&lt;a href=&quot;#Electron&quot; class=&quot;headerlink&quot; title=&quot;Electron&quot;&gt;&lt;/a&gt;Electron&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/atom/electron&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Electron&lt;/a&gt; 可以使用前端技术构建桌面程序，GitHub 团队出品的 Atom 编辑器就是基于 Electron 创建的。本质上，Electron 内部封装了一个 Node.js，可以打开 Chrome 窗口渲染 UI，还可以访问操作系统本地的 API，并且没有浏览器中的沙盒机制。开发者可以通过 Electron 打包和分发应用程序。&lt;/p&gt;
&lt;p&gt;这是创建跨平台软件最简单的方式，而且还可以利用上述的所有工具。此外，Electron 有完整的文档和活跃的开发社区。&lt;/p&gt;
&lt;p&gt;你可能听说过 &lt;a href=&quot;http://nwjs.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nw.js&lt;/a&gt; 的大名，虽然它已经存在了多年，但相比来说，Electron 更加稳定和易用。&lt;/p&gt;
&lt;p&gt;这里有一个基于 &lt;a href=&quot;https://github.com/chentsulin/electron-react-boilerplate&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Electron、React 和 hot reload 的模板&lt;/a&gt;，尝试一下吧。&lt;/p&gt;
&lt;h2 id=&quot;延伸&quot;&gt;&lt;a href=&quot;#延伸&quot; class=&quot;headerlink&quot; title=&quot;延伸&quot;&gt;&lt;/a&gt;延伸&lt;/h2&gt;&lt;p&gt;下面是一些我在 Twitter 上关注的对象：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/gaearon&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Dan Abramov&lt;/a&gt;, Redux 的创建者&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://twitter.com/Vjeux&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Christopher Chedeau&lt;/a&gt;, 非常活跃的 React 开发者，现就职与 Facebook&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/jeffmo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Jeff Morrison&lt;/a&gt;, Flow 的核心贡献者之一&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://twitter.com/sebmarkbage&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sebastian Markbåge&lt;/a&gt;, React 的创建者之一&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://twitter.com/floydophone&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Pete Hunt&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://twitter.com/reactjs&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;React&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;更多值得关注的对象请参考 &lt;a href=&quot;https://twitter.com/oguzbilgic/lists/react-influencers&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;React Influencers&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;建议阅读 Pate Hunt 的 &lt;a href=&quot;https://github.com/petehunt/react-howto&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Learning React&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Dan Abramov 发布一系列的视频教程 &lt;a href=&quot;https://egghead.io/series/getting-started-with-redux&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Getting started with Redux&lt;/a&gt;，强烈推荐！此外，Dan 还发布过一个&lt;a href=&quot;https://medium.com/@dan_abramov/my-react-list-862227952a8c#.740o0wzee&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;关注列表&lt;/a&gt;，比上述更加详细。&lt;/p&gt;
&lt;p&gt;Mark Erikson 的 &lt;a href=&quot;https://github.com/markerikson/react-redux-links&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;React/Redux links&lt;/a&gt; 集合也是很好的学习材料。&lt;/p&gt;
&lt;h2 id=&quot;按需使用&quot;&gt;&lt;a href=&quot;#按需使用&quot; class=&quot;headerlink&quot; title=&quot;按需使用&quot;&gt;&lt;/a&gt;按需使用&lt;/h2&gt;&lt;p&gt;JavaScript 的生态环境发展迅速，正日益强大起来。React 的最佳实践正在固化，周边工具的职责和能力也日益清晰。&lt;/p&gt;
&lt;p&gt;最重要的事情就是要牢记：保持简洁，按需使用。&lt;/p&gt;
&lt;p&gt;如果你的应用程序只有两三屏，那么就无需使用路由系统；如果你正在创建一个单页应用，那么甚至不需要 Redux，只需要 React 自己的 state 属性即可；如果你正在创建一个简单的 CRUD 程序，那么你就不需要使用 Relay；如果你正在学习 ES6，并不需要深入地了解 Async/Await 或装饰器；如果你刚刚开始学习 React，并不需要使用热重载和服务端渲染；如果你刚刚接触 Webpack，你就不需要分离代码和合并多个资源；如果你刚刚学习 Redux，你不需要理解使用 Redux-Form 和 Redux-Sagas。&lt;/p&gt;
&lt;p&gt;保持简洁，每次只做一件事！&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;翻译自 &lt;a href=&quot;https://medium.com/javascript-and-opinions/state-of-the-art-javascript-in-2016-ab67fc68eb0b#.iwbk5gf69&quot;&gt;State of the Art JavaScript in 2016&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果你正在筹划新的前端项目或者重构现有项目，那么你需要认识到现在的前端开发环境已经今非昔比，这其中有太多的选择了：React、Flux、Angular、Aurelia、Mocha、Jasmine、Babel、TypeScript、Flow…… 它们的本意是将开发简单化，却无形中提高了学习成本，也给未来项目的维护带来了不确定性。&lt;/p&gt;
&lt;p&gt;好在这一现象正在退热，优胜劣汰，优秀的项目慢慢沉淀下来，开发方式也越来越清晰。有些开发者正在尝试使用基于上述技术的框架进行开发，也在一定程度上减少了学习成本。&lt;/p&gt;
&lt;p&gt;本文中主要介绍了一些我在 web 应用开发中所涉及和推崇的技术，其中有一些技术上存在争议，所以我对于每一技术都只做简单的介绍和分析。所有的这些观点都是基于我个人的经验和对社区的接触总结而来的，所以各位还请按需各取所用。&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>性能优化的十二个方面</title>
    <link href="http://pinggod.com/2016/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%9A%84%E5%8D%81%E4%BA%8C%E4%B8%AA%E6%96%B9%E9%9D%A2/"/>
    <id>http://pinggod.com/2016/性能优化的十二个方面/</id>
    <published>2016-03-04T12:37:34.000Z</published>
    <updated>2016-03-27T07:37:37.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;翻译自：&lt;a href=&quot;https://auth0.com/blog/2016/02/22/12-steps-to-a-faster-web-app/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;12 steps to a faster web app&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;现在，web app 日益重视用户的交互体验，了解性能优化的方式则可以有效提高用户体验。阅读和实践下面的性能优化技巧，可以帮你改善应用的流畅度、渲染时间和其他方面的性能表现。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h2&gt;&lt;p&gt;对 web app 进行性能优化是一份冗杂沉重的工作，这不仅是因为构建一个 web app 需要前后端协作，而且需要多方面的技术栈：数据库、后端、前端，需要运行在多种平台：iOS，安卓，Chrome，Firefox，Edge。这太复杂了！不过，还是有一些历经实践的通用方式可以用来优化 web app 的性能。在接下来的小节中，我们将逐步介绍相关的细节。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;一份来自 Bing 的研究表明，页面加载时间每增加 10ms，每年就会减少 $250k 的收入。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;过早优化&quot;&gt;&lt;a href=&quot;#过早优化&quot; class=&quot;headerlink&quot; title=&quot;过早优化&quot;&gt;&lt;/a&gt;过早优化&lt;/h4&gt;&lt;p&gt;性能优化的难点在于找出开发中值得优化的地方。Donald Knuth 说过一句经典的话：“过早的优化是一切罪恶的根源”。这句话背后的意思是说：花费大量时间改善 1% 的性能毫无意义。同时，某些优化方案反倒影响了可读性或可维护性，甚至引入了新的问题。换言之，性能优化不应该被视为“榨干应用程序性能的方法”，而应该视为“对性能和收益的平衡性所进行的探索”。在践行以下优化技巧时一定要牢记，盲目优化会影响生产效率，甚至得不偿失。最好的方式是使用分析工具来查找性能瓶颈，并在性能优化和开发效率、可维护性等方面保持平衡。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;开发者浪费了大量的时间去思考或者担心程序的执行速度，但实际上从调试和后期维护的角度看，这些优化措施往往会带来严重的负面影响。我们应该着重 97% 的运行表现：过早的性能优化是一切罪恶的根源。当然，我们也不应该放弃 3% 的痛点。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;1-文件压缩和模块打包&quot;&gt;&lt;a href=&quot;#1-文件压缩和模块打包&quot; class=&quot;headerlink&quot; title=&quot;1. 文件压缩和模块打包&quot;&gt;&lt;/a&gt;1. 文件压缩和模块打包&lt;/h2&gt;&lt;p&gt;JavaScript 通常是直接使用源码的方式分发的，而源码解析起来往往要慢于字节码。对于小脚本来说，两者解析的速度并不大，但对于大的应用程序来说，则会明显影响应用程序的启动速度。解决这一痛点，正是 &lt;a href=&quot;https://auth0.com/blog/2015/10/14/7-things-you-should-know-about-web-assembly/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;WebAssembly&lt;/a&gt; 的出发点之一，它将大幅改善程序的启动速度。文件压缩是剔除文件中无用字符的流程，虽然处理后的代码丧失了可读性，但提高了浏览器的解析速度。&lt;/p&gt;
&lt;p&gt;另一方面，模块打包可以将不同的脚本合并为一个脚本，从而降低 HTTP 请求，减少资源加载时间。通常来说，这种工作都会交给相应的工具来处理，比如 &lt;a href=&quot;https://webpack.github.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Webpack&lt;/a&gt;。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;insert&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.write(&lt;span class=&quot;string&quot;&gt;&quot;Sample &quot;&lt;/span&gt; + i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;; ++i) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    insert(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;压缩之后：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;!&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;r&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;t&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;o&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(e[o])&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; e[o].exports;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; n=e[o]=&amp;#123;exports:&amp;#123;&amp;#125;,id:o,loaded:!&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; r[o].call(n.exports,n,n.exports,t),n.loaded=!&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,n.exports&amp;#125;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; e=&amp;#123;&amp;#125;;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; t.m=r,t.c=e,t.p=&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;,t(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&amp;#125;([&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;r,t&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;e&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;r&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.write(&lt;span class=&quot;string&quot;&gt;&quot;Sample &quot;&lt;/span&gt;+r)&amp;#125;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; o=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;&amp;gt;o;++o)e(o)&amp;#125;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//# sourceMappingURL=bundle.min.js.map&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;深度打包&quot;&gt;&lt;a href=&quot;#深度打包&quot; class=&quot;headerlink&quot; title=&quot;深度打包&quot;&gt;&lt;/a&gt;深度打包&lt;/h4&gt;&lt;p&gt;使用 Webpack，我们也可以压缩 CSS 和合并图片，进一步改善程序的启动速度。更多有关 Webpack 的信息请参考&lt;a href=&quot;http://webpack.github.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;官方文档&lt;/a&gt;。&lt;/p&gt;
&lt;h2 id=&quot;2-按需加载&quot;&gt;&lt;a href=&quot;#2-按需加载&quot; class=&quot;headerlink&quot; title=&quot;2. 按需加载&quot;&gt;&lt;/a&gt;2. 按需加载&lt;/h2&gt;&lt;p&gt;按需加载资源或者说惰性加载资源（特别是图片）对优化 web app 的性能有很大帮助。对于图片较多的页面，使用惰性加载通常有以下三点好处：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;减少并发请求，缓解服务器压力，提高加载速度&lt;/li&gt;
&lt;li&gt;减少浏览器的内存占用率&lt;/li&gt;
&lt;li&gt;降低服务器的负载&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;图片或其他资源惰性加载的方案一般是，在程序启动时加载首屏资源，在页面滚动时持续加载即将进入视口的资源。由于这种方法往往需要与页面结构和开发方式相协调，所以常常使用现有的插件和扩展来实现惰性加载。举例来说，&lt;a href=&quot;https://github.com/loktar00/react-lazy-load&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;react-lazy-load&lt;/a&gt; 是一个基于 React 的图片惰性加载插件：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; MyComponent = () =&amp;gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;lt;div&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Scroll to load images.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;div className=&quot;filler&quot; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;LazyLoad height=&amp;#123;762&amp;#125; offsetVertical=&amp;#123;300&amp;#125;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;lt;img src=&#39;http://apod.nasa.gov/apod/image/1502/HDR_MVMQ20Feb2015ouellet1024.jpg&#39; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;lt;/LazyLoad&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    (...)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;一个典型的按需加载实例就是谷歌的&lt;a href=&quot;https://www.google.com/search?site=&amp;amp;tbm=isch&amp;amp;source=hp&amp;amp;biw=1366&amp;amp;bih=707&amp;amp;q=parrots&amp;amp;oq=parrots&amp;amp;gs_l=img.12...0.0.0.4086.0.0.0.0.0.0.0.0..0.0....0...1ac..64.img..0.0.0.UJrFBFKkWMA&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;图片搜索工具&lt;/a&gt;，点击这一链接并滚动页面，打开开发者工具注意资源的加载时间。&lt;/p&gt;
&lt;h2 id=&quot;3-array-ids&quot;&gt;&lt;a href=&quot;#3-array-ids&quot; class=&quot;headerlink&quot; title=&quot;3. array-ids&quot;&gt;&lt;/a&gt;3. array-ids&lt;/h2&gt;&lt;p&gt;如果你正在使用 React / Ember / Angular 或者其他操作 DOM 的第三方库，那么使用 array-ids（或者是 Angular 1.x 中的 &lt;code&gt;track-by&lt;/code&gt; 特性）可以有效提高页面性能，对动态网站的性能优化尤为突出。从最新的基准测试中我们也可以看出其中的优势：&lt;a href=&quot;https://auth0.com/blog/2016/01/11/updated-and-improved-more-benchmarks-virtual-dom-vs-angular-12-vs-mithril-js-vs-the-rest/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;More Benchmarks: Virtual DOM vs Angular 1 &amp;amp; 2 vs Mithril.js vs cito.js vs The Rest (Updated and Improved!)&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.auth0.com/blog/newdombenchs2/usedheap.svg&quot; alt=&quot;https://cdn.auth0.com/blog/newdombenchs2/usedheap.svg&quot;&gt;&lt;/p&gt;
&lt;p&gt;其背后的核心概念就是尽可能多地重复利用现有节点。Array-ids 便于 DOM 操作引擎根据获取到的 DOM 节点与真实的节点相匹配。如果没有 array-id 或者 track-by，大多数第三方库都会简单粗暴的删除节点然后再创建节点，这会严重影响程序的执行速度。&lt;/p&gt;
&lt;h2 id=&quot;4-缓存&quot;&gt;&lt;a href=&quot;#4-缓存&quot; class=&quot;headerlink&quot; title=&quot;4. 缓存&quot;&gt;&lt;/a&gt;4. 缓存&lt;/h2&gt;&lt;p&gt;缓存常用来存储频繁调用的数据，当缓存后的数据再次被调用时，就可以由缓存直接提供数据，提高数据的响应速度。通常来说，一个 web app 都是由多个组件构成的，在这些组件中都能发现缓存的影子。比如动态内容服务器和客户端之间使用的缓存，通过减少通用请求降低服务器负载，可以改善页面的响应时间；比如代码中的缓存处理，可以优化某些通用的脚本访问模式。此外，还有数据库缓存和长进程缓存等。&lt;/p&gt;
&lt;p&gt;简而言之，缓存是改善应用程序响应速度和降低 CPU 负载的有效方式。在一个开发体系中，最难的不是如何使用缓存，而是找出哪里适合使用缓存。对于这一问题，我还是建议使用事件分析工具（profiler）：找出性能瓶颈，检测缓存是否成功，测试缓存是否容易失效……这些问题都需要历经实践才能得出有效的结论。&lt;/p&gt;
&lt;p&gt;使用缓存可以优化资源加载，比如，使用 &lt;a href=&quot;https://addyosmani.com/basket.js/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;basket.js&lt;/a&gt; 利用本地存储缓存应用的脚本，在第二次调用资源时可以迅速从本地存储中获得相应的资源。&lt;/p&gt;
&lt;p&gt;Amazon CloudFront 是现在比较流行的一项缓存服务。CloudFront 的工作机制类似内容分发网络（CDN），可以为动态内容设置缓存。&lt;/p&gt;
&lt;h2 id=&quot;5-HTTP-2&quot;&gt;&lt;a href=&quot;#5-HTTP-2&quot; class=&quot;headerlink&quot; title=&quot;5. HTTP/2&quot;&gt;&lt;/a&gt;5. HTTP/2&lt;/h2&gt;&lt;p&gt;目前，已经有越来越多的浏览器支持 HTTP/2。HTTP/2 的优势在于它与服务器的并发连接，比如，如果需要加载的小型资源（前提是你不对资源进行打包）比较多，HTTP/2 在响应时间和性能上都要远远优胜于 HTTP/1。你可以点击 &lt;a href=&quot;https://http2.akamai.com/demo&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Akamai 的 HTTP/2 示例&lt;/a&gt; 查看两者的区别。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.auth0.com/blog/fasterweb/http2demo.png&quot; alt=&quot;https://cdn.auth0.com/blog/fasterweb/http2demo.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;6-性能剖析&quot;&gt;&lt;a href=&quot;#6-性能剖析&quot; class=&quot;headerlink&quot; title=&quot;6. 性能剖析&quot;&gt;&lt;/a&gt;6. 性能剖析&lt;/h2&gt;&lt;p&gt;性能剖析是应用程序进行性能优化的重要步骤。如上文所说，盲目地优化应用程序往往会降低生产力、产生新的痛点且难以维护。性能剖析的作用就是要找出应用程序中潜在的风险区域。&lt;/p&gt;
&lt;p&gt;对 web 应用程序来说，响应速度是一个非常重要的衡量指标，所以开发者都会尽可能地去提高资源的加载速度和页面的渲染速度。Chrome 浏览器提供了一系列优秀的性能剖析工具，其中最常用的就是开发者工具中的 timeline 和 network，善用它们可以准确定位有关响应速度的风险区域。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.auth0.com/blog/fasterweb/timeline.png&quot; alt=&quot;https://cdn.auth0.com/blog/fasterweb/timeline.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;timeline 面板便于快速查找耗时操作。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.auth0.com/blog/fasterweb/network.png&quot; alt=&quot;https://cdn.auth0.com/blog/fasterweb/network.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;network 面板便于定位由请求时间和串行加载引起的响应速度问题。&lt;/p&gt;
&lt;p&gt;此外，如果合理分析内存的使用率，也将有效提高应用程序的性能。如果你的页面中有大量的视觉元素（比如动态的表格）或者大量的交互元素（比如游戏），那么对内存使用的剖析就可以有效减少卡顿，提高帧速。如果你想了解如何在 Chrome 开发者工具中进行内存剖析，请参考这篇文章：&lt;a href=&quot;https://auth0.com/blog/2016/01/26/four-types-of-leaks-in-your-javascript-code-and-how-to-get-rid-of-them/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《4 Types of Memory Leaks in JavaScript and How to Get Rid Of Them 》&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;Chrome 开发者工具也可以对 CPU 的使用进行剖析，更多详细信息请参考来自谷歌文档的这篇文章：&lt;a href=&quot;https://developer.chrome.com/devtools/docs/cpu-profiling&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《 Profiling JavaScript Performance》&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.auth0.com/blog/fasterweb/cpu.png&quot; alt=&quot;https://cdn.auth0.com/blog/fasterweb/cpu.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;找出性能的核心痛点，才能让你更加高效地进行性能优化。&lt;/p&gt;
&lt;p&gt;相对而言，对后端进行性能剖析稍显困难。一般而言，从最耗时的请求入手查找相应的服务器是个不错的方法。这里并没有推荐任何有关后端的性能剖析工具，这是因为具体的剖析工具要视具体的后端技术栈而定。&lt;/p&gt;
&lt;h4 id=&quot;算法&quot;&gt;&lt;a href=&quot;#算法&quot; class=&quot;headerlink&quot; title=&quot;算法&quot;&gt;&lt;/a&gt;算法&lt;/h4&gt;&lt;p&gt;在大多数情况下，选择更高效的算法可以比局部优化获得更佳的收益。从某种意义上说，对 CPU 和内存进行性能剖析有助于帮助开发者找出应用程序中较大的性能瓶颈。如果这些瓶颈并不是由代码的错误引起的，那很有可能就是算法的问题。&lt;/p&gt;
&lt;h2 id=&quot;7-负载均衡&quot;&gt;&lt;a href=&quot;#7-负载均衡&quot; class=&quot;headerlink&quot; title=&quot;7. 负载均衡&quot;&gt;&lt;/a&gt;7. 负载均衡&lt;/h2&gt;&lt;p&gt;在上文的缓存一节中，简单提到了内容分发网络（CDN）的概念。根据服务器或者地理区域分发负载可以有效提高资源的响应速度，这一优势在处理并发链接时尤为明显。&lt;/p&gt;
&lt;p&gt;简而言之，负载均衡类似于一种轮询方案，基于反向代理服务器 &lt;a href=&quot;http://nginx.org/en/docs/http/load_balancing.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nginx&lt;/a&gt; 或者成熟的分发网络（比如 &lt;a href=&quot;https://www.cloudflare.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cloudflare&lt;/a&gt; 和 &lt;a href=&quot;https://aws.amazon.com/cloudfront/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Amazon CloudFront&lt;/a&gt; 构建。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.auth0.com/blog/fasterweb/diagram.png&quot; alt=&quot;https://cdn.auth0.com/blog/fasterweb/diagram.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;为了实现负载均衡，需要将动态内容和静态内容进行分离，便于执行并行连接。换言之，串行访问削弱了负载均衡检索最佳路径并进行分发的能力。此外，并行加载资源还可以加快应用程序的启动速度。&lt;/p&gt;
&lt;p&gt;负载均衡也可以构建的很精细。如果数据模型不能够很好地与最终的一致性算法或缓存保持良好的匹配关系，那么必将导致诸多问题。幸运的是，大多数的应用程序所请求的数据都是一个缩减集，该缩减集本身具有较高级别的一致性。如果你的应用程序还没有具备这样的能力，那么你需要考虑重构它了。&lt;/p&gt;
&lt;h2 id=&quot;8-同构-JavaScript&quot;&gt;&lt;a href=&quot;#8-同构-JavaScript&quot; class=&quot;headerlink&quot; title=&quot;8. 同构 JavaScript&quot;&gt;&lt;/a&gt;8. 同构 JavaScript&lt;/h2&gt;&lt;p&gt;对于 web 应用程序来说，一个增强用户体验的法门就是减少启动时间或者减少首屏渲染时间，这一点对于需要在客户端执行大量逻辑操作的单页应用尤为重要。在客户端执行的逻辑操作越多，通常意味着需要在首屏渲染前加载更多的资源。同构 JavaScript 就是用来解决这一问题的：JavaScript 可以同时在客户端和服务端执行，所以可以在服务端渲染出来首屏，然后将其发送给客户端，再由客户端的 JavaScript 接手剩下的逻辑处理。这一方案限制了服务端只能基于 JavaScript 框架，但可以提高用户体验。目前，在 &lt;a href=&quot;https://www.meteor.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Meteor.js&lt;/a&gt; 中已经可以直接使用这一方式了。此外，在 &lt;a href=&quot;https://github.com/DavidWells/isomorphic-react-example&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;React&lt;/a&gt; 框架中也可以采用这种方式，代码如下所示：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; React = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;react/addons&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; ReactApp = React.createFactory(&lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;../components/ReactApp&#39;&lt;/span&gt;).ReactApp);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;module&lt;/span&gt;.exports = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;app&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    app.get(&lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;req, res&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// React.renderToString takes your component&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// and generates the markup&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; reactHtml = React.renderToString(ReactApp(&amp;#123;&amp;#125;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// Output html rendered by react&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// console.log(myAppHtml);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        res.render(&lt;span class=&quot;string&quot;&gt;&#39;index.ejs&#39;&lt;/span&gt;, &amp;#123;reactOutput: reactHtml&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;下面是 Meteor.js 的简单示例：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (Meteor.isClient) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Template.hello.greeting = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Welcome to myapp.&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Template.hello.events(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;click input&#39;&lt;/span&gt;: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;// template data, if any, is available in &#39;this&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt; !== &lt;span class=&quot;string&quot;&gt;&#39;undefined&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;You pressed the button&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (Meteor.isServer) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  Meteor.startup(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// code to run on server at startup&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果你开发的是大中型复杂应用且支持同构发布，那么可以尝试一下这种方式，效果很可能令人震撼。&lt;/p&gt;
&lt;h2 id=&quot;9-索引&quot;&gt;&lt;a href=&quot;#9-索引&quot; class=&quot;headerlink&quot; title=&quot;9. 索引&quot;&gt;&lt;/a&gt;9. 索引&lt;/h2&gt;&lt;p&gt;如果数据库查询占据了太多的执行时间，那么你应该考虑优化数据库的执行速度了。每种数据库和数据模型都各有特色。数据库优化有多种方向：数据模型、数据库类型以及其他配置，所以优化起来并不简单。不过，我们还是有一些通用的优化技巧，比如说：索引。索引根据数据库的数据创建快速访问的数据结构，改善对特定数据的检索速度。现在大多数的数据库都支持索引功能，&lt;/p&gt;
&lt;p&gt;在使用索引优化数据库之前，你应该研究当前应用程序的访问模式，分析最常用到的查询是什么，哪一个键或者字段会被频繁查询等等。&lt;/p&gt;
&lt;h2 id=&quot;10-编译工具&quot;&gt;&lt;a href=&quot;#10-编译工具&quot; class=&quot;headerlink&quot; title=&quot;10. 编译工具&quot;&gt;&lt;/a&gt;10. 编译工具&lt;/h2&gt;&lt;p&gt;JavaScript 技术栈日益复杂，这也推动了语言本身的进步。不幸的是，JavaScript 的发展目前还要受限于用户的访问环境。虽然 ECMAScript 2015 已经对 JavaScript 做出了诸多改进，但是开发者尚不能直接遵循这一规范的代码。针对这一问题，也就衍生出了诸多编译工具，这些工具常用于将 ECMAScript 2015 的代码转换为 ECMAScript 5 的代码。此外，模块打包和文件压缩也加入到了编译过程，最终用于生成线上版本的代码。这些工具将代码转换为了一个受限的版本，间接影响到了最终代码的执行效率。谷歌开发者 Paul Irish 测试了代码转换对性能和文件大小的影响，详情请&lt;a href=&quot;https://github.com/paulirish/The-cost-of-transpiling-es2015-in-2016&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;点击链接&lt;/a&gt;。虽然大多数情况下影响甚微，但这些差异仍然值得引起注意，因为随着应用程序的复杂大增高，这些差异也将日益增大。&lt;/p&gt;
&lt;h2 id=&quot;11-阻塞渲染&quot;&gt;&lt;a href=&quot;#11-阻塞渲染&quot; class=&quot;headerlink&quot; title=&quot;11. 阻塞渲染&quot;&gt;&lt;/a&gt;11. 阻塞渲染&lt;/h2&gt;&lt;p&gt;JavaScript 和 CSS 资源的加载都会阻塞页面的渲染过程。通过某些技巧，开发者可以尽快加载 JavaScript 和 CSS 资源，从而让浏览器尽快显示网站的内容。&lt;/p&gt;
&lt;p&gt;对 CSS 来说，本质上符合当前页面媒体属性的 CSS 规则会具有较高的处理优先级。页面的媒体属性由 CSS 的媒体查询进行匹配。媒体查询通知浏览器哪一个 CSS 脚本针对哪一种媒体属性。举例来说，相对于当前屏幕显示的 CSS，用于打印的 CSS 的优先级较低。&lt;/p&gt;
&lt;p&gt;可以为 &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt; 标签设置与媒体查询有关的属性：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;link&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;rel&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;text/css&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;media&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;only screen and (max-device-width: 480px)&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;mobile-device.css&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对 JavaScript 来说，关键是恰当地使用内嵌 JavaScript（即在 HTML 中的 JavaScript）。内嵌 JavaScript 应该尽可能简短，且不能阻塞对页面其他部分的阻塞。换言之，位于 HTML 文档树之中的内嵌 JavaScript 会阻塞 HTML 脚本的解析，强制解析引擎直到脚本执行完成才能继续解析。如果 HTML 树中有大量这种阻塞脚本或者阻塞时间过长，势必严重破坏应用程序的用户体验。内嵌 JavaScript 有助于防止网络获取过多的脚本。对于反复用到的脚本，或者体积较大的脚本，不建议使用内联形式。&lt;/p&gt;
&lt;p&gt;一种有效防止 JavaScript 阻塞 HTML 解析的方法是以异步的方式加载 &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; 标签。这种方式限制了我们队 DOM 的访问（无法使用 &lt;code&gt;document.write&lt;/code&gt;)，但可以让浏览器在解析和渲染页面的时候无需考虑 JavaScript 的执行状态。换言之，为了获取最佳的启动速度，应该确保所有非必需的脚本都要以异步的形式加载：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;script src=&lt;span class=&quot;string&quot;&gt;&quot;async.js&quot;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt;&amp;gt;&lt;span class=&quot;xml&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;12-servce-workers-和-stream&quot;&gt;&lt;a href=&quot;#12-servce-workers-和-stream&quot; class=&quot;headerlink&quot; title=&quot;12. servce workers 和 stream&quot;&gt;&lt;/a&gt;12. servce workers 和 stream&lt;/h2&gt;&lt;p&gt;Jake Archibald 的&lt;a href=&quot;https://jakearchibald.com/2016/streams-ftw/#streaming-results&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;最新文章&lt;/a&gt; 对提高渲染速度提出了一个很有意思的方案：结合 service workers 和 stream 进行页面渲染。结果相当令人信服：&lt;/p&gt;
&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/Cjo9iq8k-bc&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;不幸的是，这一技巧所用到的 API 尚在变化之中，所以还不能应用于实际开发中。这一技巧的核心是在网站和客户端之间存放一个 service worker。service worker 可以用于缓存数据（比如网站的头部等不常变动的部分），避免网络查找失败。如果缓存数据丢失，可以通过 stream 快速获取。&lt;/p&gt;
&lt;h2 id=&quot;扩展阅读&quot;&gt;&lt;a href=&quot;#扩展阅读&quot; class=&quot;headerlink&quot; title=&quot;扩展阅读&quot;&gt;&lt;/a&gt;扩展阅读&lt;/h2&gt;&lt;p&gt;更多有关性能优化的信息和工具请参考以下链接：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/paulirish/The-cost-of-transpiling-es2015-in-2016&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Best Practices for Speeding up Your Website - Yahoo Developer Network&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://yslow.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;YSlow - a tool that checks for Yahoo’s recommended optimizations&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://developers.google.com/speed/docs/insights/rules&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PageSpeed Insights - Google Developers&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://developers.google.com/speed/pagespeed/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PageSpeed Tools - Google Developers&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blogs.msdn.com/b/ie/archive/2014/10/08/http-2-the-long-awaited-sequel.aspx&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HTTP/2: The Long-Awaited Sequel&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;结论&quot;&gt;&lt;a href=&quot;#结论&quot; class=&quot;headerlink&quot; title=&quot;结论&quot;&gt;&lt;/a&gt;结论&lt;/h2&gt;&lt;p&gt;随着应用程序变得越来越庞大和复杂，性能优化在 web 开发中的地位也越来越重要。针对性的性能优化至关重要，有助于降低时间成本和维护成本。web 应用程序历经发展，其作用已经不再是单一的内容展现，学习通用的性能优化模式，可以将一个难以使用的应用程序转为一个易于上手的工具。没有任何规则是绝对的，只有不断研究和剖析技术栈的深层次逻辑，才能合理进行性能优化。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;翻译自：&lt;a href=&quot;https://auth0.com/blog/2016/02/22/12-steps-to-a-faster-web-app/&quot;&gt;12 steps to a faster web app&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;现在，web app 日益重视用户的交互体验，了解性能优化的方式则可以有效提高用户体验。阅读和实践下面的性能优化技巧，可以帮你改善应用的流畅度、渲染时间和其他方面的性能表现。&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Lazy Loading Images on the Web</title>
    <link href="http://pinggod.com/2016/Lazy-loading-images-on-the-web/"/>
    <id>http://pinggod.com/2016/Lazy-loading-images-on-the-web/</id>
    <published>2016-02-17T04:00:04.000Z</published>
    <updated>2016-02-24T05:31:50.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;Summarized from &lt;a href=&quot;http://developer.telerik.com/featured/lazy-loading-images-on-the-web/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《Lazy Loading Images on the Web》&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Lazy loading images on the web means only download images which are in or near the viewport, and don’t load any other images that visitors will not likely see. To accomplish this effect, we just need a little bit of JavaScript.&lt;/p&gt;
&lt;p&gt;At its most basic implementation always need to do:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Build HTML with special data attribute&lt;/li&gt;
&lt;li&gt;Watch changes to the viewport or scrolling&lt;/li&gt;
&lt;li&gt;Swap the data attribute to src attribute&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Plain-JavaScript&quot;&gt;&lt;a href=&quot;#Plain-JavaScript&quot; class=&quot;headerlink&quot; title=&quot;Plain JavaScript&quot;&gt;&lt;/a&gt;Plain JavaScript&lt;/h2&gt;&lt;p&gt;The first step is creating HTML element with data attribute:&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;data-src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;path/to/source&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;alt&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Second, using &lt;code&gt;getBoundingClientRect()&lt;/code&gt; to test whether an image is within the viewport:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isElementInViewport&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;el&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; rect = el.getBoundingClientRect();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rect.top &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rect.left &amp;gt;= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rect.bottom &amp;lt;= (&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.innerHeight || &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.documentElement.clientHeight) &amp;amp;&amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rect.right &amp;lt;= (&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.innerWidth || &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.documentElement.clientWidth)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Last, geting all of images that we want to lazy load and swap the &lt;code&gt;data-src&lt;/code&gt; value to &lt;code&gt;src&lt;/code&gt; value:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//these handlers will be removed once the images have loaded&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;DOMContentLoaded&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;load&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;resize&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.addEventListener(&lt;span class=&quot;string&quot;&gt;&quot;scroll&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;lazyLoadImages&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; images = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelectorAll(&lt;span class=&quot;string&quot;&gt;&quot;#main-wrapper img[data-src]&quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        item;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// load images that have entered the viewport&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [].forEach.call(images, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;item&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isElementInViewport(item)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            item.setAttribute(&lt;span class=&quot;string&quot;&gt;&quot;src&quot;&lt;/span&gt;,item.getAttribute(&lt;span class=&quot;string&quot;&gt;&quot;data-src&quot;&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            item.removeAttribute(&lt;span class=&quot;string&quot;&gt;&quot;data-src&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// if all the images are loaded, stop calling the handler&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (images.length == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.removeEventListener(&lt;span class=&quot;string&quot;&gt;&quot;DOMContentLoaded&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.removeEventListener(&lt;span class=&quot;string&quot;&gt;&quot;load&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.removeEventListener(&lt;span class=&quot;string&quot;&gt;&quot;resize&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.removeEventListener(&lt;span class=&quot;string&quot;&gt;&quot;scroll&quot;&lt;/span&gt;, lazyLoadImages);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Plugin-amp-amp-Library&quot;&gt;&lt;a href=&quot;#Plugin-amp-amp-Library&quot; class=&quot;headerlink&quot; title=&quot;Plugin &amp;amp;&amp;amp; Library&quot;&gt;&lt;/a&gt;Plugin &amp;amp;&amp;amp; Library&lt;/h2&gt;&lt;p&gt;The following is some jquery plugins or libraries that can do similarly works:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/tuupola/jquery_lazyload&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/tuupola/jquery_lazyload&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://dinbror.dk/blazy/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://dinbror.dk/blazy/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://luis-almeida.github.io/unveil/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://luis-almeida.github.io/unveil/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ressio/lazy-load-xt&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/ressio/lazy-load-xt&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Responsive-images-service&quot;&gt;&lt;a href=&quot;#Responsive-images-service&quot; class=&quot;headerlink&quot; title=&quot;Responsive images service&quot;&gt;&lt;/a&gt;Responsive images service&lt;/h2&gt;&lt;p&gt;Why we need this? Using this service to get responsive images. For example, we can upload a huge image in backend and download appropriate image based on the device’s screen size and pixel density to compresse response size.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Before generating different dimensions images, it’s better to use image compression tool to reduce file size, such like &lt;a href=&quot;https://tinypng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://tinypng.com/&lt;/a&gt;. &lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Summarized from &lt;a href=&quot;http://developer.telerik.com/featured/lazy-loading-images-on-the-web/&quot;&gt;《Lazy Loading Images on the Web》&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Lazy loading images on the web means only download images which are in or near the viewport, and don’t load any other images that visitors will not likely see. To accomplish this effect, we just need a little bit of JavaScript.&lt;/p&gt;
&lt;p&gt;At its most basic implementation always need to do:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Build HTML with special data attribute&lt;/li&gt;
&lt;li&gt;Watch changes to the viewport or scrolling&lt;/li&gt;
&lt;li&gt;Swap the data attribute to src attribute&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>HTML5 Canvas</title>
    <link href="http://pinggod.com/2016/HTML5-canvas/"/>
    <id>http://pinggod.com/2016/HTML5-canvas/</id>
    <published>2016-02-16T05:17:10.000Z</published>
    <updated>2016-04-06T06:40:01.000Z</updated>
    
    <content type="html">&lt;p&gt;Canvas 是 HTML5 新引进的特性，通过 Canvas 技术可以使用 JavaScript 在浏览器中绘制图形。目前主流浏览器（IE9+）都支持该特性。创建一个最简单的 canvas 只需要两步，第一步是创建一个 canvas 标签： &lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;canvas&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;canvas&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接下来使用 JavaScript 获取 canvas 的上下文：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; canvas = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelector(&lt;span class=&quot;string&quot;&gt;&#39;#canvas&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; ctx = canvas.getContext(&lt;span class=&quot;string&quot;&gt;&#39;2d&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;大功告成！&lt;/p&gt;
&lt;h2 id=&quot;修改大小&quot;&gt;&lt;a href=&quot;#修改大小&quot; class=&quot;headerlink&quot; title=&quot;修改大小&quot;&gt;&lt;/a&gt;修改大小&lt;/h2&gt;&lt;p&gt;canvas 画布的默认尺寸为 300px * 150px，如果想要修改该尺寸，可以在 canvas 标签上添加 width 和 height 属性：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;canvas&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;canvas&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;width&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;500&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;height&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;500&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;width 和 height 属性不仅仅指定了画布的大小，而且同时制定了画布的分辨率。另一个值得注意的是，不用给这两个属性值添加单位。如果画布的尺寸不确定，还可以使用 JavaScript 进行控制：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;canvas.width = &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;canvas.height = &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;画线&quot;&gt;&lt;a href=&quot;#画线&quot; class=&quot;headerlink&quot; title=&quot;画线&quot;&gt;&lt;/a&gt;画线&lt;/h2&gt;&lt;p&gt;在 canvas 中画线只需要三行代码：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// move context to position (100, 100)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.moveTo(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// draw a line from current position of context to (500, 500)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.lineTo(&lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// all above was not executed util calling stroke or fill method&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.stroke()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;下面是常用的 context 方法：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;lienWidth&lt;/code&gt;, 设置线段的粗细&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lineCap&lt;/code&gt;, 设置线段两端的样式： &lt;code&gt;butt(default)&lt;/code&gt; / &lt;code&gt;round&lt;/code&gt; / &lt;code&gt;square&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lineJoin&lt;/code&gt;, 设置两条线段连接处的样式：&lt;code&gt;miter(default)&lt;/code&gt; / &lt;code&gt;bevel&lt;/code&gt; / &lt;code&gt;round&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;strokeStyle&lt;/code&gt;, 设置线段的颜色&lt;/li&gt;
&lt;li&gt;&lt;code&gt;stroke&lt;/code&gt;，绘制线段&lt;/li&gt;
&lt;li&gt;&lt;code&gt;fillStyle&lt;/code&gt;, 设置填充区域的颜色&lt;/li&gt;
&lt;li&gt;&lt;code&gt;fill&lt;/code&gt;, 填充一段区域&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;使用 &lt;code&gt;beginPath()&lt;/code&gt; 和 &lt;code&gt;closePath()&lt;/code&gt; 可以绘制多条独立的线段：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ctx.beginPath() &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.moveTo(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.lineTo(&lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.lineTo(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.closePath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.fillStyle = &lt;span class=&quot;string&quot;&gt;&quot;green&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.fill();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.beginPath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.moveTo(&lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.lineTo(&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.closePath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.lineWidth = &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.strokeStyle = &lt;span class=&quot;string&quot;&gt;&quot;yellow&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;绘制矩形&quot;&gt;&lt;a href=&quot;#绘制矩形&quot; class=&quot;headerlink&quot; title=&quot;绘制矩形&quot;&gt;&lt;/a&gt;绘制矩形&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ctx.rect(x, y, width, height)&lt;/code&gt; 方法可以用来绘制一个矩形:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cxt.beginPath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.rect(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.closePath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.lineWidth = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.fillStyle = &lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.strokeStyle = &lt;span class=&quot;string&quot;&gt;&#39;blue&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.fill();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.stroke();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;下面是两个更简洁的矩形绘制方法：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cxt.lineWidth = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.fillStyle = &lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.strokeStyle = &lt;span class=&quot;string&quot;&gt;&#39;blue&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.fillRect(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cxt.strokeRect(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;画圆&quot;&gt;&lt;a href=&quot;#画圆&quot; class=&quot;headerlink&quot; title=&quot;画圆&quot;&gt;&lt;/a&gt;画圆&lt;/h2&gt;&lt;p&gt;&lt;code&gt;ctx.arc(x, y, r, startAngle, endAngle, anticlockwise)&lt;/code&gt; 方法可以用来绘制一个圆形，圆形位于 (x, y)，半径为 r，起始点为 &lt;code&gt;startAngle&lt;/code&gt;，终点为 &lt;code&gt;endAngle&lt;/code&gt;，&lt;code&gt;anticlockwise&lt;/code&gt; 决定旋转方向，默认值为顺时针方向。&lt;/p&gt;
&lt;canvas id=&quot;arc-canvas-demo&quot;&gt;&lt;/canvas&gt;

&lt;style&gt;
#arc-canvas-demo {
    display: block;
    width: 100px;
    height: 100px;
    margin: 0 auto;
}
&lt;/style&gt;

&lt;script&gt;
(function() {
    &quot;use strict&quot;;
    var canvas = document.querySelector(&#39;#arc-canvas-demo&#39;);
    var ctx = canvas.getContext(&#39;2d&#39;);
    if (ctx) {
        canvas.width = 100;
        canvas.height = 100;
        ctx.beginPath();
        ctx.arc(50, 50, 50, 0, 1.5 * Math.PI);
        ctx.closePath()
        ctx.lineWidth = 1;
        ctx.fillStyle = &quot;#42b983&quot;;
        ctx.fill();
    }
    else {
        canvas.innerHTML = &quot;Update your browser to enjoy canvas :) !&quot;
    }
})();
&lt;/script&gt;

&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ctx.beginPath();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.arc(&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt; * &lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.PI);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.closePath()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.lineWidth = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.fillStyle = &lt;span class=&quot;string&quot;&gt;&quot;#42b983&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ctx.fill();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;ctx.clearrect(xTopLeft, yTopLeft, xBottomRight, yBottomRight)&lt;/code&gt; 方法可以用来清除特定区域。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h6 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.imooc.com/video/3492&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Canvas 绘图详解&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Canvas 是 HTML5 新引进的特性，通过 Canvas 技术可以使用 JavaScript 在浏览器中绘制图形。目前主流浏览器（IE9+）都支持该特性。创建一个最简单的 canvas 只需要两步，第一步是创建一个 canvas 标签： &lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;canvas&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;canvas&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接下来使用 JavaScript 获取 canvas 的上下文：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; canvas = &lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.querySelector(&lt;span class=&quot;string&quot;&gt;&#39;#canvas&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; ctx = canvas.getContext(&lt;span class=&quot;string&quot;&gt;&#39;2d&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Tmux</title>
    <link href="http://pinggod.com/2016/Tmux/"/>
    <id>http://pinggod.com/2016/Tmux/</id>
    <published>2016-02-13T05:09:06.000Z</published>
    <updated>2016-02-13T10:45:07.000Z</updated>
    
    <content type="html">&lt;p&gt;Recently, I am learning some different programming languages which exciting and a little bit tired. Why tired? Coding, testing code and taking notes always need two or three panes in one shell window for each programming language every time, and this is where tmux comes in.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/tmux-structure.png&quot; alt=&quot;tmux-demo&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tmux is a terminal multiplexer, and it lets developers switch easily between programs in one termial, detach them and reattach them to a different terminal. &lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;Key-bindings&quot;&gt;&lt;a href=&quot;#Key-bindings&quot; class=&quot;headerlink&quot; title=&quot;Key bindings&quot;&gt;&lt;/a&gt;Key bindings&lt;/h2&gt;&lt;p&gt;The GitHub repo &lt;a href=&quot;https://github.com/gpakosz/.tmux&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;.tmux&lt;/a&gt; is a pretty and versatile self-contained tmux configuration which I am using. &lt;code&gt;C-a&lt;/code&gt; is the prefix key provided by this repo, while we can keep use default &lt;code&gt;C-b&lt;/code&gt; prefix. The following tables show common key bindings which come into play with prefix key, from session to pane:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SESSION KEY BINGDINGS&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;tmux ls&lt;/code&gt;，显示所有 session&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tmux new -s session-name&lt;/code&gt;，新建 session&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tmux attach -t session-name&lt;/code&gt;，进入 session&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tmux kill-session -t session-name&lt;/code&gt;，关闭 session&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;Key&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;C-f&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;find session&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;d&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;hang-up session&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;r&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;reload configuration&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;WINDOW KEY BINGDINGS&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;Key&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;c&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;create new window&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;,&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;rename current window&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;s&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;list all windows&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;f&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;find window&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;0~9&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;switch window according to serial number&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;&amp;amp;&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;exit tmux and close current window&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;space&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;adjust layout&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;PANE KEY BINGDINGS&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:center&quot;&gt;Key&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;%&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;create new pane with horizontal direction&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;“&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;create new pane with vertical direction&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;hjkl&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;switch pane&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;HJKL&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;adjust layout size of panes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;o&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;cycle panes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;q&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;display serial number of panes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;x&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;close current pane&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;{/}&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;switch postion of panes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;Enter&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;enter copy-mode&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:center&quot;&gt;l&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;clear pane and history&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Recently, I am learning some different programming languages which exciting and a little bit tired. Why tired? Coding, testing code and taking notes always need two or three panes in one shell window for each programming language every time, and this is where tmux comes in.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/tmux-structure.png&quot; alt=&quot;tmux-demo&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tmux is a terminal multiplexer, and it lets developers switch easily between programs in one termial, detach them and reattach them to a different terminal. &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Truthy and Falsy</title>
    <link href="http://pinggod.com/2016/Truthy-and-Falsy/"/>
    <id>http://pinggod.com/2016/Truthy-and-Falsy/</id>
    <published>2016-02-12T02:30:54.000Z</published>
    <updated>2016-02-17T05:16:21.000Z</updated>
    
    <content type="html">&lt;p&gt;Truty value and falsy value is a little bit different from Boolean value. In JavaScript, the truthy value is strict equal to &lt;code&gt;true&lt;/code&gt; when evaluated in a Boolean context, and the falsy value is evaluted to &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The following value is common falsy value:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;false&lt;/li&gt;
&lt;li&gt;null&lt;/li&gt;
&lt;li&gt;undefined&lt;/li&gt;
&lt;li&gt;0&lt;/li&gt;
&lt;li&gt;NaN&lt;/li&gt;
&lt;li&gt;‘’&lt;/li&gt;
&lt;li&gt;document.all&lt;/li&gt;
&lt;/ul&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;All value are truthy value except falsy value:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;!!&amp;#123;&amp;#125; === &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;!!&lt;span class=&quot;built_in&quot;&gt;document&lt;/span&gt;.all === &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;Reference&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Glossary/Truthy&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MDN - Truthy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Glossary/Falsy&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MDN - Falsy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Truty value and falsy value is a little bit different from Boolean value. In JavaScript, the truthy value is strict equal to &lt;code&gt;true&lt;/code&gt; when evaluated in a Boolean context, and the falsy value is evaluted to &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The following value is common falsy value:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;false&lt;/li&gt;
&lt;li&gt;null&lt;/li&gt;
&lt;li&gt;undefined&lt;/li&gt;
&lt;li&gt;0&lt;/li&gt;
&lt;li&gt;NaN&lt;/li&gt;
&lt;li&gt;‘’&lt;/li&gt;
&lt;li&gt;document.all&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Mongodb</title>
    <link href="http://pinggod.com/2016/mongodb/"/>
    <id>http://pinggod.com/2016/mongodb/</id>
    <published>2016-01-28T07:58:12.000Z</published>
    <updated>2016-02-09T13:52:13.000Z</updated>
    
    <content type="html">&lt;p&gt;Mongodb 提供了 Homebrew 的安装方式，安装过程如下：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brew update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brew install mongodb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mkdir -p /data/db&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chmod u+rw /data/db&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mongod&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;Mongodb 安装完全后，在 bin 文件夹下有以下可执行程序：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;mongod&lt;/code&gt;，mongodb 的执行和部署程序&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mongo&lt;/code&gt;，连接 mongodb 服务器的客户端&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mongoimport / mongoexport&lt;/code&gt;，mongodb 数据导入导出程序&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mongoreestore / mongodump&lt;/code&gt;，mongodb 二进制数据导入导出程序，常用做数据备份和恢复&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mongooplog&lt;/code&gt;，操作日志记录程序&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mongostat&lt;/code&gt;，mongodb 状态监控和查询程序&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Mongodb 数据库的简单组成结构及分工职责：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;data&lt;/code&gt;，存储数据库的数据文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;log&lt;/code&gt;，存储数据库的日志文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bin&lt;/code&gt;，存储数据库的可执行文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;conf&lt;/code&gt;，存储数据库的配置文件&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;创建一个轻量的 Mongodb 数据库：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mkdir mongodb-in-action&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; mongodb-in-action&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mkdir data &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; conf bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cp /usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/Cellar/mongodb/3.2.1/bin/&amp;#123;mongod,mongo&amp;#125; ./bin/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;touch conf/mongod.conf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;conf/mongod.conf&lt;/code&gt; 是这个数据库的配置文件，内容如下：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;port = 12345&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dbpath = data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;logpath = &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/mongod.log&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 是否启用后台进程&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fork = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;然后使用指定的配置文件启动 Mongodb 服务器：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;./bin/mongod &lt;span class=&quot;_&quot;&gt;-f&lt;/span&gt; ./conf/mongod.conf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接下来我们使用 &lt;code&gt;mongo&lt;/code&gt; 连接数据库，连接之前查看 &lt;code&gt;mongo --help&lt;/code&gt; 信息：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;查看第二行的 &lt;code&gt;usage&lt;/code&gt; 了解使用方式&lt;/li&gt;
&lt;li&gt;查看第三行开始的示例了解连接格式&lt;/li&gt;
&lt;li&gt;查看 options 字段下的内容了解可用参数&lt;/li&gt;
&lt;li&gt;查看 Authentication Options 字段下的内容了解认证登录的方式&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;接下来连接 &lt;code&gt;mongodb-in-action&lt;/code&gt; 的 test 数据库:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;./bin/mongo 127.0.0.1:12345/&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在 mongo 客户端中关闭 mongodb 数据库：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;use admin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.shutdownServer()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;基本操作&quot;&gt;&lt;a href=&quot;#基本操作&quot; class=&quot;headerlink&quot; title=&quot;基本操作&quot;&gt;&lt;/a&gt;基本操作&lt;/h2&gt;&lt;p&gt;Mongodb 数据库的常用操作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;show dbs&lt;/code&gt;，显示所有数据库&lt;/li&gt;
&lt;li&gt;&lt;code&gt;use dbname&lt;/code&gt;，切换到 dbname 数据库&lt;/li&gt;
&lt;li&gt;&lt;code&gt;db.dropDatabase()&lt;/code&gt;，删除当前数据库&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;use admin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 显示集合&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;show collections&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 简单插入数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.insert(&amp;#123; x: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 简单查询数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.find()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 使用 Javascript 语法插入多条数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    db.imooc_collections.insert(&amp;#123; x: i * &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 统计数据量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.find().count()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// skip() 跳过数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// limit() 限制返回的数据长度&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// sort() 数据排序&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.find().skip(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;).limit(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;).sort(&amp;#123;x:&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 简单更新数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.update( &amp;#123;x: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;#125;, &amp;#123;x: &lt;span class=&quot;number&quot;&gt;999&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 使用 $set 操作符进行局部更新&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.insert( &amp;#123; x: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, y: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, z: &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.update( &amp;#123; y: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &amp;#125;, &amp;#123; $set: &amp;#123; z: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#125; &amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Mongodb 默认更新找到的第一条数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 同时更新多条数据需要是，第二个 JSON 参数必须是 $set &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 第三个参数表示匹配不到数据时自动插入更新数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 第四个参数表示是否同时更新多条记录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.update( &amp;#123; x: &lt;span class=&quot;number&quot;&gt;999&lt;/span&gt; &amp;#125;, &amp;#123; $set: &amp;#123; x: &lt;span class=&quot;number&quot;&gt;321&lt;/span&gt; &amp;#125; &amp;#125;, &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 删除数据使用 remove()，该方法参数不能为空&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.remove( &amp;#123;x: &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 删除整个集合或者表&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.drop()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;索引&quot;&gt;&lt;a href=&quot;#索引&quot; class=&quot;headerlink&quot; title=&quot;索引&quot;&gt;&lt;/a&gt;索引&lt;/h2&gt;&lt;p&gt;索引是对数据库单列或多列进行排序的结构，使用索引可以快速访问数据库中的特定信息。Mongodb 中的索引主要分为以下几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;_id 索引。_id 索引是大多数集合默认创建的索引类型，对于每一个插入的数据，Mongodb 都会自动生成一条唯一的 _id 字段&lt;/li&gt;
&lt;li&gt;单键索引，单键索引是最普通的索引，值为单一的值，比如字符串、数值或日期，不会自动创建&lt;/li&gt;
&lt;li&gt;多键索引，与单键索引不同的地方就在于它的值可以是复合类型数据&lt;/li&gt;
&lt;li&gt;复合索引，用于有多个查询条件的情景中&lt;/li&gt;
&lt;li&gt;过期索引，指在特定时间后会过期的索引，索引过期后，相应的数据也会被删除，常用于存储登录信息、存储日志等数据。存储在过期索引字段的值必须是指定的事件类型（ISODate 或者 ISODate 数组)&lt;/li&gt;
&lt;li&gt;全文索引，对字符串和字符串数组创建全文可搜索的索引&lt;/li&gt;
&lt;li&gt;地理位置索引，&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 查看字段是否存在&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.find(&amp;#123; x: &amp;#123; $exists: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &amp;#125; &amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 查看当前集合的所有索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.getIndexes()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建单键索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.ensureIndex(&amp;#123; x: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建多键索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 如果插入的是数组，默认添加多键索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.insert(&amp;#123; x: [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;] &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建复合索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.ensureIndex(&amp;#123; x: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, y: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建过期数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.insert(&amp;#123; x: &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Date&lt;/span&gt;() &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建过期索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.imooc_collections.ensureIndex(&amp;#123; x: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;#125;, &amp;#123; expireAfterSeconds: &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; &amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建全文索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.articles.ensureIndex(&amp;#123; key: &lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.articles.ensureIndex(&amp;#123; k_1: &lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt;, k_2: &lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.articles.ensureIndex(&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;$**&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;text&quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 全文索引示例&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.article.insert(&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;article&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;aa bb cc&quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.article.insert(&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;article&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;aa bb cc dd&quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.article.insert(&amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;article&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;aa bb cc dd ee&quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.article.find(&amp;#123; $text: &amp;#123; $search: &lt;span class=&quot;string&quot;&gt;&quot;cc&quot;&lt;/span&gt; &amp;#125; &amp;#125; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 全文索引相似度查询&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.article.find(&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        $text: &amp;#123; $search: &lt;span class=&quot;string&quot;&gt;&quot;aa bb&quot;&lt;/span&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;, &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        score: &amp;#123; $meta: &lt;span class=&quot;string&quot;&gt;&quot;textScore&quot;&lt;/span&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;.sort(&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    score: &amp;#123; $meta: &lt;span class=&quot;string&quot;&gt;&quot;textScore&quot;&lt;/span&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;全文索引支持相似度查询，相似度查询的格式是在查询条件后添加字段：&lt;code&gt;{ score: { $meta: &amp;quot;textScore&amp;quot; } }&lt;/code&gt;，配合 sort 方法可以根据相似度对搜索结果进行排序。全文查找的注意点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;$search: &amp;quot;aa bb cc&amp;quot;&lt;/code&gt;，查询匹配 aa/bb/cc 其中之一的项&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$search: &amp;quot;aa bb -cc&amp;quot;&lt;/code&gt;，查询匹配 aa/bb 其中之一但不包含 cc 的项&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$search: &amp;quot;\&amp;quot;aa\&amp;quot; \&amp;quot;bb\&amp;quot;&amp;quot;&lt;/code&gt;，查询同时包含 aa/bb 的项&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;索引的四个重要特性，这四个特性也是 ensureIndex() 的四个可选参数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;名字&lt;/li&gt;
&lt;li&gt;唯一性&lt;/li&gt;
&lt;li&gt;稀疏性&lt;/li&gt;
&lt;li&gt;是否定时删除&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;db.imooc.ensureIndex(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123; x: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; &amp;#125;, &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123; name: &lt;span class=&quot;string&quot;&gt;&quot;xIndex&quot;&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123; unique: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123; sparse: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123; expireAfterSconds: &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;地理位置索引&quot;&gt;&lt;a href=&quot;#地理位置索引&quot; class=&quot;headerlink&quot; title=&quot;地理位置索引&quot;&gt;&lt;/a&gt;地理位置索引&lt;/h2&gt;&lt;p&gt;地址位置索引用于在 mongodb 中存储位置信息，创建后，各个位置之间可以相互检索。地理位置索引分为两类：2d 索引，用于存储和查找平面上的点；2dsphere 索引，用于存储和查找球面上的点。查找方式主要有两种：查找距离某个点一定距离内的点；查找包含在某个区域中的点。&lt;/p&gt;
&lt;p&gt;在 2d 索引中指定区域有以下三种格式：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;$box: [ [lx, ly], [rx, ry] ]&lt;/code&gt;，指定矩形&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$center: [ [x, y], r ]&lt;/code&gt;，指定圆形&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$polygon: [ [x1, y1], [x2, y2], [x3, y3] ]&lt;/code&gt;，指定多边形&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建地理位置数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.insert(&amp;#123; w: [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.insert(&amp;#123; w: [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.insert(&amp;#123; w: [&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;] &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建 2d 索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.ensureIndex(&amp;#123; w: &lt;span class=&quot;string&quot;&gt;&quot;2d&quot;&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 根据 [1, 1] 查询附近的点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 匹配的点和 [1, 1] 的最大距离为 10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.find(&amp;#123; w: &amp;#123; $near: [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], $maxDistance: &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; &amp;#125; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 在矩形区域内查找某个点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.find(&amp;#123; w: &amp;#123; $geoWithin: &amp;#123; $box: [ [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2.5&lt;/span&gt;] ] &amp;#125; &amp;#125; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 在圆形区域内查找某个点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.find(&amp;#123; w: &amp;#123; $geoWithin: &amp;#123; $center: [ [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; ] &amp;#125; &amp;#125; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 在多边形区域内查找某个点&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.find(&amp;#123;w: &amp;#123;$geoWithin: &amp;#123;$polygon: [[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;],[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]]&amp;#125;&amp;#125;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 创建 2dsphere 索引&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.localindex.ensureIndex(&amp;#123; w: &lt;span class=&quot;string&quot;&gt;&quot;2dsphere &amp;#125;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;索引构建分析&quot;&gt;&lt;a href=&quot;#索引构建分析&quot; class=&quot;headerlink&quot; title=&quot;索引构建分析&quot;&gt;&lt;/a&gt;索引构建分析&lt;/h2&gt;&lt;p&gt;评判索引构建情况的四种工具：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;mongostat&lt;/li&gt;
&lt;li&gt;profile 集合&lt;/li&gt;
&lt;li&gt;日志&lt;/li&gt;
&lt;li&gt;explain&lt;/li&gt;
&lt;/ol&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Mongodb 提供了 Homebrew 的安装方式，安装过程如下：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;brew update&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;brew install mongodb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mkdir -p /data/db&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chmod u+rw /data/db&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mongod&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>CSS Counters</title>
    <link href="http://pinggod.com/2016/CSS-Counters/"/>
    <id>http://pinggod.com/2016/CSS-Counters/</id>
    <published>2016-01-25T04:23:35.000Z</published>
    <updated>2016-01-26T04:31:20.000Z</updated>
    
    <content type="html">&lt;p&gt;Several years ago, a question was rasied by someone on Weibo: how to code the module of calculating commodity price, which plays a big role in Taobao commodity detail pages. Usually at the detail page, the commodity has many options, such like size and color. The amount will change real time when users change their options. This question is not noly business-oriented, but also has many solving methods. JS came to my mind first at the time.&lt;/p&gt;
&lt;p&gt;The last two weeks, I’m digesting technical posts which collected in Pocket and Weibo over past three years. There are many Best Practice in it, such like CSS Counters which the rest is going to say. &lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;CSS Counters is proposed in CSS2.1, so not only modern browsers, but also IE8+ support it. CSS Counters is a auto-counter, and it should coordinate with pseudo-classes &lt;code&gt;::before&lt;/code&gt; and &lt;code&gt;::after&lt;/code&gt; to use。&lt;/p&gt;
&lt;h2 id=&quot;Property&quot;&gt;&lt;a href=&quot;#Property&quot; class=&quot;headerlink&quot; title=&quot;Property&quot;&gt;&lt;/a&gt;Property&lt;/h2&gt;&lt;p&gt;CSS Counters have a series of property or method to use:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;counter-reset&lt;/code&gt;, used to initialize a counter. It receives two parameters: the first is a string identifier, and the second is a optional number which used to initialize counter’s default value.   &lt;/li&gt;
&lt;li&gt;&lt;code&gt;counter-increment&lt;/code&gt;, used to increse the counter’s value, and it receives a optional number parameter. If the optional parameter exsits, the counter will plus it instead of the default value one.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;counter()&lt;/code&gt;, used to get counter’s result in the &lt;code&gt;content&lt;/code&gt; property.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Usage&quot;&gt;&lt;a href=&quot;#Usage&quot; class=&quot;headerlink&quot; title=&quot;Usage&quot;&gt;&lt;/a&gt;Usage&lt;/h2&gt;&lt;p&gt;As metioned above, we could use counter-reset property to defined a counter. Look at the following html structure:&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;body&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;And styles:&lt;/p&gt;
&lt;figure class=&quot;highlight scss&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-tag&quot;&gt;ul&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;counter-reset&lt;/span&gt;: li-counter &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;selector-tag&quot;&gt;li&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attribute&quot;&gt;counter-increment&lt;/span&gt;: li-counter &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;selector-tag&quot;&gt;p&lt;/span&gt;::before &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;attribute&quot;&gt;content&lt;/span&gt;: counter(li-counter);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Based on above code fragments, counter called “li-counter” was created, and its initial value is 10. At the li tag, counter-increment comes in and increse the counter’s vlaue. Finally, p tag was created with pseudo-class &lt;code&gt;::before&lt;/code&gt; to display the counter’s end result.&lt;/p&gt;
&lt;h2 id=&quot;Example&quot;&gt;&lt;a href=&quot;#Example&quot; class=&quot;headerlink&quot; title=&quot;Example&quot;&gt;&lt;/a&gt;Example&lt;/h2&gt;&lt;div class=&quot;counter-wrap&quot;&gt;&lt;ul class=&quot;row&quot;&gt;&lt;li class=&quot;price-10&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;color&quot; id=&quot;white&quot;&gt;&lt;label for=&quot;white&quot;&gt;White(+10)&lt;/label&gt;&lt;/li&gt;&lt;li class=&quot;price-13&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;color&quot; id=&quot;red&quot;&gt;&lt;label for=&quot;red&quot;&gt;Red(+13)&lt;/label&gt;&lt;/li&gt;&lt;li class=&quot;price-15&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;color&quot; id=&quot;green&quot;&gt;&lt;label for=&quot;green&quot;&gt;Green(+15)&lt;/label&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=&quot;row&quot;&gt;&lt;li class=&quot;price-4&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;size&quot; id=&quot;small&quot;&gt;&lt;label for=&quot;small&quot;&gt;Small(+4)&lt;/label&gt;&lt;/li&gt;&lt;li class=&quot;price-8&quot;&gt;&lt;input type=&quot;radio&quot; name=&quot;size&quot; id=&quot;large&quot;&gt;&lt;label for=&quot;large&quot;&gt;Large(+8)&lt;/label&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=&quot;row&quot;&gt;&lt;li class=&quot;price-total&quot;&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;

&lt;style&gt;
@charset &quot;UTF-8&quot;;
.counter-wrap {
  width: 360px;
  margin: 0 auto;
  counter-reset: price 10;
}

.counter-wrap ul.row {
  margin: 2px 2px 2px 0;
  padding: 0;
  list-style-type: none;
}

.counter-wrap li {
  display: inline-block;
  margin: 10px 2px;
  text-align: center;
}

.counter-wrap input {
  position: absolute;
  clip: rect(0 0 0 0);
}

.counter-wrap label {
  padding: 10px 16px;
  color: white;
  background-color: #79BD8F;
  border-radius: 5px;
}

.counter-wrap input:checked + label {
  background-color: #F06161;
}

.counter-wrap input#small:checked {
  counter-increment: price 4;
}

.counter-wrap input#large:checked {
  counter-increment: price 8;
}

.counter-wrap input#white:checked {
  counter-increment: price 10;
}

.counter-wrap input#red:checked {
  counter-increment: price 13;
}

.counter-wrap input#green:checked {
  counter-increment: price 15;
}

.counter-wrap li.price-total {
  padding: 10px 16px;
  background-color: #BEEB9F;
  border-radius: 5px;
}
.counter-wrap li.price-total::before {
  content: &quot;$&quot; counter(price);
  color: #D83C65;
  font-weight: bold;
}
&lt;/style&gt;

&lt;p&gt;As you can see, here is a simple commodity form with multiple options. If you click colors or sizes, the amount will change real time. With this approach, code is cleaner and more robust.&lt;/p&gt;
&lt;p&gt;For more infomation about this example, you could look over my Codepen playground via this &lt;a href=&quot;http://codepen.io/pinggod/pen/JGpVNx?editors=1100&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;link&lt;/a&gt;.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Several years ago, a question was rasied by someone on Weibo: how to code the module of calculating commodity price, which plays a big role in Taobao commodity detail pages. Usually at the detail page, the commodity has many options, such like size and color. The amount will change real time when users change their options. This question is not noly business-oriented, but also has many solving methods. JS came to my mind first at the time.&lt;/p&gt;
&lt;p&gt;The last two weeks, I’m digesting technical posts which collected in Pocket and Weibo over past three years. There are many Best Practice in it, such like CSS Counters which the rest is going to say. &lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>WEB 开发者必看的技术站点</title>
    <link href="http://pinggod.com/2015/%E5%BC%80%E5%8F%91%E8%80%85%E5%BF%85%E7%9C%8B%E7%9A%84%E6%8A%80%E6%9C%AF%E7%AB%99%E7%82%B9/"/>
    <id>http://pinggod.com/2015/开发者必看的技术站点/</id>
    <published>2015-12-31T06:49:13.000Z</published>
    <updated>2016-04-06T06:42:23.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;本文总结自 Quora 上的一个问答：&lt;a href=&quot;https://www.quora.com/What-are-the-top-10-websites-a-web-developer-must-see&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;What are the top 10 websites a web developer must see&lt;/a&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;读专业书、看教程视频、浏览技术博客、参加讲座分享……这些提高技能的途径各有优劣，相比较而言，博客或者说技术网站可以最快接触前沿技术、分享技术实践，所以，除了依赖谷歌反馈的词条，我们还可以主动收集一些优秀的技术站点，便于自己了解、参与和实践业界最活跃的技术。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://github.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt; —— 当下最流行的版本管理工具，云集了世界上最优秀的开发者。在 GitHub 开源之风盛行，我喜欢在这里关注各类优秀项目，也喜欢在这里查找各种工具，比如需要某个 alfred 的插件，在这里搜一下也许就能找到，如果遇到了问题，和开发者反馈一下也不是什么难事。最近喜欢浏览 trending 和 follow 大神，便于了解业界动态，顺便细化下自己的技术栈。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://alistapart.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;A List Apart&lt;/a&gt;—— 我想给这个网站定义几个头衔，比如顶级、前沿、经典、最具影响力之类等等。这个网站创办十八年了（from 1998），专注对前端方向的探索，每一篇文章都是深入思考的结晶。典型的文章就是&lt;a href=&quot;http://alistapart.com/article/responsive-web-design&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《Responsive Web Design》&lt;/a&gt;，发表之后迅速启发了业界的开发思维，打开了响应式设计的大门。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MDN&lt;/a&gt; —— Mozilla 开发者网络知识库，权威、全面的 WEB 文档，支持多种语言，示例丰富。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Stack Overflow&lt;/a&gt; —— 活跃的技术问答社区。一般问题都有开发者问过了，如果找不到，换一换关键字，最后的方式才应该是提问。作为开发者，为了使用 Stack Overflow 也应该给自己准备一个翻墙工具，永远不要闭门造车般的解决问题。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://caniuse.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Can I Use&lt;/a&gt; —— 如果你有兼容性问题，先来这里看看浏览器的支持情况吧。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://css-tricks.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CSS-Tricks&lt;/a&gt; —— 这里发表所有和 CSS 有关的技巧和教程，当然如果你想来这里找点黑科技，也是有的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://tympanus.net/codrops/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Codrops&lt;/a&gt; —— 如果有一天我可以靠理想生活，那我肯定要先实践一番 Codrops 上的教程，这些教程的效果绝对出彩，这也是前端吸引我的魅力所在。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://codepen.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodePen&lt;/a&gt; —— 在线 WEB 开发工具。一方面我们可以在这里快速实践自己的灵感，另一方面当我们的调试遇到困境，在这里搭一个 DEMO 详细描述下问题，然后发给有经验的人，绝对是最佳的问答礼仪。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://dribbble.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Dribble&lt;/a&gt; —— 作为前端开发者，要求我们必须具备一定的审美水平，来 Dribble 看看吧，你会重新燃起创造力的激情，比如用 WEB 技术实践几个 Driible 的原型图，那一定帅得不行不行的。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://csszengarden.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CSS Zen Garden（CSS 禅意花园）&lt;/a&gt;—— 现在网站的效果越来风格化，无论是简约还是拟物都十分精致，相比而言，来自上个年代的 CSS 禅意花园已经显得并不是很出彩了，但实际上其中还有很多重要的东西值得学习，建议各位读一读&lt;a href=&quot;http://book.douban.com/subject/2052176/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt; CSS 禅意花园&lt;/a&gt;这本书，看一下作者对各个主题的分析，了解从设计立意到编码开发的诸多思考。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下面这些网站的内容大都涵盖了从 WEB 到设计、从图形到动效、从数据到运维的方方面面，是非常全面的技术站点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://dzone.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;DZone&lt;/a&gt; —— Programming, Web Development, and DevOps news, tutorials and tools for beginners to experts. Hundreds of free publications, over 1M members, totally free.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.smashingmagazine.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Smashing Magazine&lt;/a&gt; —— Smashing Magazine is an online magazine for professional Web designers and developers, with a focus on useful techniques, best practices and valuable resources.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.sitepoint.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;SitePoint&lt;/a&gt; —— Learn Web Design &amp;amp; Development with SitePoint tutorials, courses and books - HTML5, CSS3, JavaScript, PHP, mobile app development, Responsive Web Design.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.codeproject.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CodeProject&lt;/a&gt; —— Free source code and tutorials for Software developers and Architects.; Updated: 2 Jan 2016.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文总结自 Quora 上的一个问答：&lt;a href=&quot;https://www.quora.com/What-are-the-top-10-websites-a-web-developer-must-see&quot;&gt;What are the top 10 websites a web developer must see&lt;/a&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;读专业书、看教程视频、浏览技术博客、参加讲座分享……这些提高技能的途径各有优劣，相比较而言，博客或者说技术网站可以最快接触前沿技术、分享技术实践，所以，除了依赖谷歌反馈的词条，我们还可以主动收集一些优秀的技术站点，便于自己了解、参与和实践业界最活跃的技术。&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Mac Tool Kit</title>
    <link href="http://pinggod.com/2015/mac-tool-kit/"/>
    <id>http://pinggod.com/2015/mac-tool-kit/</id>
    <published>2015-12-26T10:17:00.000Z</published>
    <updated>2016-03-13T15:55:00.000Z</updated>
    
    <content type="html">&lt;p&gt;这会是一篇持续更新的文章，用于记录我在 mac 中常用的开发工具。过去的一年（2015）里，我使用 mac 作为开发的主力平台，在上面折腾过各类软件，以实现最高的开发效率和最舒适的开发环境。一切都是为了开发成果服务，脱离结果强调过程不是我支持的态度，简而言之，这些都是一些增益技巧。&lt;/p&gt;
&lt;p&gt;文中工具的排序规则（核心是优先安装具有依赖关系的软件）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;从常用工具中随机选择一个工具作为 random seed&lt;/li&gt;
&lt;li&gt;根据 random seed 的配置过程进行上溯，上溯到的目标工具排在 random seed 之前&lt;/li&gt;
&lt;li&gt;如果上溯到的系统工具不常用，以常用工具替换，比如 chrome 替换 safari&lt;/li&gt;
&lt;li&gt;random seed 可组合使用的工具排在 random seed 之后&lt;/li&gt;
&lt;li&gt;random seed 中包含的插件在 random seed 中以列表的形式列出&lt;/li&gt;
&lt;li&gt;每次接触新工具，将 random seed 设为该工具，循环执行 2、3、4 过程&lt;/li&gt;
&lt;li&gt;其他工具根据肌肉对键盘的非条件反射随机排列&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;/img/mac-tool-kit.png&quot; alt=&quot;mac tool kit 排列方法 2015-12-27.png&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;preparation&quot;&gt;&lt;a href=&quot;#preparation&quot; class=&quot;headerlink&quot; title=&quot;preparation&quot;&gt;&lt;/a&gt;preparation&lt;/h2&gt;&lt;p&gt;在选择下文中的工具时，主要有两点参考标准：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;快速，指响应速度和切换速度，或者可以提高这两点的工具。目前键盘操作是无冲突下最快速的控制方式，所以这也是围绕速度进行评估的关键点。&lt;/li&gt;
&lt;li&gt;界面有设计亮点，这纯属前端职业病&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;    初始化 mac 之后，依次进入系统偏好设置 -&amp;gt; 键盘 -&amp;gt; 修饰键，将 Caps Lock 键映射为 Control 键，别问为什么，用心去体会吧 —— Casp Lock 的功能价值与它在键盘布局中所占有的重要位置极度不相符。&lt;br&gt;&lt;/div&gt;

&lt;h2 id=&quot;applications-list&quot;&gt;&lt;a href=&quot;#applications-list&quot; class=&quot;headerlink&quot; title=&quot;applications list&quot;&gt;&lt;/a&gt;applications list&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://www.iterm2.com/downloads.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;iTerm2&lt;/a&gt;，终端工具，替代系统自带的终端，主题 &lt;a href=&quot;https://github.com/zenorocha/dracula-theme&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;dracula-theme&lt;/a&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Xcode command Line Tool，Homebrew 的依赖，可通过 &lt;code&gt;xcode-select --install&lt;/code&gt; 命令或者安装 Xcode 来完成&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/Flowerowl/ici&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ici&lt;/a&gt;，终端词典，基于爱词霸词库 &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://developer.apple.com/cn/xcode/downloads/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Xcode&lt;/a&gt;，苹果产品开发环境，&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://brew.sh/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Homebrew&lt;/a&gt;，OS X 的包管理工具：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/creationix/nvm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nvm&lt;/a&gt;，node 版本管理工具&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/nodejs/node&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;node&lt;/a&gt;，运行在服务端的 JavaScript，使用 nvm 统一管理&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tmux.github.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;tmux&lt;/a&gt;，终端复用工具&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://mama.indstate.edu/users/ice/tree/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;tree&lt;/a&gt;，树状结构目录&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.python.org&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;python / python3&lt;/a&gt;，python 开发环境&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://nginx.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nginx&lt;/a&gt;，反向代理服务器&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/jakubroztocil/httpie&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;httpie&lt;/a&gt;，替代 curl 的 HTTP 终端工具&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://asciinema.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;asciinema&lt;/a&gt;，终端录屏工具&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://caskroom.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Homebrew Cask&lt;/a&gt;，使用 hombrew 安装，可用于安装 OS X 应用：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://caskroom.io/search&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;haskell platform&lt;/a&gt;，haskell 开发环境&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.google.cn/intl/zh-CN/chrome/browser/desktop/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Chrome / Chrome Canary&lt;/a&gt;，插件众多，开发调试便利，平时也比较依赖谷歌体系内的东西。插件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://chrome.google.com/webstore/detail/github-old-header/bbencfiifelhglgknaheifiekmjndlek&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub Old Header&lt;/a&gt;，在顶部导航区提供一个指向个人页面的链接&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chrome.google.com/webstore/detail/http-status/cknfnacbckhfpjahnmkblajcpledpfnp&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HTTP status&lt;/a&gt;，在地址栏显示 HTTTP 状态码&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chrome.google.com/webstore/detail/json-formatter/bcjindcccaagfpapjjmafapmmgkkhgoa?hl=zh-CN&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JSON Formatter&lt;/a&gt;，格式化浏览器预览到的 JSON 数据&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chrome.google.com/webstore/detail/octotree/bkhaagjahfmjljalopjnoealnfndnagc?hl=zh-CN&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Octotree&lt;/a&gt;，为 GitHub 仓库提供一个树状结构目录&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://chrome.google.com/webstore/detail/save-to-pocket/niloccemoadcdkdjlinkgdfekeahmflj?hl=zh-CN&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Save to Pocket&lt;/a&gt;，右键保存到 Pocket&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.sublimetext.com/3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Sublime Text 3&lt;/a&gt;，编辑器，适用多平台响应迅速扩展能力强。插件：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/installation#st3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Package Control&lt;/a&gt;，Sublime 扩展插件的安装和管理工具&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/DashDoc&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;DashDoc&lt;/a&gt;，调用 Dash&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://emmet.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Emmet&lt;/a&gt;，前端开发工具集&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/BracketHighlighter&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BracketHighlighter&lt;/a&gt;，标签和符号的高亮工具&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/SideBarEnhancements&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;SideBarEnhancements&lt;/a&gt;，侧边栏功能扩展插件&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/equinusocio/material-theme&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Material Theme&lt;/a&gt;，谷歌 material 风格的简洁主题&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/Babel&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Babel&lt;/a&gt;，JSX 和 ES6 的高亮插件，不具有编译功能&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/DocBlockr&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;DocBlockr&lt;/a&gt;，Javascript, PHP, CoffeeScript, Actionscript, C &amp;amp; C++ 规范化注释&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://kapeli.com/dash&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Dash&lt;/a&gt;，开发文档、代码片段管理工具&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://www.alfredapp.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;alfred&lt;/a&gt;，必备辅助工具，提高工作效率，不要让双手离开键盘&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://getpocket.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Pocket&lt;/a&gt;，离线阅读工具，也被用来做知识管理&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://snip.qq.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Snip&lt;/a&gt;，滚动截屏必备工具&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://realmacsoftware.com/ember/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Ember&lt;/a&gt;，图库管理，可以订阅 dribbble popular。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://products.office.com/zh-cn/mac/microsoft-office-for-mac&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Microsoft office&lt;/a&gt;，我喜欢用 PowerPoint 来做流程图、序列图……&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.irradiatedsoftware.com/sizeup/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;SizeUp&lt;/a&gt;，管理应用程序窗口的位置和大小&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;host-configuration&quot;&gt;&lt;a href=&quot;#host-configuration&quot; class=&quot;headerlink&quot; title=&quot;host configuration&quot;&gt;&lt;/a&gt;host configuration&lt;/h2&gt;&lt;p&gt;最近在熟悉云主机的使用，下面是配置过程：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;ssh root 账号登录云主机，通过 &lt;code&gt;passwd&lt;/code&gt; 命令更改主机密码，至于怎样设置结构复杂的密码，建议参考文章&lt;a href=&quot;http://www.hello-code.com/diary/201409/2223.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《每一个程序员都有一颗当诗人的心》&lt;/a&gt;。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;使用 root 账号创建普通用户：&lt;code&gt;adduser sean&lt;/code&gt;、&lt;code&gt;passwd sean&lt;/code&gt;，然后为新用户配置权限，通过 &lt;code&gt;visudo&lt;/code&gt; 命令添加 &lt;code&gt;sean ALL=(ALL) ALL&lt;/code&gt; 配置信息，完成后退出 root 账户，使用普通账户登录云主机，比如这里的 sean。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;安装常用工具：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/robbyrussell/oh-my-zsh&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;oh-my-zsh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/amix/vimrc&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;amix/vimrc&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/bling/vim-airline&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;bling/vim-airline&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/powerline/fonts&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;powerline/fonts&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/creationix/nvm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nvm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/nodejs/node&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;node&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/tldr-pages/tldr&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;node:tldr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packages.debian.org/search?keywords=tree&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;apt-get:tree&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;tldr&quot;&gt;&lt;a href=&quot;#tldr&quot; class=&quot;headerlink&quot; title=&quot;tldr&quot;&gt;&lt;/a&gt;tldr&lt;/h2&gt;&lt;p&gt;不断地在中英文间进行切换也是非常低效率的操作，所以，初步设定在 2016 年底脱离非业务开发下对中文输入的依赖——不过我最喜欢的哲学思维还是先秦百家交叉融汇出的框架。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;这会是一篇持续更新的文章，用于记录我在 mac 中常用的开发工具。过去的一年（2015）里，我使用 mac 作为开发的主力平台，在上面折腾过各类软件，以实现最高的开发效率和最舒适的开发环境。一切都是为了开发成果服务，脱离结果强调过程不是我支持的态度，简而言之，这些都是一些增益技巧。&lt;/p&gt;
&lt;p&gt;文中工具的排序规则（核心是优先安装具有依赖关系的软件）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;从常用工具中随机选择一个工具作为 random seed&lt;/li&gt;
&lt;li&gt;根据 random seed 的配置过程进行上溯，上溯到的目标工具排在 random seed 之前&lt;/li&gt;
&lt;li&gt;如果上溯到的系统工具不常用，以常用工具替换，比如 chrome 替换 safari&lt;/li&gt;
&lt;li&gt;random seed 可组合使用的工具排在 random seed 之后&lt;/li&gt;
&lt;li&gt;random seed 中包含的插件在 random seed 中以列表的形式列出&lt;/li&gt;
&lt;li&gt;每次接触新工具，将 random seed 设为该工具，循环执行 2、3、4 过程&lt;/li&gt;
&lt;li&gt;其他工具根据肌肉对键盘的非条件反射随机排列&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;/img/mac-tool-kit.png&quot; alt=&quot;mac tool kit 排列方法 2015-12-27.png&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>ES2015</title>
    <link href="http://pinggod.com/2015/ES2015/"/>
    <id>http://pinggod.com/2015/ES2015/</id>
    <published>2015-12-15T06:07:10.000Z</published>
    <updated>2016-02-01T01:01:27.000Z</updated>
    
    <content type="html">&lt;p&gt;ES2015 是最新的 JavaScript 语法规范，也是前端工程化高速发展所催化出的产物。JS 的不成熟一直为人诟病，前端的高速发展又离不开 JS，所以这次激进的变革显得十分必要。&lt;/p&gt;
&lt;p&gt;虽然 ES2015 规范发布了，但是要原生的运行在浏览器上还是受到诸多因素的肘制，比如各版本浏览器的用户量、浏览器厂商对新特性的支持度等等。目前的权宜之计是使用 Babel 之类的编译器将 ES2015 代码转换为 ES5，所以下文中的 ES2015 代码也暂时以 Babel 的解析结果为准。各版本浏览器对 ES2015（ES6）、ES2016（ES7）的支持度可以参考这里：&lt;a href=&quot;http://kangax.github.io/compat-table/es6/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ES2015 兼容性列表&lt;/a&gt;。&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;块级作用域和变量声明&quot;&gt;&lt;a href=&quot;#块级作用域和变量声明&quot; class=&quot;headerlink&quot; title=&quot;块级作用域和变量声明&quot;&gt;&lt;/a&gt;块级作用域和变量声明&lt;/h2&gt;&lt;p&gt;ES6 新增了以花括号 &lt;code&gt;{}&lt;/code&gt; 为标志的块级作用域，用以增强代码的稳健性。在 ES6 之前，JS 中只有全局作用域和函数作用域（eval 作用域？我没用过），这种设计有多种弊端，比如最常见的循环变量泄露为全局变量：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;; i++ ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a[i] = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;虽然循环结束了，但是 i 的值在全局作用域内仍然有效，进而形成了一系列的错误。对于这种错误，最常见的处理方式是使用立即执行函数（Immediately-Invoked Function Expression）：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; a = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;; i++ ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a[i] = (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;i&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)(i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这里用到的立即执行函数实际上是将&lt;a href=&quot;http://pinggod.com/2015/%E6%B1%82%E5%80%BC%E7%AD%96%E7%95%A5/&quot;&gt;求值策略&lt;/a&gt;从延迟求值转变为了预先求值，但仍然不够优雅和健壮。在 ES2015 中，通过使用 &lt;code&gt;let&lt;/code&gt; 来声明循环变量同样可以解决这个问题，而且方式更加简洁：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; a = [];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;; i++ ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a[i] = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(a[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;let&lt;/code&gt; 和 &lt;code&gt;const&lt;/code&gt; 是 ES2015 新增的变量声明指令：let 用来声明变量，const 用来声明常量。当使用 let 和 const 声明变量时，所声明的变量只在当前的块级作用域内有效，这一点是与 var 的本质差别，也是上述代码生效的基础。对于 var 时代的各种诡异特性，现在 let 和 const 做了一些修改：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;let 和 const 声明的变量不存在变量提升&lt;/li&gt;
&lt;li&gt;let 和 const 声明的变量不允许在同一作用域内重复声明多次&lt;/li&gt;
&lt;li&gt;let 和 const 声明的变量必须先声明后使用，否则抛出 ReferenceError&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;从块级作用域的开始到 let 和 const 变量声明的区域被称为临时死区（temporal dead zone），意指此处调用未声明的 let 和 const 变量一定报错：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    temp = &lt;span class=&quot;string&quot;&gt;&#39;abc&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// blablablabla&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 该行代码之前都属于变量 temp 的 temporal dead zone&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 意指在此之前不可使用变量 temp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; temp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;    在浏览器环境下，使用 var 声明的全局变量都会挂载在全局对象 window 下面。ES 2015 规定，使用 var 和 function 声明的全局变量仍然挂载在全局对象下面，但是 let、const 和 class 声明的全局变量则不属于全局对象。&lt;br&gt;&lt;/div&gt;


&lt;h2 id=&quot;解构赋值&quot;&gt;&lt;a href=&quot;#解构赋值&quot; class=&quot;headerlink&quot; title=&quot;解构赋值&quot;&gt;&lt;/a&gt;解构赋值&lt;/h2&gt;&lt;p&gt;解构赋值是 ES2015 提供的一种语法糖操作，常用于简化对数组和对象的数据提取。可以使用解构赋值的数据类型包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对象&lt;/li&gt;
&lt;li&gt;字符串&lt;/li&gt;
&lt;li&gt;数值和布尔值（自动转换为对象，然后调用 toString() ）&lt;/li&gt;
&lt;li&gt;数组，以及具有 Iterator 结构的数据结构，比如 Set 等&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下面我们通过一些实例来看一下解构赋值的使用方式：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 1. 交换两个数的值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[x, y] = [y, x]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 2. 提取 JSON 数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt; = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    id: &lt;span class=&quot;number&quot;&gt;12345&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    status: &lt;span class=&quot;string&quot;&gt;&#39;OK&#39;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    data: [&lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;456&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &amp;#123; id, status, data &amp;#125; = &lt;span class=&quot;built_in&quot;&gt;JSON&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 3. 按需加载模块&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &amp;#123; Route, DefaultRoute, HistoryLocation &amp;#125; = ReactRouter; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 4. 从函数返回多个值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;handleStyle&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)  &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; font = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; border = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; position = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123; font, border, position &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    font: fontStyle,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    border: borderStyle,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    position: positionStyle&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; = handleStyle();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;解构赋值可以以 &lt;code&gt;[x = &amp;#39;0&amp;#39;] = [y]&lt;/code&gt; 的形式设置默认值，当 y 不存在时，x 的值就是 0；如果 y 不存在且没有设置默认值，则会被自动赋值为 undefined。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;字符串&quot;&gt;&lt;a href=&quot;#字符串&quot; class=&quot;headerlink&quot; title=&quot;字符串&quot;&gt;&lt;/a&gt;字符串&lt;/h2&gt;&lt;p&gt;在 JS 内部，字符以 16 位 2 字节的格式存储，这种表示法的范围限制为 \u0000-\uFFFF，对于超出范围的字符（\u20BB7），会被解析为两个字符四个字节（\u20BB\u0007）。ES2015 增强了对 Unicode 的支持，提出了一种新的字符表示方法：\u{20BB7}。&lt;/p&gt;
&lt;p&gt;对于新的字符表示形式 &lt;code&gt;\u{codePoint}&lt;/code&gt;，传统的字符串方法已经不适用了，所以 ES2015 提出了一系列新的方法来替代，它们可以正确识别编码大于 \uFFFF 的字符：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;at()，对应 charAt()，返回指定位置的字符&lt;/li&gt;
&lt;li&gt;codePointAt()，对应 charCodeAt()，返回指定位置字符的编码&lt;/li&gt;
&lt;li&gt;String.fromCodePoint()，对应 String.fromCharCode()，返回指定编码所对应的字符&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u20BB7&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;₻7&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u&amp;#123;20BB7&amp;#125;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;𠮷&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u&amp;#123;20BB7&amp;#125;&#39;&lt;/span&gt;.charAt(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;�&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u&amp;#123;20BB7&amp;#125;&#39;&lt;/span&gt;.at(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)       &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &quot;𠮷&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u&amp;#123;20BB7&amp;#125;&#39;&lt;/span&gt;.codePointAt(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;).toString(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 20BB7&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u&amp;#123;20BB7&amp;#125;&#39;&lt;/span&gt;.codePointAt(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;).toString(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; DFB7&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;\u&amp;#123;20BB7&amp;#125;&#39;&lt;/span&gt;.charCodeAt(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;).toString(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; DFB7&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;a\u&amp;#123;20BB7&amp;#125;b&#39;&lt;/span&gt;.length&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.from(&lt;span class=&quot;string&quot;&gt;&#39;a\u&amp;#123;20BB7&amp;#125;b&#39;&lt;/span&gt;).length&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ES2015 规范中规定字符串实现了 Iterator 接口，用于 for … of 遍历，此外，增加了一些工具类方法：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; str = &lt;span class=&quot;string&quot;&gt;&quot;abcdefghi&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 判断字符串 str 是否以参数字符串开头&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;str.startsWith(&lt;span class=&quot;string&quot;&gt;&#39;abc&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 判断字符串 str 是否包含参数字符串&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;str.includes(&lt;span class=&quot;string&quot;&gt;&#39;def&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 判断字符串 str 是否以参数字符串结尾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;str.endsWith(&lt;span class=&quot;string&quot;&gt;&#39;ghi&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 生成重复字符串&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;x&#39;&lt;/span&gt;.repeat(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;xxx&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;字符串的另一个强力扩展是：模板字符串和标签模板。模板字符串（template string）类似于其他编程语言中的字符串插值，以反引号（`）为标志，字符串中的插值部分使用 &lt;code&gt;${}&lt;/code&gt; 包裹：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; x = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; y = &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;`&lt;span class=&quot;subst&quot;&gt;$&amp;#123;x&amp;#125;&lt;/span&gt; + &lt;span class=&quot;subst&quot;&gt;$&amp;#123;y&amp;#125;&lt;/span&gt; = &lt;span class=&quot;subst&quot;&gt;$&amp;#123;x + y&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;3 + 4 = 7&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果一个函数的函数名之后紧跟一个模板字符串，那么这个函数就会被用来处理这个模板字符串，这个功能被称为&lt;code&gt;标签模板（tagged template）&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 第一个参数是一个数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 数组的元素是被插值部分分隔的字符串&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 第二个及以后的参数代表模板字符串中插值部分的值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 可以使用参数扩展语法将其包裹到一个变量中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tag&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;strs, ...values&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(strs);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(values);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; x = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; y = &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tag&lt;span class=&quot;string&quot;&gt;`&lt;span class=&quot;subst&quot;&gt;$&amp;#123;x&amp;#125;&lt;/span&gt; + &lt;span class=&quot;subst&quot;&gt;$&amp;#123;y&amp;#125;&lt;/span&gt; = &lt;span class=&quot;subst&quot;&gt;$&amp;#123;x + y&amp;#125;&lt;/span&gt;`&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [&quot;&quot;,&quot; + &quot;,&quot; = &quot;,&quot;&quot;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [3,4,7]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;标签模板的一个实际运用就是过滤 HTML 字符串，提高安全性：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;safeHTML&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;strs, ...values&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; result = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    strs.forEach( (str, index) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; temp = &lt;span class=&quot;built_in&quot;&gt;String&lt;/span&gt;(values[index]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        result += str;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( temp ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            result += temp.replace(&lt;span class=&quot;regexp&quot;&gt;/&amp;amp;/g&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;amp;&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                          .replace(&lt;span class=&quot;regexp&quot;&gt;/&amp;lt;/g&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;$lt;&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                          .replace(&lt;span class=&quot;regexp&quot;&gt;/&amp;gt;/g&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;&amp;amp;gc;&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; user = &lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;html tag&amp;gt;&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; msg = safeHTML&lt;span class=&quot;string&quot;&gt;`&amp;lt;p&amp;gt;&lt;span class=&quot;subst&quot;&gt;$&amp;#123;user&amp;#125;&lt;/span&gt; has sent you a msg.&amp;lt;/p&amp;gt;`&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &amp;lt;p&amp;gt;$lt;html tag&amp;amp;gc; has sent you a msg.&amp;lt;/p&amp;gt;undefined&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;数值&quot;&gt;&lt;a href=&quot;#数值&quot; class=&quot;headerlink&quot; title=&quot;数值&quot;&gt;&lt;/a&gt;数值&lt;/h2&gt;&lt;p&gt;数值部分，一个是在 Number 对象上丰富了一些工具函数&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nubmer.isNaN()&lt;/li&gt;
&lt;li&gt;Number.isFinite()&lt;/li&gt;
&lt;li&gt;Number.parseInt()&lt;/li&gt;
&lt;li&gt;Nubmer.parseFloat()&lt;/li&gt;
&lt;li&gt;Nnmber.isInteger()&lt;/li&gt;
&lt;li&gt;Number.EPSILON，极小量常量，在数值比对时，如果小于极小量，则判断两数相等&lt;/li&gt;
&lt;li&gt;Number.isSafeInteger()，安全范围指（-2^53，2^53）&lt;/li&gt;
&lt;li&gt;Number.MAX_SAFE_INTEGER&lt;/li&gt;
&lt;li&gt;Number.MIN_SAFE_INTEGER&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Number&lt;/span&gt;.isNaN(&lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Number&lt;/span&gt;.isFinite(&lt;span class=&quot;literal&quot;&gt;Infinity&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Number&lt;/span&gt;.isInteger(&lt;span class=&quot;number&quot;&gt;1.0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.parseFloat === &lt;span class=&quot;built_in&quot;&gt;Number&lt;/span&gt;.parseFloat&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;window&lt;/span&gt;.parseInt === &lt;span class=&quot;built_in&quot;&gt;Number&lt;/span&gt;.parseInt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 0.30000000000000004&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt; === &lt;span class=&quot;number&quot;&gt;0.3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0.1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;0.2&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;0.3&lt;/span&gt; &amp;lt; &lt;span class=&quot;built_in&quot;&gt;Number&lt;/span&gt;.EPSILON&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;二是在 Math 对象上扩展了一些数学函数：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Math.trunc()，去除浮点数的小数部分&lt;/li&gt;
&lt;li&gt;Math.sign()，判断数值是正数、负数还是零&lt;/li&gt;
&lt;li&gt;Math.cbrt()，计算一个数值的立方根&lt;/li&gt;
&lt;li&gt;Math.clz32()，返回一个数值的 32 位无符号整数形式前前导零的个数&lt;/li&gt;
&lt;li&gt;Math.imul()&lt;/li&gt;
&lt;li&gt;Math.fround()&lt;/li&gt;
&lt;li&gt;Math.hypot()&lt;/li&gt;
&lt;li&gt;Math.expn1()&lt;/li&gt;
&lt;li&gt;Math.log1p()&lt;/li&gt;
&lt;li&gt;Math.log10()&lt;/li&gt;
&lt;li&gt;Math.log2()&lt;/li&gt;
&lt;li&gt;Math.sinh()&lt;/li&gt;
&lt;li&gt;Math.cosh()&lt;/li&gt;
&lt;li&gt;Math.tanh()&lt;/li&gt;
&lt;li&gt;Math.asinh()&lt;/li&gt;
&lt;li&gt;Math.acosh()&lt;/li&gt;
&lt;li&gt;Math.atanh()&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.trunc(&lt;span class=&quot;number&quot;&gt;3.1415926&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.cbrt(&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.hypot(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.log10(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.log2(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;数组&quot;&gt;&lt;a href=&quot;#数组&quot; class=&quot;headerlink&quot; title=&quot;数组&quot;&gt;&lt;/a&gt;数组&lt;/h2&gt;&lt;p&gt;在函数中，参数对象 arguments 是一个具有 length 属性的对象，这一类对象被称为类数组对象（array-like object），常见的类数组对象包括 arguments 对象和 DOM 操作返回的 NodeList 集合，对于此类类数组对象，我们往往希望可以将其转换为数组，方便调用数组的方法对数据进行处理。在 ES6 中有一个方法专门用于转换类数组对象为真正的数组：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123; &lt;span class=&quot;string&quot;&gt;&#39;0&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, length: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; arr = &lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.from(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(arr);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ &quot;a&quot;, undefined ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从上面的代码可知，对象中的 length 属性确定了转换后数组的长度，索引不匹配的位置返回 undefined，此外 Array.from() 还接受第二个参数，用于对 obj 数据进行 map 处理。此外，对于 ES6 新增的 Set 和 Map 数据结构，也可以使用 Array.from() 转换为数组。&lt;/p&gt;
&lt;p&gt;在前面我们遇到了字符串编码大于 \uFFFF 时，字符长度会被误判的问题，这种情况下可以使用 Array.from() 将字符串转换为数组，获取数组的长度：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&quot;𠮷&quot;&lt;/span&gt;.length&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.from(&lt;span class=&quot;string&quot;&gt;&quot;𠮷&quot;&lt;/span&gt;).length;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt;  1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;数组的构造函数 Array() 一直存在行为不确定的问题（一个参数表示新建数组长度，多个参数表示新建数组的组成元素），对此 ES6 提出了 Array.of() 方法来构建数组。Array.of() 方法接收任意多个参数，这些参数就是返回数组的元素：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.of(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, &amp;#123;&amp;#125;, [], &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 1, &quot;a&quot;, Object, Array[0], Symbol() ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在众多的数组方法中，有那么一类方法非常值得警惕，这类方法的危险性在于，它们可以修改数组自身的数据，常见方法有：&lt;strong&gt;pop() / push() / shift() / unshift() / reverse() / sort() / splice()&lt;/strong&gt;。在 ES6 中也存在两个可以修改数组自身的方法：copyWithin() 和 fill()：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// copyWithin(arrayStart[, copyStart, copyEnd])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// arrayStart: 从数组的该位置开始修改数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// copyStart: 从数组的该位置开始取数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// copyEnd: 从数组的该位置停止取数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;].copyWithin(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 4, 2, 3, 4, 5 ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// fill(num, start, end) 方法可以用于数据重置&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;].fill(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 1, 2, 3, 0, 5 ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;新增的 find() 和 some() 类似，都需要一个回调函数对遍历到的元素进行判断，不同点在于，find() 返回符合条件的第一个值，some() 则是在遇到复合条件的元素时返回 true；另一个新增的 findIndex() 与 indexOf() 类似，用于在数组中查找特定值的索引，不同之处在于 findIndex() 接收一个回调函数，indexOf() 接收的是一个值，此外，findIndex() 配合 Object.is 可以发现 NaN：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;].indexOf(y =&amp;gt; &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.is(&lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;, y))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; -1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;].findIndex(y =&amp;gt; &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.is(&lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;, y))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;此外，我们还可以使用 includes() 方法来判断是否存在：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;].includes(&lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对于数组的遍历，ES6 提供了更精细的方法 entries() / keys() / values()，分别是对键值对、键和值的遍历：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; key &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;].keys() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(key);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; value &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;].values()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(value);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;a&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;b&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [key, value] &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; [&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;].entries()) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log([key, value]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 0, &quot;a&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 1, &quot;b&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;最后，值得一提的是，babel 编译已经支持了数组推导式（ES7），这一推到式在 Haskell 和 python 中都有实现：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; years = [ &lt;span class=&quot;number&quot;&gt;1954&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1974&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1990&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2006&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2010&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2014&lt;/span&gt; ];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; array = [ &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( year &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; years ) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( year &amp;gt; &lt;span class=&quot;number&quot;&gt;1990&lt;/span&gt; ) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( year &amp;lt; &lt;span class=&quot;number&quot;&gt;2014&lt;/span&gt; ) year ];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(array);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 2006, 2010 ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;函数&quot;&gt;&lt;a href=&quot;#函数&quot; class=&quot;headerlink&quot; title=&quot;函数&quot;&gt;&lt;/a&gt;函数&lt;/h2&gt;&lt;p&gt;先看一个示例：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;f&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt; x, y = 2, ...z&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;`x = &lt;span class=&quot;subst&quot;&gt;$&amp;#123;x&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;`y = &lt;span class=&quot;subst&quot;&gt;$&amp;#123;y&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;`z = &lt;span class=&quot;subst&quot;&gt;$&amp;#123;z&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;f(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; x = 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; y = 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; z = 2,3,5,8,13&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;consoel.log(f.length);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个示例中聚合了很多 ES6 在函数方面的特性，第一处是 &lt;code&gt;y = 2&lt;/code&gt;，这种形式定义了函数参数的默认值，所以这里的 y 相当于一个默认值参数；第二处是 &lt;code&gt;...z&lt;/code&gt;，这里的 z 被称为 rest 参数，用于存放函数中多余的参数，该参数往往可以用来替代 arguments 对象，因为它天生就是数组类型；第三处是传参时的 undefined，如果我们想跳过某个参数，需要显示的将该参数赋值为 undefined，使用 null 的话没有效果；第四处就是 func.length，这里的 length 表示普通参数的数量，如果我们测试 arugments.length，会发现结果为 7，因为这里的 arguments.length 表示的是传入参数的数量；最后一处不是很明显，但是很重要，就是普通参数、默认值参数和 rest 参数的位置顺序。&lt;/p&gt;
&lt;p&gt;进一步还可以配合对象解构来传参：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;fetch&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;url, &amp;#123; body = &#39;&#39;, method = &#39;GET&#39;, headers = &amp;#123;&amp;#125; &amp;#125; &lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(method);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fetch(&lt;span class=&quot;string&quot;&gt;&#39;http://meituan.com&#39;&lt;/span&gt;, &amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;GET&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fetch(&lt;span class=&quot;string&quot;&gt;&#39;http://meituan.com&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Cannot read property &#39;body&#39; of undefined&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;第二个 fetch 的问题在于不能省略第二个参数，如果要省略参数，可以设置双重默认值：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;fetch&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;url, &amp;#123; body = &#39;&#39;, method = &#39;GET&#39;, headers = &amp;#123;&amp;#125; &amp;#125; = &amp;#123;&amp;#125; &lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(method);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fetch(&lt;span class=&quot;string&quot;&gt;&#39;http://meituan.com&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;GET&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;rest 参数 &lt;code&gt;...rest&lt;/code&gt; 用于将参数打包成数组，通过扩展运算符 &lt;code&gt;...&lt;/code&gt;，可以执行逆运算，将数组（babel 也支持对类数对象的转换）转换为以分号分隔的参数序列：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;add&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;...rest&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, ...rest, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;add(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [0,1,1,2,3,5,8,13,21]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 实际运用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ES5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.max.apply(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;, [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ES6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Math&lt;/span&gt;.max(...[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接下来是比较亮眼的箭头函数&lt;code&gt;=&amp;gt;&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ES5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; f = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;k, v&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123; k: v &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ES6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; f = (k, v) =&amp;gt; ( &amp;#123; k: v &amp;#125; );&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;看到箭头函数的第一感官就是：简洁。另一个重要的点在于，箭头函数绑定了 this 对象，其特点如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;this 对象的指向是可变，但在箭头函数中，它固定的志向定义时所在的对象，而不是使用时所在的对象&lt;/li&gt;
&lt;li&gt;不可以用于构造函数&lt;/li&gt;
&lt;li&gt;不可以使用 arguments 对象，可以使用 rest 参数代替&lt;/li&gt;
&lt;li&gt;不能用作 Generator 函数，所以不能使用 yield 命令&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout( () =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;id:&quot;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;,&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;foo.call( &amp;#123; id: &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt; &amp;#125; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// id: 42&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;之所以 this 的指向是固定的，根据 babel 的实现来说，是因为箭头函数内并没有 this 对象，无论箭头函数嵌套多少层，它都是指向定时所在的函数：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; () =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; () =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; () =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;id:&quot;&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;foo.call( &amp;#123; id: &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt; &amp;#125; )()()();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// babel 编译结果&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;&quot;use strict&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; _this = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&quot;id:&quot;&lt;/span&gt;, _this.id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;foo.call(&amp;#123; id: &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt; &amp;#125;)()()();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ES7 提出了函数绑定的概念，使用双冒号 &lt;code&gt;::&lt;/code&gt; 来替代 call/apply/bind 的调用，目前 babel 已经支持该特性，双冒号左侧是一个对象，右侧是一个函数，实现以左边对象为上下文对象的右边函数：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123; id: &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;f&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.id);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;obj::f();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 123&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;最后，讲讲尾函数调用的优化问题。在函数式编程中，如果某个函数的最后一步是函数调用过程，那么这一过程就成为尾调用：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;f&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;x&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; g(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 下面的函数并不是尾调用&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;f&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;x&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    g(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 上面示例相当于&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;f&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;x&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    g(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;undefined&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;函数调用过程是不断入栈出栈的过程，由于尾调用是最后一步操作，所以不需要保存外层函数的调用，这被称为尾调用优化，即只保留内层函数的调用帧，这种优化的好处是如果函数都是尾调用，那么就可以优化到每次尾调用都只保留一层调用，大大节省内存，这就是尾调用优化的意义。&lt;/p&gt;
&lt;p&gt;函数调用自身的过程，成为递归，如果尾调用自身，则称为尾递归。下面是一个阶乘函数，没有使用尾递归，最多需要保存 n 个调用记录，复杂度为 O(n)：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;factorial&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;n&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( n === &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; ) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; n * factorial( n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;factorial(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 120&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 使用尾递归改写，只保留一个调用记录，复杂度 O(1)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Babel 检测到尾调用时使用 while 循环执行函数体&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;factorial&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;n, total&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n === &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; total;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; factorial(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, n * total);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;factorial(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 120&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;鉴于尾调用优化的在性能上的良好表现，EMCAScript 明确规定，所有 ECMAScript 的实现都应该实现“尾调用优化”。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;为了确保最后一步调用自身实现尾递归优化，就需要把函数内部用到的变量转换为函数的参数，比如上面的 total，不过这样的处理方式并不容易理解，优化方式有两种，一种是函数柯里化，另一种方式就是使用默认值参数：&lt;br&gt;&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 方式一&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;currying&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;fn, n&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;m&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; fn.call(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, m, n);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;tailFactorial&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;n, total&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n === &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; total;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; tailFactorial(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, n * total);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; factorial = currying(tailFactorial, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;factorial(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 120&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 方式二&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;factorial&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;n, total = 1&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (n === &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; total;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; factorial(n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, n * total);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;factorial(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 120&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;对象&quot;&gt;&lt;a href=&quot;#对象&quot; class=&quot;headerlink&quot; title=&quot;对象&quot;&gt;&lt;/a&gt;对象&lt;/h2&gt;&lt;p&gt;ES6 在编码的简洁性上做了很多工作，比如上面的箭头函数，比如下面的对象声明：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; foo = &lt;span class=&quot;string&quot;&gt;&#39;bar&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123; foo &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 相当于 obj = &amp;#123; foo: foo &amp;#125;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getSth ( x, y ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &amp;#123; x, y &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 相当于 return &amp;#123; x: x, y: y &amp;#125;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 相当于 getSth: function ( x, y ) &amp;#123;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ES2015 新增了一个 Object.is() 方法来比较两个值是否相等，主要解决两方面的问题：一是 &lt;code&gt;==&lt;/code&gt; 比较时的数据类型自动转换，一是 &lt;code&gt;===&lt;/code&gt; 比较时 NaN 不等于自身、&lt;code&gt;+0&lt;/code&gt; 等于 &lt;code&gt;-0&lt;/code&gt; 的问题。Object.is() 实现的原则是：只要两个值一样，就应该相等（Same-value equality）。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;+&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; === &lt;span class=&quot;number&quot;&gt;-0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.is(+&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt; === &lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.is(&lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;, &lt;span class=&quot;literal&quot;&gt;NaN&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;Object.assign(target, source1, source2)&lt;/code&gt; 用于将 source1/source2… 的属性拷贝到 target 中，遇到同名属性自动覆盖：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; target = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; o1 = &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    id: &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    meta: &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        age: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; o2 = &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    meta: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        age: &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.assign(target, o1, o2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;target&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &amp;#123;&quot;id&quot;:123,&quot;meta&quot;:&amp;#123;&quot;age&quot;:2&amp;#125;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;到目前为止，一共有六种方法可以遍历对象的属性：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;for...in&lt;/code&gt;，循环遍历对象自身的和集成的可枚举属性（不包含 Symbol 属性）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;object.keys(obj)&lt;/code&gt;，返回一个数组，包括自身所有可枚举属性（不含 Symbol 属性和继承属性）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertyNames(obj)&lt;/code&gt;，返回一个数组，包含对象自身的所有属性（不含Symbol属性，包括不可枚举属性）&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Object.getOwnPropertySymbols(obj)&lt;/code&gt;，返回一个数组，包含对象自身的所有Symbol属性&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Reflect.ownKeys(obj)&lt;/code&gt;，返回一个数组，包含对象自身的所有属性，包括 Symbol 和不可枚举属性&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Reflect.enumerate(obj)&lt;/code&gt; 返回一个 Iterator 对象，结果与 &lt;code&gt;for...in&lt;/code&gt; 相同&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;以上六种遍历方法，都遵守同样的遍历次序：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;首先遍历所有属性名为数值的属性，按照数字排序。&lt;/li&gt;
&lt;li&gt;其次遍历所有属性名为字符串的属性，按照生成时间排序。&lt;/li&gt;
&lt;li&gt;最后遍历所有属性名为Symbol值的属性，按照生成时间排序。&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Reflect&lt;/span&gt;.ownKeys(&amp;#123; [&lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;()]:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, b:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, a:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// [&#39;2&#39;, &#39;10&#39;, &#39;b&#39;, &#39;a&#39;, Symbol()]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;__proto__&lt;/code&gt; 是一个没有正式规范，被浏览器广泛支持的属性，ES6 提供了新的方法来代替对该属性的操作：&lt;code&gt;Object.setPrototypeOf()&lt;/code&gt; / &lt;code&gt;Object.getPrototypeOf()&lt;/code&gt; / &lt;code&gt;Object.create()&lt;/code&gt;。&lt;/p&gt;
&lt;h2 id=&quot;Symbol&quot;&gt;&lt;a href=&quot;#Symbol&quot; class=&quot;headerlink&quot; title=&quot;Symbol&quot;&gt;&lt;/a&gt;Symbol&lt;/h2&gt;&lt;p&gt;Symbol 是 ES2015 加入的第七种数据类型，它与 undefined/null/boolean/string/number 都是原始数据类型，Symbol 用来实现一种独一无二的值：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s1 = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s2 = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;typeof&lt;/span&gt; s;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;symbol&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s1.toString();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;Symbol(foo)&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s2 === s1;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Symbol 独一无二的特性非常适合作为对象的属性名：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; o = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [s]: &lt;span class=&quot;string&quot;&gt;&#39;Hi&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;o.s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;undefined&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;[s]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;hi&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在对使用 Symbol 作为属性名的对象进行遍历时，Symbol 属性不会出现在 for…in、for…of 循环中，也不会出现在 Object.keys()、Object.getOwnPropertyNames() 的返回值中。虽然如此，Symbol 并不是私有属性，可以通过 Object.getOwnPropertySymbols() 来获取指定对象的所有 Symbol 属性名：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s1 = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s2 = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;baz&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [s1]: &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [s2]: &lt;span class=&quot;string&quot;&gt;&#39;abc&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; ss = &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.getOwnPropertySymbols(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// [ Symbol(foo), Symbol(baz) ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;要获取相同的 Symbol，可以调用系统的 Symbol.for()，该方法接受一个字符串作为参数，它会检测是否存在以该字符串参数名称的 Symbol 值，找到就返回，没有就创建：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s1 = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;.for(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s2 = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;.for(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s1 === s2;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面示例中用作参数的字符串又被成为 Symbol 的 key，使用 Symbol.keyFor() 可以查看这个 key:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s = &lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;.for(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;.keyFor(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;foo&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Proxy-and-Reflect&quot;&gt;&lt;a href=&quot;#Proxy-and-Reflect&quot; class=&quot;headerlink&quot; title=&quot;Proxy and Reflect&quot;&gt;&lt;/a&gt;Proxy and Reflect&lt;/h2&gt;&lt;p&gt;Proxy，顾名思义，用于代替特定对象与外界进行交互的对象，简称代理对象:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Proxy&lt;/span&gt;(obj, &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    get: &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;target, key&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(target);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;`getting &lt;span class=&quot;subst&quot;&gt;$&amp;#123;key&amp;#125;&lt;/span&gt;`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p.xxx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &amp;#123;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;getting xxx&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Proxy 的拦截操作概览：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;get()，拦截属性的读取&lt;/li&gt;
&lt;li&gt;set()，拦截属性的设置&lt;/li&gt;
&lt;li&gt;has()，拦截 propKey in proxy 操作&lt;/li&gt;
&lt;li&gt;deleteProperty()，拦截 delete proxy[propKey] 操作&lt;/li&gt;
&lt;li&gt;enumerate()，拦截 for ( let x in proxy ) 操作&lt;/li&gt;
&lt;li&gt;ownKeys()&lt;/li&gt;
&lt;li&gt;getOwnPropertyDescriptor()&lt;/li&gt;
&lt;li&gt;defineProperty()&lt;/li&gt;
&lt;li&gt;preventExtensions()&lt;/li&gt;
&lt;li&gt;getPrototypeOf()&lt;/li&gt;
&lt;li&gt;isExtensible()&lt;/li&gt;
&lt;li&gt;setPrototypeOf()&lt;/li&gt;
&lt;li&gt;apply()&lt;/li&gt;
&lt;li&gt;construct()&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用 Proxy.revocable() 可以创建一个可撤销拦截的代理对象：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &amp;#123; proxy, revoke &amp;#125; = &lt;span class=&quot;built_in&quot;&gt;Proxy&lt;/span&gt;.revocable(&amp;#123;&amp;#125;, &amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;proxy.foo = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(proxy.foo);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;revoke();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(proxy);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; undefined&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Reflect 对象的设计初衷：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;将 object 对象上明显属于语言内部的方法（Object.defineProperty）放到 Reflect 对象上&lt;/li&gt;
&lt;li&gt;修改某些 Object 对象的返回结果，使其更可控，比如 Object.defineProperty() 在无法定义属性时会抛出错误，而 Reflect.defineProperty() 则会返回 false&lt;/li&gt;
&lt;li&gt;让 Object 操作统一为函数行为，比如 name in obj 和 delete obj[name]，使用 Reflect.has() 和 Reflect.deleteProperty() 来执行&lt;/li&gt;
&lt;li&gt;Reflect 对象的方法和 Proxy 对象的方法一一对应，两者高度统一，方便 Proxy 对象调用对应的 Reflect 方法 —— 不管 Proxy 怎么拦截和修改，总可以在 Reflect 上获取默认行为&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Object 操作对比 Reflect 操作&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.defineProperty(target, prop, attr);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// success&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (e) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// failure&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;built_in&quot;&gt;Reflect&lt;/span&gt;.defineProperty(target, prop, attr)) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// success&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// failure&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Set-and-Map&quot;&gt;&lt;a href=&quot;#Set-and-Map&quot; class=&quot;headerlink&quot; title=&quot;Set and Map&quot;&gt;&lt;/a&gt;Set and Map&lt;/h2&gt;&lt;p&gt;ES2015 提供的 Set 数据结构是数组的一个约束，两者的差别就在于 Set 中没有重复值：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Set 的参数必须实现了 iterator 接口&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; set = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;2&#39;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(set);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 1, 2, &quot;2&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Set 实例绑定的方法可以分为两类：数据操作方法和成员遍历方法：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/es2015-set-methods.png&quot; alt=&quot;set methods&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; set = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set.add(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set.add(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [1, 2]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set.has(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set.delete(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set.clear();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;set&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; []&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 数组去重&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.from(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [1, 2, 3]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在遍历时，由于 Set 结构没有键名，只有键值，所以 keys() 和 values() 的返回值一致：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; set = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([&lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;green&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;blue&#39;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; key &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; set.keys() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(key);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; red&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; green&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; blue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; value &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; set.values() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(value);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; red&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; green&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; blue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [key, value] &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; set.entries() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log([key, value]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [&quot;red&quot;,&quot;red&quot;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [&quot;green&quot;,&quot;green&quot;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [&quot;blue&quot;,&quot;blue&quot;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;下面是一个 Set 结构的实例，用来求取两个 Set 结构的并交差集：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; x = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; y = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 并集&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; union = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([...x, ...y]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 交集&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; intersection = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([...x].filter( x =&amp;gt; y.has(x) ));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 差集&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; diffset = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;([...x].filter( x =&amp;gt; !y.has(x) ));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;WeakSet 结构和 Set 结构相似，也是不重复值的集合，差异在于两个地方：一是 WeakSet 内部的元素只能是对象，二是 WeakSet 内部的对象是弱引用，垃圾回收机制不考虑 WeakSet 中对象的引用计数。&lt;/p&gt;
&lt;p&gt;由于 WeakSet 结构的对象是弱引用，随时可能消失，所以没有 size 属性，也无法进行遍历，只具有 Set 结构中的三个操作方法：add() / delete() / has()。&lt;/p&gt;
&lt;p&gt;Map 结构是对现有 Object 对象的扩展，Object 中的 key 只能是字符串和 Symbol（ES2015 新增），Map 中的 key 可以是任意数据类型：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; map = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Map&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123; id: &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt; &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;map.set(obj, &lt;span class=&quot;string&quot;&gt;&#39;hi&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;map.get(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;hi&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;map.has(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;map.delete(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;map.has(obj);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// key 绑定内存地址&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;map.set(&amp;#123;&amp;#125;, &lt;span class=&quot;string&quot;&gt;&#39;object&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;map.get(&amp;#123;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; undefined&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;下面在 Map 初始化的时候传入一个二维数组创建 Map：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; map = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Map&lt;/span&gt;([&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;one&#39;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;two&#39;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;three&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; key &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; map.keys() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(key);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; value &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; map.values() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(value);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; one&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; two&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; three&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [key, value] &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; map.entries() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log([key, value]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [1,&quot;one&quot;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [2,&quot;two&quot;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [3,&quot;three&quot;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;WeakMap 是弱引用的 Map 结构，而且 WeakMap 只能以对象作为键值，不接受其他类型的值作为键名。&lt;/p&gt;
&lt;h2 id=&quot;Iterator&quot;&gt;&lt;a href=&quot;#Iterator&quot; class=&quot;headerlink&quot; title=&quot;Iterator&quot;&gt;&lt;/a&gt;Iterator&lt;/h2&gt;&lt;p&gt;现在，JS 中表示集合的数据结构包括 String、Array、Object、Map、Set、WeakMap、WeakSet 七种数据结构。Iterator 提供了一种接口，为各种不同的数据结构提供统一的接口，任何数据结构只要部署了 Iterator 结构，就可以完成遍历操作，目前，String、Array、Map 和 Set 是默认部署了该接口的数据结构，Array-like object 可以通过 Array.from() 转换为 Array 使用该接口。&lt;/p&gt;
&lt;p&gt;Iterator 的作用主要有三点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;为数据结构提供统一的访问接口&lt;/li&gt;
&lt;li&gt;使得数据接口的成员可以按照某种次序排列&lt;/li&gt;
&lt;li&gt;供 for…of 使用&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; arr = [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; it = arr[&lt;span class=&quot;built_in&quot;&gt;Symbol&lt;/span&gt;.iterator]();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 1, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 2, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 3, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: undefined, done: true &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;凡是数据结构原生部署了 Symbol.iterator 属性，则具备 Iterator 接口，调用该接口，就可以得到一个遍历器对象。遍历器对象调用 next() 方法一次可以得到数据结构的所有成员，next() 返回一个对象，包括 value 和 done 属性。&lt;/p&gt;
&lt;p&gt;ES6 规定，默认的 Iterator 接口部署在数据结构的 Symbol.iterator 属性上，部署该属性的数据结构都被认为是可遍历的。在某些场合会自动调用遍历器接口：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 解构赋值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[x, y] = [x, y]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 扩展运算符&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[...&lt;span class=&quot;string&quot;&gt;&#39;hello&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ &quot;h&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 其他&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ... of&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.from()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Map&lt;/span&gt;() / &lt;span class=&quot;built_in&quot;&gt;Set&lt;/span&gt;() / &lt;span class=&quot;built_in&quot;&gt;WeakMap&lt;/span&gt;() / &lt;span class=&quot;built_in&quot;&gt;WeakSet&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;.all()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Promis.race()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// yield*&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;gen&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt;* [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; it = gen();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 1, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 2, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 3, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: undefined, done: true &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;遍历语法的发展：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;for 遍历，语法繁琐&lt;/li&gt;
&lt;li&gt;forEach()，不能使用 break、continue、return 退出循环&lt;/li&gt;
&lt;li&gt;for…in，为对象设计，遍历数组时会自动将索引转换为字符串&lt;/li&gt;
&lt;li&gt;for…of，修复上述问题，可以遍历实现 iterator 接口的数据接口，不支持对普通对象的遍历&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; arr = [&lt;span class=&quot;string&quot;&gt;&#39;a&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;b&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;c&#39;&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; key &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; arr ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log([key, arr[key]]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ &quot;0&quot;, &quot;a&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ &quot;1&quot;, &quot;b&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ &quot;2&quot;, &quot;c&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; [key, value] &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; arr.entries() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log([key, value]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 0, &quot;a&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 1, &quot;b&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 2, &quot;c&quot; ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Generator&quot;&gt;&lt;a href=&quot;#Generator&quot; class=&quot;headerlink&quot; title=&quot;Generator&quot;&gt;&lt;/a&gt;Generator&lt;/h2&gt;&lt;p&gt;Generator 函数是 ES2015 提供的一种异步编程解决方案。可以将 Generator 视为一个有限状态机，内部封装了多个状态：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;gen&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; it = gen();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 1, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 2, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 3, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;it.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: undefined, done: true &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Generator 函数返回的遍历器对象需要调用 next 函数才会遍历到下一个内部状态，并且通过函数内部的 yield 命名挂起函数。遍历器对象 next 方法的运行逻辑：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;执行 next 函数，遇到 yield 命令挂起函数的执行，并且返回 yield 命令后表达式的值，作为返回的遍历器对象的 value 属性&lt;/li&gt;
&lt;li&gt;继续执行 next 函数，直到遇到下一个 yield，然后挂起函数&lt;/li&gt;
&lt;li&gt;如果没有再遇到 return，就运行到函数结束。函数结束时如果有 return，返回 return 后面表达式的值作为返回对象的 value 属性&lt;/li&gt;
&lt;li&gt;如果没有 return 表达式，则返回对象的 value 属性为 undefined&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;/img/es2015-generator-yield.png&quot; alt=&quot;es2015-generator-yield&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;gen&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; ret = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; ret;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; g = gen();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 1, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next(&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: true, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: undefined, done: true &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Generator 函数返回的对象都部署了 Iterator 接口 [Symbol.iterator]，所以，我们可以使用 for…of 循环来遍历 Generator 函数，当返回对象的 done 属性为 true 时，循环自动中止：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;gen&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; v &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; gen() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(v);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Generator 返回的对象附带两个方法：throw() 和 return，用于手动抛出异常和结束 Generator 函数。&lt;/p&gt;
&lt;p&gt;如果要在 Generator 函数内调用另外一个 Generator 函数，需要使用 &lt;code&gt;yield*&lt;/code&gt;，实际上如果 yield 后面跟的是一个遍历器对象，都可以使用 &lt;code&gt;yield*&lt;/code&gt; 来解析：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;gen&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt;* [&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 等同于 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// yield 2;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// yield 3;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// yield 4;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; g = gen();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 1, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 2, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 3, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 4, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 5, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: undefined, done: true &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果对象的某个属性是 Generator 函数，形式上有所不同：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    * gen () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; g = obj.gen();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 1, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: 2, done: false &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Object &amp;#123; value: undefined, done: true &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;前面有数组推导，Generator 函数也有推导，Generator 函数推导的优势在于它是惰性求值：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;bigArr&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;1000000&lt;/span&gt;; i++ ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; ret = ( &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ( n &lt;span class=&quot;keyword&quot;&gt;of&lt;/span&gt; bigArr() ) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( n &amp;lt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt; ) n * n );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[...ret]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; [ 0, 1, 4, 9, 16, 25, 36, 49, 64, 81 ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;下面是使用 Generator 函数实现的一个状态机：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;gen&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt;( &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; _;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;on&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; _;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;off&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; g = gen();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// on&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// off&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;g.next()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// on&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;JS 解析引擎是单线程，只能保持一个调用栈，为了保持多个任务独立的调用栈，引入了协程。Generator 函数是 ES2015 对协程的实现，但不是完整的实现，完整的协程应该可以通过任何函数实现暂停，但是只有 Generator 函数的调用者才能结束 Generator 函数。&lt;/p&gt;
&lt;p&gt;如果将 Generator 函数当做协程，可以将多个需要写作的任务都写成 Generator 函数，使用 yield 命令交换控制权。&lt;/p&gt;
&lt;h2 id=&quot;Promise&quot;&gt;&lt;a href=&quot;#Promise&quot; class=&quot;headerlink&quot; title=&quot;Promise&quot;&gt;&lt;/a&gt;Promise&lt;/h2&gt;&lt;p&gt;在 ES2015 之前，Promise 早有实现，ES2015 规范统一了 Promise 的用法。Promise 对象共有三个状态：Pending、Resolved 和 Rejected。Promise 对象的状态只能从 Pending 变为 Resolved 或者从 Pending 变为 Rejected。&lt;/p&gt;
&lt;p&gt;Promise 对象存在的价值是将异步操作以同步操作的流程表达出来，避免层层嵌套的回调函数，并且提供了统一的接口，便于控制异步操作。不过，Promise 也存在一些缺点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;创建后立即执行，无法中途取消&lt;/li&gt;
&lt;li&gt;如果不设置回调函数，无法抛出内部错误&lt;/li&gt;
&lt;li&gt;处于 Pending 状态时，无法获得具体状态（刚刚开始还是即将完成）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ES2015 规定，Promise 对象是一个构造函数，用于生成 Promise 实例：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;( (resolve, reject) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    setTimeout(resolve, &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;done&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p.then((value) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(value);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 1000ms 后&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;done&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Promise 实例具有两个方法：then(resolved，rejected) 和 catch()。catch() 相当于是 &lt;code&gt;.them(null, rejected)&lt;/code&gt; 的缩写，用于指定发生错误时的回调函数。&lt;/p&gt;
&lt;p&gt;Promise 对象本身还有四个方法：all()、race()、resolve()、reject()。Promise.all() 方法接收包含多个 Promise 实例的一个数组，打包封装成一个 Promise 实例：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;.all([p1, p2, p3]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// p 的状态取决于 p1、p2、p3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// p1、p2、p3 全部 resolved 时，p resolved&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// p1、p2、p3 有一个 rejected，p rejected&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Promise.race() 同样打包多个返回一个 Promise 实例：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;.race([p1, p2, p3]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 与 Promise.all() 的不同之处在于，&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// p 的状态取决于 p1、p2、p3 中状态最先发生变化的那个&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Promise.resolve() 方法用于将现有对象转换为 Promise 对象；Promise.reject() 方法返回一个 Promise 实例，该实例的默认状态就是 rejected。&lt;/p&gt;
&lt;p&gt;ES2015 的 Promise API 并不是很多，可以根据自己的开发需要部署特定的方法，比如我们可以部署两个比较常用的方法：done() 和 finally()。Promise 实例以 then() 或 catch() 方法作为结尾方法时，如果结尾方法抛出错误，是有可能无法捕捉到的，所以可以实现一个 done 方法置于回调链的结尾，保证抛出的任何方法都能被捕获：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;.prototype.done = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;onFulfilled, onRejected&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.then(onFulfilled, onRejected)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .catch(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;reason&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 抛出一个全局错误&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            setTimeout(() =&amp;gt; &amp;#123; &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; reason &amp;#125;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;finally() 方法用于指定回调链的最终操作，与 done 方法的区别在于，它接受一个普通的回调函数作为参数：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 服务器使用 Promise 处理请求，使用 finally 关掉服务器&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;server.listen(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    .then(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    .finally(server.stop);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;.prototype.finally = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;callback&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; P = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.constructor;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.then(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        value  =&amp;gt; P.resolve(callback()).then(() =&amp;gt; value),&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        reason =&amp;gt; P.resolve(callback()).then(() =&amp;gt; &amp;#123; &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; reason &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Async&quot;&gt;&lt;a href=&quot;#Async&quot; class=&quot;headerlink&quot; title=&quot;Async&quot;&gt;&lt;/a&gt;Async&lt;/h2&gt;&lt;p&gt;我们有回调函数、Promise 以及 Generator 这三种异步编程方式了，为什么在此之外还要提供 Async 函数？因为它们本身还有一些问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;回调函数的最大问题是回调嵌套&lt;/li&gt;
&lt;li&gt;Promise 解决了回调嵌套的问题，但是被 then 方法包装后的代码存在冗余问题，语义和理解性较差&lt;/li&gt;
&lt;li&gt;Generator 的代码写起来非常像同步代码，如果去除 yield 命令，简直就是同步代码，但是它失去了 Promise 可以自动执行的特性，所以它的缺点就是需要创建一个自动执行函数（Thunk 函数），或者使用三方模块（co），总之要驱动它自执行。&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Callback Hell&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt; finalCallback &lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    request.get(url1, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err1, res1&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err1) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; finalCallback(err1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        request.post(url2, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err2, res2&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err2) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; finalCallback(err2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            request.put(url3, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err3, res3&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err3) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; finalCallback(err3);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                request.del(url4, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err4, res4&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (err4) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; finalCallback(err4);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    finalCallback(&lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;whew all done&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Promise&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; request.getAsync(url1)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;res1&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; request.postAsync(url2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;res2&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; request.putAsync(url3);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;res3&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; request.delAsync(url4);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        .then(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;res4&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;whew all done&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Generator&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; co &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;co&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res1 = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; request.getAsync(url1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res2 = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; request.getAsync(url2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res3 = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; request.getAsync(url3);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res4 = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; request.getAsync(url4);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;whew all done&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;co(gen);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Async&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res1 = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; request.getAsync(url1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res2 = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; request.getAsync(url2);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res3 = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; request.getAsync(url3);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; res4 = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; request.getAsync(url4);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;whew all done&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;编译器的惰性求值往往是将参数放入临时函数中实现的，在求值时调用这个临时函数，这个临时函数叫做 Thunk 函数：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;temp&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt; v &lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; v * &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;temp( x + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 等同于&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; thunk = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; x + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;temp&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt; v &lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; thunk() + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在 JS 中，Thunk 函数要做的是将多参数函数转换为单参数函数，且只接受回调函数作为参数：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 正常版本的readFile（多参数版本）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fs.readFile(fileName, callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Thunk版本的readFile（单参数版本）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; readFileThunk = Thunk(fileName);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;readFileThunk(callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Thunk = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;fileName&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; fs.readFile(fileName, callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;任何函数，只要参数是回调函数，就能写成 Thunk 函数的形式，下面是一个简单的 Thunk 函数转换器：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; Thunk = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;fn&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; args = &lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.prototype.slice.call(&lt;span class=&quot;built_in&quot;&gt;arguments&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;callback&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            args.push(callback);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; fn.apply(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;, args);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;之所以要提 Thunk 函数，是因为它可以驱动 Generator 函数自执行：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;run&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;fn&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; gen = fn();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;next&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;err, data&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; result = gen.next(data);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (result.done) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        result.value(next);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    next();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;run(gen);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ES7 提供了 Async 函数，它相当于是 Generator 函数的语法糖。下面使用两种函数读取文件：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; fs = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;fs&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cosnt readFile = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;fileName&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;resolve, reject&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        fs.readFile(fileName, &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;error, data&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (error) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                reject(error);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                resolve(data);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Generator 函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; gen = &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;* (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; f1 = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; readFile(&lt;span class=&quot;string&quot;&gt;&#39;/etc/fstab&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; f2 = &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; readFile(&lt;span class=&quot;string&quot;&gt;&#39;/etc/shells&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(f1.toString());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(f2.toString());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Async&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cosnt asyncReadFile = &lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cosnt f1 = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; readFile(&lt;span class=&quot;string&quot;&gt;&#39;/etc/fstab&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cosnt f2 = &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; readFile(&lt;span class=&quot;string&quot;&gt;&#39;/etc/shells&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(f1.toString());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(f2.toString());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;首先，两者在语法上有所不同，但这不是最重要的，重要的是一下三点：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Async 函数内置自动执行器，而 Generator 需要自己写自动执行函数或者使用第三方库，比如 co&lt;/li&gt;
&lt;li&gt;更广的适应性，co 模块约定 yield 后面只能是 Thunk 函数或者是 Promise 对象，而 Async 函数的 await 后面可以使用 Promise 对象或原始值类型（此时等于同步操作）&lt;/li&gt;
&lt;li&gt;Async 的返回值是 Promise 对象，这比 Generator 返回的 Iterator 对象要更方便一些，可以使用 then() 来制定下一步的操作逻辑&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;timeout&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;ms&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Promise&lt;/span&gt;((resolve) =&amp;gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        setTimeout(resolve, ms);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;asyncPrint&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;value, ms&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; timeout(ms);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(value)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;asyncPrint(&lt;span class=&quot;string&quot;&gt;&#39;hello world&#39;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;await 命令后面跟着一个 Promise 对象，运行结果可能是 rejected，需要使用 try…catch 来捕获异常：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; P();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (err) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Or&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;foo&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;await&lt;/span&gt; P().catch( err =&amp;gt; &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(err) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Class&quot;&gt;&lt;a href=&quot;#Class&quot; class=&quot;headerlink&quot; title=&quot;Class&quot;&gt;&lt;/a&gt;Class&lt;/h2&gt;&lt;p&gt;JS 传统的原型继承等方式和其他语言差异较大，造成了一定的学习难度。ES2015 提供了和其他语言相仿的面向对象语法，引入了 Class 的概念，用作对象的模板：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Point&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;( x, y ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x = x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y = y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getInfo () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;`( &lt;span class=&quot;subst&quot;&gt;$&amp;#123;this.x&amp;#125;&lt;/span&gt;, &lt;span class=&quot;subst&quot;&gt;$&amp;#123;this.y&amp;#125;&lt;/span&gt; )`&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Point(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p.getInfo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; ( 3, 4 )&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上例中的 constructor 是构造方法，this 代表实例对象。constructor 方法是类的默认方法，使用 new 命令生成对象实例时，自动调用盖房，如果没有显示定义该方法，就会自动添加一个空的 constructor 方法，constructor 方法默认返回类的实例对象，该返回值完全是可以修改的。&lt;/p&gt;
&lt;p&gt;Class 之间使用 extends 关键字实现继承，这种写法比 ES5 要简洁很多：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Point&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;( x, y ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.x = x;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.y = y;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getInfo () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;`( &lt;span class=&quot;subst&quot;&gt;$&amp;#123;this.x&amp;#125;&lt;/span&gt;, &lt;span class=&quot;subst&quot;&gt;$&amp;#123;this.y&amp;#125;&lt;/span&gt; )`&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ColorPoint&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Point&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt; ( x, y, color ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;(x, y);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.color = color;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    getInfo () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log( &lt;span class=&quot;keyword&quot;&gt;super&lt;/span&gt;.getInfo() + &lt;span class=&quot;string&quot;&gt;` is &lt;span class=&quot;subst&quot;&gt;$&amp;#123;this.color&amp;#125;&lt;/span&gt;`&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; cp = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ColorPoint( &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cp.getInfo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; ( 3, 4 ) is red&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在继承类的构造函数中出现了 super()，它指代父类的 this 对象。子类必须在 constructor 中调用 super 方法，否则新建实例会报错，这是因为子类没有自己的 this 对象，而是使用继承自父类的 this 对象，一切都是基于对这个 this 的加工处理，如果不调用 super()，就得不到 this 对象。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Point&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ColorPoint&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Point&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; cp = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ColorPoint();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Babel: &#39;this&#39; is not allowed before super()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Firefox: ReferenceError: |this| used uninitialized in ColorPoint class constructor&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ES5 的原型继承，实质是先创造子类的实例对象 this，然后再讲父类的方法添加到 this 上。ES6 的继承机制则是相反的，实质是先创造父类的实例对象 this（调用 super() ），然后在用子类的构造函数修改 this。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;类相当于实例的原型，类中定义的方法都会被实例所继承，如果不想让实例继承继承某个方法，可以通过 static 关键字设置类的静态方法：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Foo&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; getInfo () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; f = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Foo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Foo.getInfo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; &#39;foo&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;f.getInfo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; TypeError: f.getInfo is not a function&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ES2015 规定类内部只有静态方法，没有静态属性，ES2016 有一个静态属性的提案，目前 Babel 已经支持：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Point&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    position = [&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; color = &lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;new 是从类生成实例的命令，ES2015 的 new 命令增加了一个 &lt;code&gt;new.target&lt;/code&gt; 的属性，表示 new 引用的构造函数：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Point&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt; () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt;.target === Point ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;right&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;wrong&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; p = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Point();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; right&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Point.call(p, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Babel: wrong&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Firefox: TypeError: class constructors must be invoked with |new|&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在子类继承父类时，new.target 返回的是子类，利用这个特点，可以写出不能独立使用、必须继承后才能使用的类：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Shape&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;constructor&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt;.target === Shape) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Error&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;本类不能实例化&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; s = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Shape();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// =&amp;gt; Error: 本类不能实例化&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;Decorator&quot;&gt;&lt;a href=&quot;#Decorator&quot; class=&quot;headerlink&quot; title=&quot;Decorator&quot;&gt;&lt;/a&gt;Decorator&lt;/h2&gt;&lt;p&gt;ES2016 的 Decorator 相当于设计模式中的装饰模式，所以下文就以装饰器来指代 Decorator。与上面提到的 Proxy（代理者，代理模式）不同，装饰器的核心作用是增强被装饰者的功能，而代理对象的作用是管理外界对被代理者的访问权限。装饰器只能用于类和类的方法，不能用于函数，因为编译时存在函数提升。修饰漆对类的行为的改变，是代码编译时发生的，而不是运行时，这意味着，修饰漆能在编译阶段运行代码：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;mixins&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;...list&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;target, name, descriptor&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;Object&lt;/span&gt;.assign(target.prototype, ...list);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; Foo = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    foo () &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;@mixins(Foo)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CLS&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; obj = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; CLS();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;obj.foo();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &#39;foo&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;装饰器函数可以接收三个参数：目标函数、属性名和属性的描述对象。上例代码通过装饰器 mixins，为指定类添加了指定的方法。装饰器的一个实际应用就是注释:&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &amp;#123; readonly &amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;core-decorators&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Meal&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;extends&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    @readonly&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    entree = &lt;span class=&quot;string&quot;&gt;&#39;steak&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; dinner = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Meal();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dinner.entree = &lt;span class=&quot;string&quot;&gt;&#39;salmon&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Cannot assign to read only property &#39;entree&#39; of [object Object]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;除了注释功能，装饰器还能用作类型检查，长期来看，它将成为 JavaScript 代码静态分析的重要工具。&lt;/p&gt;
&lt;h2 id=&quot;Module&quot;&gt;&lt;a href=&quot;#Module&quot; class=&quot;headerlink&quot; title=&quot;Module&quot;&gt;&lt;/a&gt;Module&lt;/h2&gt;&lt;p&gt;在 ES2015 之前，社区中主要有 CommonJS 和 AMD 两种模块加载方式，ES2015 提出了自己的模块功能，其设计思想是尽量的静态化，在编译时确定模块的依赖关系、输入输出变量。&lt;/p&gt;
&lt;p&gt;ES2015 module 主要由两个命令组成：&lt;code&gt;export&lt;/code&gt; 和 &lt;code&gt;import&lt;/code&gt;。export 用于提供对外接口，import 用于引用外部模块。每个模块都是独立的文件，外部无法直接获取模块文件的变量，只能通过 export 对外输出变量。&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 输出变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; foo = &lt;span class=&quot;string&quot;&gt;&#39;foo&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; bar = &lt;span class=&quot;string&quot;&gt;&#39;bar&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &amp;#123; foo, bar &amp;#125;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 输出函数和类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;f&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;C&lt;/span&gt; &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;export 定义了外部接口之后，可以使用 import 命令在其他模块中加载：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 使用 as 命令重命名引入的变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// import 语法存在变量提升，最好置于文件顶部&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; &amp;#123; foo, bar &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; baz &amp;#125; &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;./modulename&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;从上面 import 的示例中，我们发现当需要引入外部模块时，必须明确知道模块内部的变量名，这是非常不友好的方式。&lt;code&gt;export default&lt;/code&gt; 命令就是为了解决这个问题存在的，其作用是为模块指定默认的输出内容：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &#39;export-default.js&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// &#39;import-default.js&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;immport customName &lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;./export-default.js&#39;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;建议使用的特性&quot;&gt;&lt;a href=&quot;#建议使用的特性&quot; class=&quot;headerlink&quot; title=&quot;建议使用的特性&quot;&gt;&lt;/a&gt;建议使用的特性&lt;/h2&gt;&lt;h6 id=&quot;参考资料&quot;&gt;&lt;a href=&quot;#参考资料&quot; class=&quot;headerlink&quot; title=&quot;参考资料&quot;&gt;&lt;/a&gt;参考资料&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://es6.ruanyifeng.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ECMAScript6 入门&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/JavaScript&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MDN JavaScript&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;ES2015 是最新的 JavaScript 语法规范，也是前端工程化高速发展所催化出的产物。JS 的不成熟一直为人诟病，前端的高速发展又离不开 JS，所以这次激进的变革显得十分必要。&lt;/p&gt;
&lt;p&gt;虽然 ES2015 规范发布了，但是要原生的运行在浏览器上还是受到诸多因素的肘制，比如各版本浏览器的用户量、浏览器厂商对新特性的支持度等等。目前的权宜之计是使用 Babel 之类的编译器将 ES2015 代码转换为 ES5，所以下文中的 ES2015 代码也暂时以 Babel 的解析结果为准。各版本浏览器对 ES2015（ES6）、ES2016（ES7）的支持度可以参考这里：&lt;a href=&quot;http://kangax.github.io/compat-table/es6/&quot;&gt;ES2015 兼容性列表&lt;/a&gt;。&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>求值策略</title>
    <link href="http://pinggod.com/2015/%E6%B1%82%E5%80%BC%E7%AD%96%E7%95%A5/"/>
    <id>http://pinggod.com/2015/求值策略/</id>
    <published>2015-12-10T05:43:07.000Z</published>
    <updated>2015-12-15T09:15:01.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;须知参差多态乃是幸福本源。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;求值策略所要解决的问题是：何时求值。之所以要控制求值的时间，往往是出于对内存占用和执行效率的考虑。在维基百科的求值策略词条中，列出了五种求值策略：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;预先求值，表达式绑定到变量时，立即求值并附加给变量&lt;/li&gt;
&lt;li&gt;延迟求值，表达式绑定到变量后，并不求值，直到变量被调用时才求值&lt;/li&gt;
&lt;li&gt;局部求值，又称柯里化&lt;/li&gt;
&lt;li&gt;分布求值，map/reduce，典型应用是分布式计算&lt;/li&gt;
&lt;li&gt;短路求值，与 (&amp;amp;&amp;amp;) 、或 (||) 逻辑运算&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;顾名思义，预先求值和延迟求值是一对对立的求值策略。在下面的 js 代码段中，声明了变量 x，x 赋值后又被调用了三次：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; x = &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; * (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; ^ &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(x + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;func(x);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;在 1 处，变量 x 完成了声明和赋值等初始化工作，它的值由表达式 (5 + 3 * (1 + 5 ^ 2)) 决定。在 2 处，console.log() 函数调用了变量 x 两次。让我们暂时忽略 js 编译器的求值策略，从个人主观的理性思维来思考一下：面对预先求值和延迟求值，你会怎么选择呢？&lt;/p&gt;
&lt;p&gt;做出选择之前，我们需要对变量 x 有一个复杂度的认知：如果表达式的复杂度高，那么该表达式所占用的内存空间也就越高，在变量 x 和表达式解绑前这段内存空间都无法释放掉，意味着 x 的间接内存占用了越高，此外，高复杂度也意味着较长的执行时间，所以复杂度和内存占用、执行效率至少是一种线性相关。&lt;/p&gt;
&lt;p&gt;如此说来，那么我们应该选择预先求值的求值策略，这样的好处是：变量 x 初始化时表达式立即计算，x 被重新赋值为 83，重新赋值后表达式所占用的内存空间被释放掉，达到了节省内存空间的目的；多次调用变量 x 时，x 的值已经是可以直接用于运算的数值，而不是需要计算的表达式，减少了重复运算，提高了执行效率。&lt;/p&gt;
&lt;p&gt;如果事情按照上面描述的美好愿景发展的话，就没有延迟求值策略出现的必要了。在 3 处，我们向函数 func() 传递了变量 x。这里的 func() 类似于一个黑盒，我们不了解其内部的处理机制，也无法确定 x 是否会被使用。这个时候延迟求值的价值就体现出来了，如果变量 x 在函数内部没有被使用，就不会执行求值，避免了预先求值所要执行的求值运算。&lt;/p&gt;
&lt;p&gt;随着表达式的复杂度逐渐提高，预先求值和延迟求值在内存占用、执行效率上的差异就会愈发明显。所以根据数据类型的复杂度，js 将数据类型分为原始值和引用值，传递参数时，原始值按值传递，引用值按引用传递。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;须知参差多态乃是幸福本源。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;求值策略所要解决的问题是：何时求值。之所以要控制求值的时间，往往是出于对内存占用和执行效率的考虑。在维基百科的求值策略词条中，列出了五种求值策略：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;预先求值，表达式绑定到变量时，立即求值并附加给变量&lt;/li&gt;
&lt;li&gt;延迟求值，表达式绑定到变量后，并不求值，直到变量被调用时才求值&lt;/li&gt;
&lt;li&gt;局部求值，又称柯里化&lt;/li&gt;
&lt;li&gt;分布求值，map/reduce，典型应用是分布式计算&lt;/li&gt;
&lt;li&gt;短路求值，与 (&amp;amp;&amp;amp;) 、或 (||) 逻辑运算&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;顾名思义，预先求值和延迟求值是一对对立的求值策略。在下面的 js 代码段中，声明了变量 x，x 赋值后又被调用了三次：&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; x = &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt; * (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; + &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; ^ &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(x + &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;func(x);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Inline* and Absolute</title>
    <link href="http://pinggod.com/2015/inline-and-absolute/"/>
    <id>http://pinggod.com/2015/inline-and-absolute/</id>
    <published>2015-12-06T03:32:17.000Z</published>
    <updated>2015-12-27T09:31:08.000Z</updated>
    
    <content type="html">&lt;p&gt;在一个容器中，所有元素都是 inline / inline-block 类型，此时可以使用 absolute + margin 的方式实现相对定位，而且相对定位的位置就是脱离文档流之前的位置。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/inline-and-absolute.png&quot; alt=&quot;absolute and margin&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h6 id=&quot;在线示例&quot;&gt;&lt;a href=&quot;#在线示例&quot; class=&quot;headerlink&quot; title=&quot;在线示例&quot;&gt;&lt;/a&gt;在线示例&lt;/h6&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://codepen.io/pinggod/pen/WrNJmE&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;absolute and marign&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;在一个容器中，所有元素都是 inline / inline-block 类型，此时可以使用 absolute + margin 的方式实现相对定位，而且相对定位的位置就是脱离文档流之前的位置。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/inline-and-absolute.png&quot; alt=&quot;absolute and margin&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Pug</title>
    <link href="http://pinggod.com/2015/Pug/"/>
    <id>http://pinggod.com/2015/Pug/</id>
    <published>2015-12-03T05:24:27.000Z</published>
    <updated>2016-03-27T07:36:22.000Z</updated>
    
    <content type="html">&lt;div class=&quot;tip&quot;&gt;&lt;br&gt;    由于商标版权问题，Jade 已经改名为了 Pug，详见 &lt;a href=&quot;https://github.com/pugjs/jade/issues/2184&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;issue&lt;/a&gt;。&lt;br&gt;&lt;/div&gt;

&lt;p&gt;如果你熟悉 Sublime Text 和 Emmet 的组合，那么 Pug 也会是你的菜。Pug 类似于 Python，都采用了对缩进敏感的语法形式，比如下面这段代码创建了一个无序列表：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ul(&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;inline&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    li  Item C&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    li  Item A&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    li  Item B&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h2 id=&quot;属性&quot;&gt;&lt;a href=&quot;#属性&quot; class=&quot;headerlink&quot; title=&quot;属性&quot;&gt;&lt;/a&gt;属性&lt;/h2&gt;&lt;p&gt;Pug 的另一大特点就是和 JavaScript 的融合度很高，比如设置属性：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;- &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; authenticated = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;body(&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;&lt;/span&gt;= authenticated ? &lt;span class=&quot;string&quot;&gt;&#39;authed&#39;&lt;/span&gt; : &lt;span class=&quot;string&quot;&gt;&#39;anon&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; currentUrl = &lt;span class=&quot;string&quot;&gt;&#39;/about&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a(&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;&lt;/span&gt;=&amp;#123;active: currentUrl === &lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;&amp;#125; href=&lt;span class=&quot;string&quot;&gt;&#39;/&#39;&lt;/span&gt;) Home&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a(&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;&lt;/span&gt;=&amp;#123;active: currentUrl === &lt;span class=&quot;string&quot;&gt;&#39;/about&#39;&lt;/span&gt;&amp;#125; href=&lt;span class=&quot;string&quot;&gt;&#39;/about&#39;&lt;/span&gt;) About&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;此外，给标签设置行内样式时，需要以对象的形式赋值给 style：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;a(style=&amp;#123;color: &lt;span class=&quot;string&quot;&gt;&#39;red&#39;&lt;/span&gt;, background: &lt;span class=&quot;string&quot;&gt;&#39;green&#39;&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;插值&quot;&gt;&lt;a href=&quot;#插值&quot; class=&quot;headerlink&quot; title=&quot;插值&quot;&gt;&lt;/a&gt;插值&lt;/h2&gt;&lt;p&gt;Pug 提供了字符串插值和标签插值。其中，字符串插值由于要考虑到安全性问题，所以又分成了转义和不转义两种情况：&lt;/p&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// 转义插值 #&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- var theGreat = &quot;&amp;lt;span&amp;gt;escape!&amp;lt;/span&amp;gt;&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p This will be safe: #&amp;#123;theGreat&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 不转义插值 !&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- var theGreat = &quot;&amp;lt;span&amp;gt;escape!&amp;lt;/span&amp;gt;&quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p This will be safe: !&amp;#123;theGreat&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;// 标签插值&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p #[a(href=&quot;Pug-lang.com&quot;) Pug]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;编译结果：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 转义插值 #&amp;#123;&amp;#125;--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;This will be safe: &amp;amp;lt;span&amp;amp;gt;escape!&amp;amp;lt;/span&amp;amp;gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 不转义插值 !&amp;#123;&amp;#125;--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;This will be safe: &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;escape!&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;&amp;lt;!-- 标签插值--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;Pug-lang.com&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Pug&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;逻辑语句&quot;&gt;&lt;a href=&quot;#逻辑语句&quot; class=&quot;headerlink&quot; title=&quot;逻辑语句&quot;&gt;&lt;/a&gt;逻辑语句&lt;/h2&gt;&lt;p&gt;Pug 提供了条件、分支、循环、遍历四种逻辑语句，这四种语句继承自 JavaScript，只是语法上有些差异:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;条件语句：if … else if … else&lt;/li&gt;
&lt;li&gt;分支语句：case … when … default&lt;/li&gt;
&lt;li&gt;循环语句：while&lt;/li&gt;
&lt;li&gt;遍历数组：each $elem in [elem…]&lt;/li&gt;
&lt;li&gt;遍历对象：each $key, $value in {key: value}&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;// 分支语句&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;- var friends = 10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;case friends&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    when 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p you have no friends&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    when 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p you have a friend&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    default&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p you have #&amp;#123;friends&amp;#125; friends&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;mixin&quot;&gt;&lt;a href=&quot;#mixin&quot; class=&quot;headerlink&quot; title=&quot;mixin&quot;&gt;&lt;/a&gt;mixin&lt;/h2&gt;&lt;p&gt;Pug 和 Sass 都提供了 mixin 语法来实现代码的复用，两者语法也很相似：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mixin list(id, ...items)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ul(id=id)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        each item &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; items&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            li= item&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;+list(&lt;span class=&quot;string&quot;&gt;&#39;my-list&#39;&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;mixin 一般放在独立的文件中，需要使用 &lt;code&gt;include&lt;/code&gt; 指令导入到其他文件中。&lt;/p&gt;
&lt;h2 id=&quot;extends&quot;&gt;&lt;a href=&quot;#extends&quot; class=&quot;headerlink&quot; title=&quot;extends&quot;&gt;&lt;/a&gt;extends&lt;/h2&gt;&lt;p&gt;&lt;code&gt;extends&lt;/code&gt; 是 Pug 的模板继承语法，通过 &lt;code&gt;extends filename.Pug&lt;/code&gt; 可以将模板文件导入到其他文件中。继承机制基本上是一个复制代码片段的过程，为了能够动态修改其中的部分内容，Pug 提供了 &lt;code&gt;block&lt;/code&gt; 语法：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 声明 block&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block content&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p Hello&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 修改 block&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 同名重新赋值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block content&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p Hi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 前置追加&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block append content&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p APPEND&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 后置追加&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block prepend content&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p PREPEND&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;div class=&quot;tip&quot;&gt;&lt;br&gt;    由于商标版权问题，Jade 已经改名为了 Pug，详见 &lt;a href=&quot;https://github.com/pugjs/jade/issues/2184&quot;&gt;issue&lt;/a&gt;。&lt;br&gt;&lt;/div&gt;

&lt;p&gt;如果你熟悉 Sublime Text 和 Emmet 的组合，那么 Pug 也会是你的菜。Pug 类似于 Python，都采用了对缩进敏感的语法形式，比如下面这段代码创建了一个无序列表：&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ul(&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;inline&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    li  Item C&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    li  Item A&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    li  Item B&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
